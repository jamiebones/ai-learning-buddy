2025-03-31 11:39:29,645 - __main__ - INFO - Starting development server
2025-03-31 11:39:30,738 - app.main - INFO - Starting up application
2025-03-31 11:39:30,744 - app.main - INFO - Database tables created successfully
2025-03-31 11:39:30,858 - watchfiles.main - INFO - 1 change detected
2025-04-01 08:15:12,212 - __main__ - INFO - Starting development server
2025-04-01 08:15:13,202 - app.main - INFO - Starting up application
2025-04-01 08:15:13,202 - app.main - INFO - Starting up application
2025-04-01 08:15:13,254 - app.main - INFO - Database tables created successfully
2025-04-01 08:15:13,254 - app.main - INFO - Database tables created successfully
2025-04-01 08:15:13,435 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:41:52,248 - __main__ - INFO - Starting development server
2025-04-01 14:41:55,399 - app.main - INFO - Starting up application
2025-04-01 14:41:55,399 - app.main - INFO - Starting up application
2025-04-01 14:41:55,572 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:41:55,585 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 14:41:55,585 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:41:55,593 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 14:41:55,593 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:41:55,597 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 14:41:55,597 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:41:55,600 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 14:41:55,605 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:41:55,605 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:41:55,623 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:41:55,624 - sqlalchemy.engine.Engine - INFO - [cached since 0.01919s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:41:55,625 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:41:55,625 - sqlalchemy.engine.Engine - INFO - [cached since 0.02049s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:41:55,626 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id UUID NOT NULL, 
	username VARCHAR NOT NULL, 
	email VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	created_at TIMESTAMP WITHOUT TIME ZONE, 
	PRIMARY KEY (id)
)


2025-04-01 14:41:55,627 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2025-04-01 14:41:55,689 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_email ON users (email)
2025-04-01 14:41:55,689 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2025-04-01 14:41:55,696 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_username ON users (username)
2025-04-01 14:41:55,696 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2025-04-01 14:41:55,702 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE chats (
	id UUID NOT NULL, 
	user_id UUID NOT NULL, 
	message TEXT NOT NULL, 
	response TEXT NOT NULL, 
	timestamp TIMESTAMP WITHOUT TIME ZONE, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id) ON DELETE CASCADE
)


2025-04-01 14:41:55,702 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2025-04-01 14:41:55,722 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE notes (
	id UUID NOT NULL, 
	user_id UUID NOT NULL, 
	note_text TEXT NOT NULL, 
	file_name VARCHAR NOT NULL, 
	upload_date TIMESTAMP WITHOUT TIME ZONE, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id) ON DELETE CASCADE
)


2025-04-01 14:41:55,723 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2025-04-01 14:41:55,733 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 14:41:55,738 - app.main - INFO - Database tables created successfully
2025-04-01 14:41:55,738 - app.main - INFO - Database tables created successfully
2025-04-01 14:44:04,970 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': {'email': 'jamiebones2000@yahoo.co.uk', 'password': 'blazing147', 'name': 'jamiebones'}}]
2025-04-01 14:44:04,970 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': {'email': 'jamiebones2000@yahoo.co.uk', 'password': 'blazing147', 'name': 'jamiebones'}}]
2025-04-01 14:44:05,233 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:44:05,584 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:47:54,331 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 23, in register
    user = db.query(User).filter(User.email == user_data.email).first()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 14:47:54,331 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 23, in register
    user = db.query(User).filter(User.email == user_data.email).first()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 14:47:54,675 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:52:23,200 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:52:23,351 - app.main - INFO - Shutting down application
2025-04-01 14:52:23,351 - app.main - INFO - Shutting down application
2025-04-01 14:52:23,357 - app.main - INFO - Database connections closed successfully
2025-04-01 14:52:23,357 - app.main - INFO - Database connections closed successfully
2025-04-01 14:52:23,733 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:52:24,452 - watchfiles.main - INFO - 2 changes detected
2025-04-01 14:52:24,803 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:52:27,042 - app.main - INFO - Starting up application
2025-04-01 14:52:27,042 - app.main - INFO - Starting up application
2025-04-01 14:52:27,110 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:52:27,128 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 14:52:27,129 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:52:27,134 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 14:52:27,134 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:52:27,137 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 14:52:27,138 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:52:27,140 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 14:52:27,147 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:52:27,147 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:52:27,152 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:52:27,153 - sqlalchemy.engine.Engine - INFO - [cached since 0.006222s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:52:27,155 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:52:27,155 - sqlalchemy.engine.Engine - INFO - [cached since 0.008418s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:52:27,157 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 14:52:27,158 - app.main - INFO - Database tables created successfully
2025-04-01 14:52:27,158 - app.main - INFO - Database tables created successfully
2025-04-01 14:54:14,465 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:14,641 - app.main - INFO - Shutting down application
2025-04-01 14:54:14,641 - app.main - INFO - Shutting down application
2025-04-01 14:54:14,646 - app.main - INFO - Database connections closed successfully
2025-04-01 14:54:14,646 - app.main - INFO - Database connections closed successfully
2025-04-01 14:54:15,021 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:15,372 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:18,079 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:18,431 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:18,983 - watchfiles.main - INFO - 2 changes detected
2025-04-01 14:54:19,585 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:19,948 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:20,499 - watchfiles.main - INFO - 2 changes detected
2025-04-01 14:54:20,850 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:22,003 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:22,369 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:22,720 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:23,071 - watchfiles.main - INFO - 2 changes detected
2025-04-01 14:54:23,422 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:54:24,987 - app.main - INFO - Starting up application
2025-04-01 14:54:24,987 - app.main - INFO - Starting up application
2025-04-01 14:54:25,045 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 14:54:25,046 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:54:25,048 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 14:54:25,049 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:54:25,051 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 14:54:25,051 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 14:54:25,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 14:54:25,058 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:54:25,059 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:54:25,064 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:54:25,064 - sqlalchemy.engine.Engine - INFO - [cached since 0.00635s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:54:25,066 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 14:54:25,067 - sqlalchemy.engine.Engine - INFO - [cached since 0.008477s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 14:54:25,068 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 14:54:25,069 - app.main - INFO - Database tables created successfully
2025-04-01 14:54:25,069 - app.main - INFO - Database tables created successfully
2025-04-01 14:54:25,284 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:56:15,041 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 14:56:15,053 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 14:56:15,054 - app.main - ERROR - Unhandled exception during request processing: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2522, in get_property
    return self._props[key]
KeyError: 'chats'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1661, in do_init
    self._generate_backref()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 2147, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1592, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2524, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-04-01 14:56:15,054 - app.main - ERROR - Unhandled exception during request processing: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2522, in get_property
    return self._props[key]
KeyError: 'chats'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1661, in do_init
    self._generate_backref()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 2147, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1592, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2524, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-04-01 14:56:15,380 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:58:08,886 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 14:58:08,888 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 14:58:08,890 - app.main - ERROR - Unhandled exception during request processing: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Chat(chats)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Chat(chats)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-04-01 14:58:08,890 - app.main - ERROR - Unhandled exception during request processing: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Chat(chats)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Chat(chats)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'chats'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-04-01 14:58:09,068 - watchfiles.main - INFO - 1 change detected
2025-04-01 14:58:09,420 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:29,132 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:29,309 - app.main - INFO - Shutting down application
2025-04-01 15:02:29,309 - app.main - INFO - Shutting down application
2025-04-01 15:02:29,317 - app.main - INFO - Database connections closed successfully
2025-04-01 15:02:29,317 - app.main - INFO - Database connections closed successfully
2025-04-01 15:02:29,719 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:30,671 - watchfiles.main - INFO - 3 changes detected
2025-04-01 15:02:31,024 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:31,375 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:46,871 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:47,223 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:47,574 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:49,329 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:02:49,680 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:02:51,445 - app.main - INFO - Starting up application
2025-04-01 15:02:51,445 - app.main - INFO - Starting up application
2025-04-01 15:02:51,517 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:02:51,518 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:02:51,521 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:02:51,521 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:02:51,524 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:02:51,524 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:02:51,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:02:51,532 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:02:51,533 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:02:51,536 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:02:51,536 - sqlalchemy.engine.Engine - INFO - [cached since 0.004473s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:02:51,538 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:02:51,538 - sqlalchemy.engine.Engine - INFO - [cached since 0.006206s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:02:51,540 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:02:51,541 - app.main - INFO - Database tables created successfully
2025-04-01 15:02:51,541 - app.main - INFO - Database tables created successfully
2025-04-01 15:02:51,736 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:04:46,855 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:04:47,041 - app.main - INFO - Shutting down application
2025-04-01 15:04:47,041 - app.main - INFO - Shutting down application
2025-04-01 15:04:47,045 - app.main - INFO - Database connections closed successfully
2025-04-01 15:04:47,045 - app.main - INFO - Database connections closed successfully
2025-04-01 15:04:47,417 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:04:47,769 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:04:49,286 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:04:49,637 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:04:51,026 - app.main - INFO - Starting up application
2025-04-01 15:04:51,026 - app.main - INFO - Starting up application
2025-04-01 15:04:51,083 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:04:51,083 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:04:51,087 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:04:51,087 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:04:51,090 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:04:51,090 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:04:51,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:04:51,097 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:04:51,098 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:04:51,102 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:04:51,102 - sqlalchemy.engine.Engine - INFO - [cached since 0.005247s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:04:51,104 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:04:51,104 - sqlalchemy.engine.Engine - INFO - [cached since 0.007161s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:04:51,106 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:04:51,108 - app.main - INFO - Database tables created successfully
2025-04-01 15:04:51,108 - app.main - INFO - Database tables created successfully
2025-04-01 15:04:51,392 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:06:44,761 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:06:44,889 - app.main - INFO - Shutting down application
2025-04-01 15:06:44,889 - app.main - INFO - Shutting down application
2025-04-01 15:06:44,893 - app.main - INFO - Database connections closed successfully
2025-04-01 15:06:44,893 - app.main - INFO - Database connections closed successfully
2025-04-01 15:06:45,261 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:06:45,662 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:06:46,874 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:06:47,225 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:06:47,576 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:06:48,630 - app.main - INFO - Starting up application
2025-04-01 15:06:48,630 - app.main - INFO - Starting up application
2025-04-01 15:06:48,689 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:06:48,690 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:06:48,693 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:06:48,693 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:06:48,695 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:06:48,696 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:06:48,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:06:48,703 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:06:48,704 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:06:48,708 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:06:48,708 - sqlalchemy.engine.Engine - INFO - [cached since 0.004978s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:06:48,710 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:06:48,711 - sqlalchemy.engine.Engine - INFO - [cached since 0.00773s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:06:48,713 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:06:48,714 - app.main - INFO - Database tables created successfully
2025-04-01 15:06:48,714 - app.main - INFO - Database tables created successfully
2025-04-01 15:06:48,938 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:13,304 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:13,481 - app.main - INFO - Shutting down application
2025-04-01 15:07:13,481 - app.main - INFO - Shutting down application
2025-04-01 15:07:13,485 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:13,485 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:13,854 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:14,541 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:14,903 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:15,705 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:07:16,056 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:16,407 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:17,559 - app.main - INFO - Starting up application
2025-04-01 15:07:17,559 - app.main - INFO - Starting up application
2025-04-01 15:07:17,616 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:07:17,616 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:17,619 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:07:17,620 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:17,623 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:07:17,624 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:17,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:07:17,633 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:17,633 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:17,637 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:17,637 - sqlalchemy.engine.Engine - INFO - [cached since 0.004784s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:17,639 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:17,640 - sqlalchemy.engine.Engine - INFO - [cached since 0.00736s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:17,642 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:07:17,642 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:17,642 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:17,811 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:19,014 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:19,148 - app.main - INFO - Shutting down application
2025-04-01 15:07:19,148 - app.main - INFO - Shutting down application
2025-04-01 15:07:19,152 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:19,152 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:19,519 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:20,521 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:07:20,872 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:22,342 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:22,708 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:23,560 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:07:23,912 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:25,317 - app.main - INFO - Starting up application
2025-04-01 15:07:25,317 - app.main - INFO - Starting up application
2025-04-01 15:07:25,383 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:07:25,383 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:25,387 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:07:25,387 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:25,390 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:07:25,391 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:25,393 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:07:25,400 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:25,400 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:25,405 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:25,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.006319s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:25,410 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:25,411 - sqlalchemy.engine.Engine - INFO - [cached since 0.01156s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:25,414 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:07:25,416 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:25,416 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:25,666 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:26,017 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:26,121 - app.main - INFO - Shutting down application
2025-04-01 15:07:26,121 - app.main - INFO - Shutting down application
2025-04-01 15:07:26,125 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:26,125 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:26,498 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:27,462 - watchfiles.main - INFO - 3 changes detected
2025-04-01 15:07:27,822 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:30,725 - app.main - INFO - Starting up application
2025-04-01 15:07:30,725 - app.main - INFO - Starting up application
2025-04-01 15:07:30,798 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:07:30,798 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:30,804 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:07:30,805 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:30,809 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:07:30,809 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:30,814 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:07:30,821 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:30,821 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:30,826 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:30,826 - sqlalchemy.engine.Engine - INFO - [cached since 0.005754s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:30,828 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:30,829 - sqlalchemy.engine.Engine - INFO - [cached since 0.00854s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:30,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:07:30,832 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:30,832 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:31,044 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:31,395 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:32,548 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:32,739 - app.main - INFO - Shutting down application
2025-04-01 15:07:32,739 - app.main - INFO - Shutting down application
2025-04-01 15:07:32,742 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:32,742 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:33,108 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:33,459 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:33,810 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:07:35,549 - app.main - INFO - Starting up application
2025-04-01 15:07:35,549 - app.main - INFO - Starting up application
2025-04-01 15:07:35,614 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:07:35,614 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:35,618 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:07:35,619 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:35,621 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:07:35,622 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:35,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:07:35,631 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:35,631 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:35,637 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:35,637 - sqlalchemy.engine.Engine - INFO - [cached since 0.006171s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:35,639 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:35,639 - sqlalchemy.engine.Engine - INFO - [cached since 0.008151s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:35,640 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:07:35,641 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:35,641 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:35,866 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:43,999 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:44,164 - app.main - INFO - Shutting down application
2025-04-01 15:07:44,164 - app.main - INFO - Shutting down application
2025-04-01 15:07:44,168 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:44,168 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:44,534 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:44,885 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:48,800 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:07:49,010 - app.main - INFO - Starting up application
2025-04-01 15:07:49,010 - app.main - INFO - Starting up application
2025-04-01 15:07:49,085 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:07:49,086 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:49,089 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:07:49,090 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:49,093 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:07:49,093 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:49,095 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:07:49,104 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:49,104 - sqlalchemy.engine.Engine - INFO - [generated in 0.00093s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:49,109 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:49,109 - sqlalchemy.engine.Engine - INFO - [cached since 0.005791s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:49,111 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:49,111 - sqlalchemy.engine.Engine - INFO - [cached since 0.008227s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:49,113 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:07:49,114 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:49,114 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:49,151 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:52,112 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:52,223 - app.main - INFO - Shutting down application
2025-04-01 15:07:52,223 - app.main - INFO - Shutting down application
2025-04-01 15:07:52,227 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:52,227 - app.main - INFO - Database connections closed successfully
2025-04-01 15:07:52,594 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:53,603 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:53,962 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:07:56,629 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:07:56,989 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:07:56,990 - app.main - INFO - Starting up application
2025-04-01 15:07:56,990 - app.main - INFO - Starting up application
2025-04-01 15:07:57,067 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:07:57,067 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:57,071 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:07:57,072 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:57,075 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:07:57,075 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:07:57,078 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:07:57,084 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:57,084 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:57,088 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:57,088 - sqlalchemy.engine.Engine - INFO - [cached since 0.004914s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:57,090 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:07:57,090 - sqlalchemy.engine.Engine - INFO - [cached since 0.006963s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:07:57,093 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:07:57,094 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:57,094 - app.main - INFO - Database tables created successfully
2025-04-01 15:07:57,465 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:00,149 - app.main - INFO - Starting up application
2025-04-01 15:08:00,149 - app.main - INFO - Starting up application
2025-04-01 15:08:00,206 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:08:00,206 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:00,209 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:08:00,209 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:00,211 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:08:00,212 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:00,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:08:00,218 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:00,218 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:00,222 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:00,222 - sqlalchemy.engine.Engine - INFO - [cached since 0.00398s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:00,223 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:00,224 - sqlalchemy.engine.Engine - INFO - [cached since 0.006162s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:00,226 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:08:00,227 - app.main - INFO - Database tables created successfully
2025-04-01 15:08:00,227 - app.main - INFO - Database tables created successfully
2025-04-01 15:08:00,245 - watchfiles.main - INFO - 3 changes detected
2025-04-01 15:08:01,448 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:01,632 - app.main - INFO - Shutting down application
2025-04-01 15:08:01,632 - app.main - INFO - Shutting down application
2025-04-01 15:08:01,635 - app.main - INFO - Database connections closed successfully
2025-04-01 15:08:01,635 - app.main - INFO - Database connections closed successfully
2025-04-01 15:08:02,003 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:05,662 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:08:05,719 - app.main - INFO - Starting up application
2025-04-01 15:08:05,719 - app.main - INFO - Starting up application
2025-04-01 15:08:05,816 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:08:05,817 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:05,823 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:08:05,828 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:05,831 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:08:05,833 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:05,837 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:08:05,849 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:05,850 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:05,855 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:05,855 - sqlalchemy.engine.Engine - INFO - [cached since 0.006547s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:05,858 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:05,859 - sqlalchemy.engine.Engine - INFO - [cached since 0.00999s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:05,861 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:08:05,863 - app.main - INFO - Database tables created successfully
2025-04-01 15:08:05,863 - app.main - INFO - Database tables created successfully
2025-04-01 15:08:06,014 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:06,365 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:08:06,566 - app.main - INFO - Shutting down application
2025-04-01 15:08:06,566 - app.main - INFO - Shutting down application
2025-04-01 15:08:06,571 - app.main - INFO - Database connections closed successfully
2025-04-01 15:08:06,571 - app.main - INFO - Database connections closed successfully
2025-04-01 15:08:07,746 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:08,105 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:08,455 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:10,762 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:08:10,856 - app.main - INFO - Starting up application
2025-04-01 15:08:10,856 - app.main - INFO - Starting up application
2025-04-01 15:08:10,921 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:08:10,921 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:10,925 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:08:10,925 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:10,928 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:08:10,928 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:08:10,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:08:10,936 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:10,936 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:10,942 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:10,942 - sqlalchemy.engine.Engine - INFO - [cached since 0.00595s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:10,943 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:08:10,944 - sqlalchemy.engine.Engine - INFO - [cached since 0.007599s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:08:10,945 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:08:10,946 - app.main - INFO - Database tables created successfully
2025-04-01 15:08:10,946 - app.main - INFO - Database tables created successfully
2025-04-01 15:08:11,113 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:11,464 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:22,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:08:22,532 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 15:08:22,533 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] ('jamiebones2000@yahoo.co.uk',)
2025-04-01 15:08:22,541 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-01 15:08:22,794 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:08:22,888 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITHOUT TIME ZONE)
2025-04-01 15:08:22,888 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] (UUID('9b15278a-5d72-48d1-8ffe-d500bfa95ddd'), 'jamiebones', 'jamiebones2000@yahoo.co.uk', '$2b$12$E2Ee9s9HQWFfeStI8jHumeF7XD7fwBAm6t/K4pzdN8Js4376rLCAa', datetime.datetime(2025, 4, 1, 15, 8, 22, 887976, tzinfo=datetime.timezone.utc))
2025-04-01 15:08:22,895 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 15:08:22,899 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('9b15278a-5d72-48d1-8ffe-d500bfa95ddd'), 'jamiebones', 'jamiebones2000@yahoo.co.uk', '$2b$12$E2Ee9s9HQWFfeStI8jHumeF7XD7fwBAm6t/K4pzdN8Js4376rLCAa', datetime.datetime(2025, 4, 1, 15, 8, 22, 887976, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 43, in register
    await db.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('9b15278a-5d72-48d1-8ffe-d500bfa95ddd'), 'jamiebones', 'jamiebones2000@yahoo.co.uk', '$2b$12$E2Ee9s9HQWFfeStI8jHumeF7XD7fwBAm6t/K4pzdN8Js4376rLCAa', datetime.datetime(2025, 4, 1, 15, 8, 22, 887976, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-04-01 15:08:22,899 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('9b15278a-5d72-48d1-8ffe-d500bfa95ddd'), 'jamiebones', 'jamiebones2000@yahoo.co.uk', '$2b$12$E2Ee9s9HQWFfeStI8jHumeF7XD7fwBAm6t/K4pzdN8Js4376rLCAa', datetime.datetime(2025, 4, 1, 15, 8, 22, 887976, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 43, in register
    await db.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: datetime.datetime(2025, 4, 1, 15, 8, 22,... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITHOUT TIME ZONE)]
[parameters: (UUID('9b15278a-5d72-48d1-8ffe-d500bfa95ddd'), 'jamiebones', 'jamiebones2000@yahoo.co.uk', '$2b$12$E2Ee9s9HQWFfeStI8jHumeF7XD7fwBAm6t/K4pzdN8Js4376rLCAa', datetime.datetime(2025, 4, 1, 15, 8, 22, 887976, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-04-01 15:14:15,481 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:15,638 - app.main - INFO - Shutting down application
2025-04-01 15:14:15,638 - app.main - INFO - Shutting down application
2025-04-01 15:14:15,643 - app.main - INFO - Database connections closed successfully
2025-04-01 15:14:15,643 - app.main - INFO - Database connections closed successfully
2025-04-01 15:14:16,018 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:16,375 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:17,329 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:14:17,680 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:18,992 - app.main - INFO - Starting up application
2025-04-01 15:14:18,992 - app.main - INFO - Starting up application
2025-04-01 15:14:19,048 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:14:19,048 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:19,051 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:14:19,051 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:19,053 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:14:19,053 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:19,055 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:14:19,060 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:19,061 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:19,064 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:19,064 - sqlalchemy.engine.Engine - INFO - [cached since 0.003857s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:19,065 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:19,066 - sqlalchemy.engine.Engine - INFO - [cached since 0.005321s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:19,067 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:14:19,068 - app.main - INFO - Database tables created successfully
2025-04-01 15:14:19,068 - app.main - INFO - Database tables created successfully
2025-04-01 15:14:19,134 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:26,956 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:27,090 - app.main - INFO - Shutting down application
2025-04-01 15:14:27,090 - app.main - INFO - Shutting down application
2025-04-01 15:14:27,095 - app.main - INFO - Database connections closed successfully
2025-04-01 15:14:27,095 - app.main - INFO - Database connections closed successfully
2025-04-01 15:14:27,464 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:27,865 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:29,075 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:14:29,426 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:30,720 - app.main - INFO - Starting up application
2025-04-01 15:14:30,720 - app.main - INFO - Starting up application
2025-04-01 15:14:30,781 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:14:30,781 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:30,784 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:14:30,784 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:30,787 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:14:30,787 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:30,789 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:14:30,794 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:30,794 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:30,797 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:30,798 - sqlalchemy.engine.Engine - INFO - [cached since 0.004632s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:30,800 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:30,801 - sqlalchemy.engine.Engine - INFO - [cached since 0.007259s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:30,803 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:14:30,804 - app.main - INFO - Database tables created successfully
2025-04-01 15:14:30,804 - app.main - INFO - Database tables created successfully
2025-04-01 15:14:30,880 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:37,799 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:37,924 - app.main - INFO - Shutting down application
2025-04-01 15:14:37,924 - app.main - INFO - Shutting down application
2025-04-01 15:14:37,927 - app.main - INFO - Database connections closed successfully
2025-04-01 15:14:37,927 - app.main - INFO - Database connections closed successfully
2025-04-01 15:14:38,295 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:38,696 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:14:41,607 - app.main - INFO - Starting up application
2025-04-01 15:14:41,607 - app.main - INFO - Starting up application
2025-04-01 15:14:41,661 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:14:41,662 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:41,665 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:14:41,665 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:41,667 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:14:41,667 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:14:41,669 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:14:41,674 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:41,675 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:41,678 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:41,678 - sqlalchemy.engine.Engine - INFO - [cached since 0.00393s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:41,679 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:14:41,680 - sqlalchemy.engine.Engine - INFO - [cached since 0.00534s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:14:41,681 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:14:41,682 - app.main - INFO - Database tables created successfully
2025-04-01 15:14:41,682 - app.main - INFO - Database tables created successfully
2025-04-01 15:14:41,710 - watchfiles.main - INFO - 3 changes detected
2025-04-01 15:14:58,432 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:14:58,451 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 15:14:58,451 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ('jamiebones2000@yahoo.co.uk',)
2025-04-01 15:14:58,460 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-01 15:14:58,508 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:14:58,818 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-01 15:14:58,819 - sqlalchemy.engine.Engine - INFO - [generated in 0.00101s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'jamiebones', 'jamiebones2000@yahoo.co.uk', '$2b$12$lf4AwnXOyimkoy.6mCpP8OVoWfWIB/7NR22VTXtQr/OFW68yDqJWO', datetime.datetime(2025, 4, 1, 15, 14, 58, 818411, tzinfo=datetime.timezone.utc))
2025-04-01 15:14:58,830 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:14:58,835 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:14:58,838 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-01 15:14:58,839 - sqlalchemy.engine.Engine - INFO - [generated in 0.00113s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:14:58,853 - sqlalchemy.engine.Engine - INFO - SELECT chats.id AS chats_id, chats.user_id AS chats_user_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp 
FROM chats 
WHERE $1::UUID = chats.user_id ORDER BY chats.timestamp DESC
2025-04-01 15:14:58,853 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:14:58,863 - sqlalchemy.engine.Engine - INFO - SELECT notes.id AS notes_id, notes.user_id AS notes_user_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE $1::UUID = notes.user_id ORDER BY notes.upload_date DESC
2025-04-01 15:14:58,865 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:14:58,875 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 15:14:58,878 - app.main - ERROR - Unhandled exception during request processing: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}

2025-04-01 15:14:58,878 - app.main - ERROR - Unhandled exception during request processing: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}

2025-04-01 15:16:49,468 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:16:49,621 - app.main - INFO - Shutting down application
2025-04-01 15:16:49,621 - app.main - INFO - Shutting down application
2025-04-01 15:16:49,629 - app.main - INFO - Database connections closed successfully
2025-04-01 15:16:49,629 - app.main - INFO - Database connections closed successfully
2025-04-01 15:16:50,000 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:16:51,003 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:16:51,355 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:16:51,707 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:08,704 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:09,057 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:09,408 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:09,909 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:17:11,733 - app.main - INFO - Starting up application
2025-04-01 15:17:11,733 - app.main - INFO - Starting up application
2025-04-01 15:17:11,794 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:17:11,794 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:17:11,798 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:17:11,798 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:17:11,801 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:17:11,802 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:17:11,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:17:11,810 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:17:11,810 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:17:11,815 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:17:11,815 - sqlalchemy.engine.Engine - INFO - [cached since 0.005538s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:17:11,817 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:17:11,817 - sqlalchemy.engine.Engine - INFO - [cached since 0.007691s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:17:11,820 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:17:11,821 - app.main - INFO - Database tables created successfully
2025-04-01 15:17:11,821 - app.main - INFO - Database tables created successfully
2025-04-01 15:17:12,016 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:12,367 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:12,718 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:12,824 - app.main - INFO - Shutting down application
2025-04-01 15:17:12,824 - app.main - INFO - Shutting down application
2025-04-01 15:17:12,829 - app.main - INFO - Database connections closed successfully
2025-04-01 15:17:12,829 - app.main - INFO - Database connections closed successfully
2025-04-01 15:17:14,152 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:17:14,503 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:14,854 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:15,916 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:17:16,267 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:16,619 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:17,926 - app.main - INFO - Starting up application
2025-04-01 15:17:17,926 - app.main - INFO - Starting up application
2025-04-01 15:17:17,981 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:17:17,981 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:17:17,985 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:17:17,985 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:17:17,987 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:17:17,988 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:17:17,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:17:17,994 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:17:17,995 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:17:17,999 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:17:17,999 - sqlalchemy.engine.Engine - INFO - [cached since 0.004679s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:17:18,000 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:17:18,001 - sqlalchemy.engine.Engine - INFO - [cached since 0.006344s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:17:18,002 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:17:18,004 - app.main - INFO - Database tables created successfully
2025-04-01 15:17:18,004 - app.main - INFO - Database tables created successfully
2025-04-01 15:17:18,022 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:18,373 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:25,463 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:17:25,488 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 15:17:25,489 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('jamiebones2000@yahoo.co.uk',)
2025-04-01 15:17:25,497 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 15:17:25,498 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:17:25,509 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 15:17:25,510 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:17:25,513 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 15:17:25,551 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:37,822 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:17:37,823 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 15:17:37,823 - sqlalchemy.engine.Engine - INFO - [cached since 12.34s ago] ('jamiebones@yahoo.co.uk',)
2025-04-01 15:17:37,826 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-01 15:17:38,139 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-01 15:17:38,139 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (UUID('b5a29dba-ece6-4562-b63a-7b85ea0d6b56'), 'jamiebones', 'jamiebones@yahoo.co.uk', '$2b$12$sfvCmL/b0cqDe57NkK/St.1u0YIJP5xRh8TelBnDnzfLZomPOnKUO', datetime.datetime(2025, 4, 1, 15, 17, 38, 139433, tzinfo=datetime.timezone.utc))
2025-04-01 15:17:38,146 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 15:17:38,148 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('b5a29dba-ece6-4562-b63a-7b85ea0d6b56'), 'jamiebones', 'jamiebones@yahoo.co.uk', '$2b$12$sfvCmL/b0cqDe57NkK/St.1u0YIJP5xRh8TelBnDnzfLZomPOnKUO', datetime.datetime(2025, 4, 1, 15, 17, 38, 139433, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 43, in register
    await db.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('b5a29dba-ece6-4562-b63a-7b85ea0d6b56'), 'jamiebones', 'jamiebones@yahoo.co.uk', '$2b$12$sfvCmL/b0cqDe57NkK/St.1u0YIJP5xRh8TelBnDnzfLZomPOnKUO', datetime.datetime(2025, 4, 1, 15, 17, 38, 139433, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-01 15:17:38,148 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('b5a29dba-ece6-4562-b63a-7b85ea0d6b56'), 'jamiebones', 'jamiebones@yahoo.co.uk', '$2b$12$sfvCmL/b0cqDe57NkK/St.1u0YIJP5xRh8TelBnDnzfLZomPOnKUO', datetime.datetime(2025, 4, 1, 15, 17, 38, 139433, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 43, in register
    await db.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
DETAIL:  Key (username)=(jamiebones) already exists.
[SQL: INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('b5a29dba-ece6-4562-b63a-7b85ea0d6b56'), 'jamiebones', 'jamiebones@yahoo.co.uk', '$2b$12$sfvCmL/b0cqDe57NkK/St.1u0YIJP5xRh8TelBnDnzfLZomPOnKUO', datetime.datetime(2025, 4, 1, 15, 17, 38, 139433, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-01 15:17:38,191 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:17:38,542 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:18:08,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:18:08,606 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 15:18:08,607 - sqlalchemy.engine.Engine - INFO - [cached since 43.12s ago] ('jamiebones@yahoo.co.uk',)
2025-04-01 15:18:08,875 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:18:08,897 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (id, username, email, hashed_password, created_at) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-01 15:18:08,897 - sqlalchemy.engine.Engine - INFO - [cached since 30.76s ago] (UUID('ae6c6082-a9f3-4758-8c73-c252e8d1793c'), 'jamie', 'jamiebones@yahoo.co.uk', '$2b$12$vni9OvAsFllkH2bRTT8q.ed1IRB61LrIRVW5l1cYp.kXB5yNYx3ba', datetime.datetime(2025, 4, 1, 15, 18, 8, 897164, tzinfo=datetime.timezone.utc))
2025-04-01 15:18:08,899 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:18:08,902 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:18:08,904 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-01 15:18:08,905 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (UUID('ae6c6082-a9f3-4758-8c73-c252e8d1793c'),)
2025-04-01 15:18:08,910 - sqlalchemy.engine.Engine - INFO - SELECT chats.id AS chats_id, chats.user_id AS chats_user_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp 
FROM chats 
WHERE $1::UUID = chats.user_id ORDER BY chats.timestamp DESC
2025-04-01 15:18:08,910 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] (UUID('ae6c6082-a9f3-4758-8c73-c252e8d1793c'),)
2025-04-01 15:18:08,915 - sqlalchemy.engine.Engine - INFO - SELECT notes.id AS notes_id, notes.user_id AS notes_user_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE $1::UUID = notes.user_id ORDER BY notes.upload_date DESC
2025-04-01 15:18:08,915 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] (UUID('ae6c6082-a9f3-4758-8c73-c252e8d1793c'),)
2025-04-01 15:18:08,918 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:18:18,116 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:18:18,116 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:18:18,502 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:18:31,541 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:18:31,541 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:18:31,689 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:48,401 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:48,566 - app.main - INFO - Shutting down application
2025-04-01 15:19:48,566 - app.main - INFO - Shutting down application
2025-04-01 15:19:48,571 - app.main - INFO - Database connections closed successfully
2025-04-01 15:19:48,571 - app.main - INFO - Database connections closed successfully
2025-04-01 15:19:48,970 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:50,474 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:50,826 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:51,400 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:19:51,752 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:52,103 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:52,463 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:52,914 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:19:54,878 - app.main - INFO - Starting up application
2025-04-01 15:19:54,878 - app.main - INFO - Starting up application
2025-04-01 15:19:54,934 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:19:54,934 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:19:54,938 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:19:54,938 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:19:54,940 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:19:54,940 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:19:54,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:19:54,947 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:19:54,947 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:19:54,951 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:19:54,951 - sqlalchemy.engine.Engine - INFO - [cached since 0.004453s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:19:54,953 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:19:54,953 - sqlalchemy.engine.Engine - INFO - [cached since 0.00645s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:19:54,955 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:19:54,957 - app.main - INFO - Database tables created successfully
2025-04-01 15:19:54,957 - app.main - INFO - Database tables created successfully
2025-04-01 15:19:55,020 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:19:55,371 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:21:07,180 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:21:07,342 - app.main - INFO - Shutting down application
2025-04-01 15:21:07,342 - app.main - INFO - Shutting down application
2025-04-01 15:21:07,348 - app.main - INFO - Database connections closed successfully
2025-04-01 15:21:07,348 - app.main - INFO - Database connections closed successfully
2025-04-01 15:21:07,720 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:21:08,372 - watchfiles.main - INFO - 2 changes detected
2025-04-01 15:21:08,723 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:21:10,336 - app.main - INFO - Starting up application
2025-04-01 15:21:10,336 - app.main - INFO - Starting up application
2025-04-01 15:21:10,390 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:21:10,391 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:21:10,394 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:21:10,394 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:21:10,396 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:21:10,396 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:21:10,398 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:21:10,403 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:21:10,403 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:21:10,406 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:21:10,407 - sqlalchemy.engine.Engine - INFO - [cached since 0.004199s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:21:10,408 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:21:10,408 - sqlalchemy.engine.Engine - INFO - [cached since 0.005671s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:21:10,410 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:21:10,411 - app.main - INFO - Database tables created successfully
2025-04-01 15:21:10,411 - app.main - INFO - Database tables created successfully
2025-04-01 15:21:10,477 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:21:49,237 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:21:49,237 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:21:49,585 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:23:41,336 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:23:41,336 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:23:41,504 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:26:33,145 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:26:33,145 - app.main - WARNING - Validation error: [{'type': 'missing', 'loc': ('body', 'username'), 'msg': 'Field required', 'input': None}, {'type': 'missing', 'loc': ('body', 'password'), 'msg': 'Field required', 'input': None}]
2025-04-01 15:26:33,450 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:47:07,050 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:47:07,065 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 15:47:07,065 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] ('jamiebones2000@yahoo.co.uk',)
2025-04-01 15:47:07,074 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 15:47:07,074 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:47:07,081 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 15:47:07,081 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:47:07,084 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-01 15:47:07,353 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:47:07,415 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 15:47:07,417 - app.main - ERROR - Unhandled exception during request processing: 'Settings' object has no attribute 'ALGORITHM'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 63, in login
    access_token = security.create_access_token(
  File "/backend/app/core/security.py", line 32, in create_access_token
    algorithm=settings.ALGORITHM
  File "/opt/conda/lib/python3.10/site-packages/pydantic/main.py", line 984, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Settings' object has no attribute 'ALGORITHM'
2025-04-01 15:47:07,417 - app.main - ERROR - Unhandled exception during request processing: 'Settings' object has no attribute 'ALGORITHM'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 63, in login
    access_token = security.create_access_token(
  File "/backend/app/core/security.py", line 32, in create_access_token
    algorithm=settings.ALGORITHM
  File "/opt/conda/lib/python3.10/site-packages/pydantic/main.py", line 984, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Settings' object has no attribute 'ALGORITHM'
2025-04-01 15:48:04,189 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:48:04,362 - app.main - INFO - Shutting down application
2025-04-01 15:48:04,362 - app.main - INFO - Shutting down application
2025-04-01 15:48:04,368 - app.main - INFO - Database connections closed successfully
2025-04-01 15:48:04,368 - app.main - INFO - Database connections closed successfully
2025-04-01 15:48:04,749 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:48:05,420 - watchfiles.main - INFO - 3 changes detected
2025-04-01 15:48:05,781 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:48:08,350 - app.main - INFO - Starting up application
2025-04-01 15:48:08,350 - app.main - INFO - Starting up application
2025-04-01 15:48:08,407 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 15:48:08,407 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:48:08,410 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 15:48:08,411 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:48:08,413 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 15:48:08,413 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 15:48:08,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:48:08,421 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:48:08,421 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:48:08,424 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:48:08,425 - sqlalchemy.engine.Engine - INFO - [cached since 0.004105s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:48:08,427 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 15:48:08,427 - sqlalchemy.engine.Engine - INFO - [cached since 0.006651s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 15:48:08,429 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:48:08,432 - app.main - INFO - Database tables created successfully
2025-04-01 15:48:08,432 - app.main - INFO - Database tables created successfully
2025-04-01 15:48:08,688 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:48:39,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 15:48:39,600 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 15:48:39,600 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] ('jamiebones2000@yahoo.co.uk',)
2025-04-01 15:48:39,611 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 15:48:39,611 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:48:39,620 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 15:48:39,620 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 15:48:39,624 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-01 15:48:39,675 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:48:39,922 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 15:48:41,919 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/backend/app/services/auth.py", line 45, in get_current_user
    user = db.query(User).filter(User.id == user_id).first()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 15:48:41,919 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/backend/app/services/auth.py", line 45, in get_current_user
    user = db.query(User).filter(User.id == user_id).first()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 15:48:42,024 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/backend/app/services/auth.py", line 45, in get_current_user
    user = db.query(User).filter(User.id == user_id).first()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 15:48:42,024 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/backend/app/services/auth.py", line 45, in get_current_user
    user = db.query(User).filter(User.id == user_id).first()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 15:48:42,101 - watchfiles.main - INFO - 1 change detected
2025-04-01 15:48:42,452 - watchfiles.main - INFO - 1 change detected
2025-04-01 19:47:25,562 - watchfiles.main - INFO - 1 change detected
2025-04-01 19:47:25,706 - app.main - INFO - Shutting down application
2025-04-01 19:47:25,706 - app.main - INFO - Shutting down application
2025-04-01 19:47:25,710 - app.main - INFO - Database connections closed successfully
2025-04-01 19:47:25,710 - app.main - INFO - Database connections closed successfully
2025-04-01 19:47:26,076 - watchfiles.main - INFO - 1 change detected
2025-04-01 19:47:26,427 - watchfiles.main - INFO - 1 change detected
2025-04-01 19:47:26,778 - watchfiles.main - INFO - 1 change detected
2025-04-01 19:47:27,136 - watchfiles.main - INFO - 2 changes detected
2025-04-01 19:47:27,489 - watchfiles.main - INFO - 1 change detected
2025-04-01 19:47:29,664 - app.main - INFO - Starting up application
2025-04-01 19:47:29,664 - app.main - INFO - Starting up application
2025-04-01 19:47:29,723 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 19:47:29,723 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 19:47:29,726 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 19:47:29,727 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 19:47:29,729 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 19:47:29,729 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 19:47:29,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 19:47:29,735 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 19:47:29,736 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 19:47:29,740 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 19:47:29,740 - sqlalchemy.engine.Engine - INFO - [cached since 0.005118s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 19:47:29,742 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 19:47:29,743 - sqlalchemy.engine.Engine - INFO - [cached since 0.00716s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 19:47:29,745 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 19:47:29,746 - app.main - INFO - Database tables created successfully
2025-04-01 19:47:29,746 - app.main - INFO - Database tables created successfully
2025-04-01 19:47:29,749 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:09,777 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:09,964 - app.main - INFO - Shutting down application
2025-04-01 20:06:09,964 - app.main - INFO - Shutting down application
2025-04-01 20:06:09,968 - app.main - INFO - Database connections closed successfully
2025-04-01 20:06:09,968 - app.main - INFO - Database connections closed successfully
2025-04-01 20:06:10,334 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:10,686 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:11,037 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:06:11,389 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:12,946 - app.main - INFO - Starting up application
2025-04-01 20:06:12,946 - app.main - INFO - Starting up application
2025-04-01 20:06:13,022 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:06:13,023 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:13,026 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:06:13,027 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:13,029 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:06:13,030 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:13,032 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:06:13,038 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:13,038 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:13,042 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:13,042 - sqlalchemy.engine.Engine - INFO - [cached since 0.004649s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:13,044 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:13,044 - sqlalchemy.engine.Engine - INFO - [cached since 0.006476s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:13,047 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:06:13,048 - app.main - INFO - Database tables created successfully
2025-04-01 20:06:13,048 - app.main - INFO - Database tables created successfully
2025-04-01 20:06:13,093 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:06:13,251 - app.main - INFO - Shutting down application
2025-04-01 20:06:13,251 - app.main - INFO - Shutting down application
2025-04-01 20:06:13,255 - app.main - INFO - Database connections closed successfully
2025-04-01 20:06:13,255 - app.main - INFO - Database connections closed successfully
2025-04-01 20:06:13,626 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:14,279 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:06:14,635 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:16,241 - app.main - INFO - Starting up application
2025-04-01 20:06:16,241 - app.main - INFO - Starting up application
2025-04-01 20:06:16,295 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:06:16,295 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:16,298 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:06:16,298 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:16,301 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:06:16,301 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:16,303 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:06:16,307 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:16,308 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:16,311 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:16,311 - sqlalchemy.engine.Engine - INFO - [cached since 0.004079s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:16,313 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:16,313 - sqlalchemy.engine.Engine - INFO - [cached since 0.006154s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:16,315 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:06:16,316 - app.main - INFO - Database tables created successfully
2025-04-01 20:06:16,316 - app.main - INFO - Database tables created successfully
2025-04-01 20:06:16,391 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:47,367 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:47,488 - app.main - INFO - Shutting down application
2025-04-01 20:06:47,488 - app.main - INFO - Shutting down application
2025-04-01 20:06:47,495 - app.main - INFO - Database connections closed successfully
2025-04-01 20:06:47,495 - app.main - INFO - Database connections closed successfully
2025-04-01 20:06:47,881 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:48,621 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:48,991 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:50,406 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:06:50,757 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:52,868 - app.main - INFO - Starting up application
2025-04-01 20:06:52,868 - app.main - INFO - Starting up application
2025-04-01 20:06:52,930 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:06:52,930 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:52,933 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:06:52,933 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:52,936 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:06:52,938 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:06:52,941 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:06:52,946 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:52,946 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:52,951 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:52,951 - sqlalchemy.engine.Engine - INFO - [cached since 0.005125s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:52,953 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:06:52,953 - sqlalchemy.engine.Engine - INFO - [cached since 0.007207s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:06:52,955 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:06:52,956 - app.main - INFO - Database tables created successfully
2025-04-01 20:06:52,956 - app.main - INFO - Database tables created successfully
2025-04-01 20:06:53,125 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:06:53,476 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:08:47,786 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:08:47,806 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-01 20:08:47,806 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('jamiebones2000@yahoo.co.uk',)
2025-04-01 20:08:47,819 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 20:08:47,819 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:47,838 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 20:08:47,839 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:47,843 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-01 20:08:47,945 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:08:48,201 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:08:48,382 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:08:48,388 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-01 20:08:48,393 - sqlalchemy.engine.Engine - INFO - [generated in 0.00851s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-01 20:08:48,410 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 20:08:48,412 - sqlalchemy.engine.Engine - INFO - [cached since 0.5936s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:48,419 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 20:08:48,420 - sqlalchemy.engine.Engine - INFO - [cached since 0.5815s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:48,429 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 20:08:48,436 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 20:08:48,436 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 20:08:48,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:08:48,488 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-01 20:08:48,489 - sqlalchemy.engine.Engine - INFO - [cached since 0.1049s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-01 20:08:48,501 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 20:08:48,501 - sqlalchemy.engine.Engine - INFO - [cached since 0.683s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:48,505 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 20:08:48,505 - sqlalchemy.engine.Engine - INFO - [cached since 0.6671s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:48,517 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 20:08:48,518 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 20:08:48,518 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-01 20:08:48,555 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:08:58,711 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:08:58,712 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-01 20:08:58,712 - sqlalchemy.engine.Engine - INFO - [cached since 10.33s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-01 20:08:58,724 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 20:08:58,724 - sqlalchemy.engine.Engine - INFO - [cached since 10.91s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:58,728 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 20:08:58,728 - sqlalchemy.engine.Engine - INFO - [cached since 10.89s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:08:58,772 - app.services.rag_service - INFO - Processing note None for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-01 20:08:58,772 - app.services.rag_service - INFO - Processing note None for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-01 20:08:58,779 - app.services.document_processing - INFO - Created 4 line-based chunks
2025-04-01 20:08:58,779 - app.services.document_processing - INFO - Created 4 line-based chunks
2025-04-01 20:08:58,780 - app.services.document_processing - INFO - Total document chunks created: 13
2025-04-01 20:08:58,780 - app.services.document_processing - INFO - Total document chunks created: 13
2025-04-01 20:08:58,780 - app.services.document_processing - INFO - Chunk 1: Dr. Anieti Udofia								March 19, 2025
Honourable Commisioner
Ministry of Culture and Tourisim
Uyo
...
2025-04-01 20:08:58,780 - app.services.document_processing - INFO - Chunk 1: Dr. Anieti Udofia								March 19, 2025
Honourable Commisioner
Ministry of Culture and Tourisim
Uyo
...
2025-04-01 20:08:58,780 - app.services.document_processing - INFO - Chunk 2: UNIUYO Senior Staff Club is delighted to celebrate your recent appointment as the Commissioner for C...
2025-04-01 20:08:58,780 - app.services.document_processing - INFO - Chunk 2: UNIUYO Senior Staff Club is delighted to celebrate your recent appointment as the Commissioner for C...
2025-04-01 20:08:58,781 - app.services.document_processing - INFO - Chunk 3: Your appointment fills us with immense pride, as it reflects the high esteem in which you are held b...
2025-04-01 20:08:58,781 - app.services.document_processing - INFO - Chunk 3: Your appointment fills us with immense pride, as it reflects the high esteem in which you are held b...
2025-04-01 20:08:58,781 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-01 20:08:58,781 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-01 20:08:58,781 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-01 20:08:58,781 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-01 20:08:59,085 - watchfiles.main - INFO - 3 changes detected
2025-04-01 20:08:59,437 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:09:05,714 - app - ERROR -  Vector store initialization failed: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1976, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/opt/conda/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/conda/lib/python3.10/site-packages/transformers/modeling_utils.py", line 55, in <module>
    from .integrations.flex_attention import flex_attention_forward
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 46, in <module>
    class WrappedFlexAttention:
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 61, in WrappedFlexAttention
    @torch.compiler.disable(recursive=False)
AttributeError: module 'torch' has no attribute 'compiler'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 26, in initialize
    self.embeddings = HuggingFaceEmbeddings(model_name=self.embedding_model)
  File "/opt/conda/lib/python3.10/site-packages/langchain_huggingface/embeddings/huggingface.py", line 52, in __init__
    import sentence_transformers  # type: ignore[import]
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/__init__.py", line 14, in <module>
    from sentence_transformers.cross_encoder import (
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py", line 15, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1964, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1978, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-01 20:09:05,714 - app - ERROR -  Vector store initialization failed: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1976, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/opt/conda/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/conda/lib/python3.10/site-packages/transformers/modeling_utils.py", line 55, in <module>
    from .integrations.flex_attention import flex_attention_forward
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 46, in <module>
    class WrappedFlexAttention:
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 61, in WrappedFlexAttention
    @torch.compiler.disable(recursive=False)
AttributeError: module 'torch' has no attribute 'compiler'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 26, in initialize
    self.embeddings = HuggingFaceEmbeddings(model_name=self.embedding_model)
  File "/opt/conda/lib/python3.10/site-packages/langchain_huggingface/embeddings/huggingface.py", line 52, in __init__
    import sentence_transformers  # type: ignore[import]
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/__init__.py", line 14, in <module>
    from sentence_transformers.cross_encoder import (
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py", line 15, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1964, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1978, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-01 20:09:05,726 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 20:09:05,728 - app.main - ERROR - Unhandled exception during request processing: 3 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'int_type', 'loc': ('response', 'user_id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': <app.models.notes.Note object at 0x7f0c5e1cb700>}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 3 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'int_type', 'loc': ('response', 'user_id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': <app.models.notes.Note object at 0x7f0c5e1cb700>}

2025-04-01 20:09:05,728 - app.main - ERROR - Unhandled exception during request processing: 3 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'int_type', 'loc': ('response', 'user_id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': <app.models.notes.Note object at 0x7f0c5e1cb700>}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 3 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'int_type', 'loc': ('response', 'user_id'), 'msg': 'Input should be a valid integer', 'input': UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a')}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': <app.models.notes.Note object at 0x7f0c5e1cb700>}

2025-04-01 20:09:06,004 - watchfiles.main - INFO - 3 changes detected
2025-04-01 20:10:29,892 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:10:30,048 - app.main - INFO - Shutting down application
2025-04-01 20:10:30,048 - app.main - INFO - Shutting down application
2025-04-01 20:10:30,052 - app.main - INFO - Database connections closed successfully
2025-04-01 20:10:30,052 - app.main - INFO - Database connections closed successfully
2025-04-01 20:10:30,438 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:10:32,856 - app.main - INFO - Starting up application
2025-04-01 20:10:32,856 - app.main - INFO - Starting up application
2025-04-01 20:10:32,895 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:10:32,913 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:10:32,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:10:32,916 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:10:32,917 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:10:32,919 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:10:32,919 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:10:32,922 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:10:32,927 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:10:32,927 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:10:32,931 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:10:32,932 - sqlalchemy.engine.Engine - INFO - [cached since 0.004846s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:10:32,933 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:10:32,934 - sqlalchemy.engine.Engine - INFO - [cached since 0.00682s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:10:32,935 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:10:32,936 - app.main - INFO - Database tables created successfully
2025-04-01 20:10:32,936 - app.main - INFO - Database tables created successfully
2025-04-01 20:10:33,247 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:10:33,598 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:12:22,957 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:12:23,128 - app.main - INFO - Shutting down application
2025-04-01 20:12:23,128 - app.main - INFO - Shutting down application
2025-04-01 20:12:23,132 - app.main - INFO - Database connections closed successfully
2025-04-01 20:12:23,132 - app.main - INFO - Database connections closed successfully
2025-04-01 20:12:23,502 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:12:25,916 - app.main - INFO - Starting up application
2025-04-01 20:12:25,916 - app.main - INFO - Starting up application
2025-04-01 20:12:25,959 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:12:25,971 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:12:25,971 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:12:25,974 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:12:25,975 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:12:25,977 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:12:25,977 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:12:25,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:12:25,984 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:12:25,984 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:12:25,987 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:12:25,987 - sqlalchemy.engine.Engine - INFO - [cached since 0.003878s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:12:25,989 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:12:25,989 - sqlalchemy.engine.Engine - INFO - [cached since 0.005439s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:12:25,990 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:12:25,991 - app.main - INFO - Database tables created successfully
2025-04-01 20:12:25,991 - app.main - INFO - Database tables created successfully
2025-04-01 20:12:26,310 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:12:26,662 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:14:12,317 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:14:12,333 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-01 20:14:12,333 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-01 20:14:12,342 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 20:14:12,342 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:14:12,351 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 20:14:12,351 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:14:12,366 - app.services.rag_service - INFO - Processing note None for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-01 20:14:12,366 - app.services.rag_service - INFO - Processing note None for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-01 20:14:12,369 - app.services.document_processing - INFO - Created 4 line-based chunks
2025-04-01 20:14:12,369 - app.services.document_processing - INFO - Created 4 line-based chunks
2025-04-01 20:14:12,370 - app.services.document_processing - INFO - Total document chunks created: 13
2025-04-01 20:14:12,370 - app.services.document_processing - INFO - Total document chunks created: 13
2025-04-01 20:14:12,370 - app.services.document_processing - INFO - Chunk 1: Dr. Anieti Udofia								March 19, 2025
Honourable Commisioner
Ministry of Culture and Tourisim
Uyo
...
2025-04-01 20:14:12,370 - app.services.document_processing - INFO - Chunk 1: Dr. Anieti Udofia								March 19, 2025
Honourable Commisioner
Ministry of Culture and Tourisim
Uyo
...
2025-04-01 20:14:12,372 - app.services.document_processing - INFO - Chunk 2: UNIUYO Senior Staff Club is delighted to celebrate your recent appointment as the Commissioner for C...
2025-04-01 20:14:12,372 - app.services.document_processing - INFO - Chunk 2: UNIUYO Senior Staff Club is delighted to celebrate your recent appointment as the Commissioner for C...
2025-04-01 20:14:12,372 - app.services.document_processing - INFO - Chunk 3: Your appointment fills us with immense pride, as it reflects the high esteem in which you are held b...
2025-04-01 20:14:12,372 - app.services.document_processing - INFO - Chunk 3: Your appointment fills us with immense pride, as it reflects the high esteem in which you are held b...
2025-04-01 20:14:12,374 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-01 20:14:12,374 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-01 20:14:12,374 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-01 20:14:12,374 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-01 20:14:12,663 - watchfiles.main - INFO - 3 changes detected
2025-04-01 20:14:15,191 - app - ERROR -  Vector store initialization failed: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1976, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/opt/conda/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/conda/lib/python3.10/site-packages/transformers/modeling_utils.py", line 55, in <module>
    from .integrations.flex_attention import flex_attention_forward
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 46, in <module>
    class WrappedFlexAttention:
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 61, in WrappedFlexAttention
    @torch.compiler.disable(recursive=False)
AttributeError: module 'torch' has no attribute 'compiler'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 26, in initialize
    self.embeddings = HuggingFaceEmbeddings(model_name=self.embedding_model)
  File "/opt/conda/lib/python3.10/site-packages/langchain_huggingface/embeddings/huggingface.py", line 52, in __init__
    import sentence_transformers  # type: ignore[import]
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/__init__.py", line 14, in <module>
    from sentence_transformers.cross_encoder import (
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py", line 15, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1964, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1978, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-01 20:14:15,191 - app - ERROR -  Vector store initialization failed: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1976, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/opt/conda/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/conda/lib/python3.10/site-packages/transformers/modeling_utils.py", line 55, in <module>
    from .integrations.flex_attention import flex_attention_forward
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 46, in <module>
    class WrappedFlexAttention:
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 61, in WrappedFlexAttention
    @torch.compiler.disable(recursive=False)
AttributeError: module 'torch' has no attribute 'compiler'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 26, in initialize
    self.embeddings = HuggingFaceEmbeddings(model_name=self.embedding_model)
  File "/opt/conda/lib/python3.10/site-packages/langchain_huggingface/embeddings/huggingface.py", line 52, in __init__
    import sentence_transformers  # type: ignore[import]
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/__init__.py", line 14, in <module>
    from sentence_transformers.cross_encoder import (
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py", line 15, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1964, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1978, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-01 20:14:15,201 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-01 20:14:15,203 - app.main - ERROR - Unhandled exception during request processing: 2 validation errors:
  {'type': 'uuid_type', 'loc': ('response', 'id'), 'msg': 'UUID input should be a string, bytes or UUID object', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'upload_date'), 'msg': 'Input should be a valid datetime', 'input': None}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'uuid_type', 'loc': ('response', 'id'), 'msg': 'UUID input should be a string, bytes or UUID object', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'upload_date'), 'msg': 'Input should be a valid datetime', 'input': None}

2025-04-01 20:14:15,203 - app.main - ERROR - Unhandled exception during request processing: 2 validation errors:
  {'type': 'uuid_type', 'loc': ('response', 'id'), 'msg': 'UUID input should be a string, bytes or UUID object', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'upload_date'), 'msg': 'Input should be a valid datetime', 'input': None}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'uuid_type', 'loc': ('response', 'id'), 'msg': 'UUID input should be a string, bytes or UUID object', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'upload_date'), 'msg': 'Input should be a valid datetime', 'input': None}

2025-04-01 20:14:15,371 - watchfiles.main - INFO - 3 changes detected
2025-04-01 20:16:43,147 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:16:43,278 - app.main - INFO - Shutting down application
2025-04-01 20:16:43,278 - app.main - INFO - Shutting down application
2025-04-01 20:16:43,283 - app.main - INFO - Database connections closed successfully
2025-04-01 20:16:43,283 - app.main - INFO - Database connections closed successfully
2025-04-01 20:16:43,677 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:16:46,634 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:16:46,877 - app.main - INFO - Starting up application
2025-04-01 20:16:46,877 - app.main - INFO - Starting up application
2025-04-01 20:16:46,971 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:16:46,971 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:16:46,976 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:16:46,976 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:16:46,979 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:16:46,979 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:16:46,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:16:46,985 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:16:46,990 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:16:46,991 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:16:46,995 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:16:46,995 - sqlalchemy.engine.Engine - INFO - [cached since 0.005475s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:16:46,997 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:16:46,997 - sqlalchemy.engine.Engine - INFO - [cached since 0.007487s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:16:47,000 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:16:47,001 - app.main - INFO - Database tables created successfully
2025-04-01 20:16:47,001 - app.main - INFO - Database tables created successfully
2025-04-01 20:18:16,533 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:18:16,732 - app.main - INFO - Shutting down application
2025-04-01 20:18:16,732 - app.main - INFO - Shutting down application
2025-04-01 20:18:16,736 - app.main - INFO - Database connections closed successfully
2025-04-01 20:18:16,736 - app.main - INFO - Database connections closed successfully
2025-04-01 20:18:17,106 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:18:17,457 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:18:19,504 - app.main - INFO - Starting up application
2025-04-01 20:18:19,504 - app.main - INFO - Starting up application
2025-04-01 20:18:19,559 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:18:19,559 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:18:19,562 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:18:19,562 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:18:19,564 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:18:19,564 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:18:19,565 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:18:19,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:18:19,571 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:18:19,571 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:18:19,574 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:18:19,575 - sqlalchemy.engine.Engine - INFO - [cached since 0.004115s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:18:19,576 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:18:19,576 - sqlalchemy.engine.Engine - INFO - [cached since 0.00555s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:18:19,578 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:18:19,579 - app.main - INFO - Database tables created successfully
2025-04-01 20:18:19,579 - app.main - INFO - Database tables created successfully
2025-04-01 20:18:19,916 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:44,652 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:44,802 - app.main - INFO - Shutting down application
2025-04-01 20:19:44,802 - app.main - INFO - Shutting down application
2025-04-01 20:19:44,806 - app.main - INFO - Database connections closed successfully
2025-04-01 20:19:44,806 - app.main - INFO - Database connections closed successfully
2025-04-01 20:19:45,183 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:45,534 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:46,135 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:46,496 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:56,975 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:57,327 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:57,678 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:19:59,969 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:00,335 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:00,685 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:02,690 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:20:02,821 - app.main - INFO - Starting up application
2025-04-01 20:20:02,821 - app.main - INFO - Starting up application
2025-04-01 20:20:02,878 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:20:02,878 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:02,881 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:20:02,882 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:02,884 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:20:02,884 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:02,886 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:20:02,891 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:02,891 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:02,894 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:02,894 - sqlalchemy.engine.Engine - INFO - [cached since 0.003733s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:02,895 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:02,896 - sqlalchemy.engine.Engine - INFO - [cached since 0.00528s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:02,897 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:20:02,898 - app.main - INFO - Database tables created successfully
2025-04-01 20:20:02,898 - app.main - INFO - Database tables created successfully
2025-04-01 20:20:03,041 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:03,392 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:14,423 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:14,530 - app.main - INFO - Shutting down application
2025-04-01 20:20:14,530 - app.main - INFO - Shutting down application
2025-04-01 20:20:14,534 - app.main - INFO - Database connections closed successfully
2025-04-01 20:20:14,534 - app.main - INFO - Database connections closed successfully
2025-04-01 20:20:14,903 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:17,410 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:20:17,566 - app.main - INFO - Starting up application
2025-04-01 20:20:17,566 - app.main - INFO - Starting up application
2025-04-01 20:20:17,623 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:20:17,623 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:17,626 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:20:17,626 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:17,628 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:20:17,629 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:17,631 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:20:17,636 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:17,636 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:17,640 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:17,640 - sqlalchemy.engine.Engine - INFO - [cached since 0.004471s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:17,641 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:17,642 - sqlalchemy.engine.Engine - INFO - [cached since 0.006263s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:17,644 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:20:17,645 - app.main - INFO - Database tables created successfully
2025-04-01 20:20:17,645 - app.main - INFO - Database tables created successfully
2025-04-01 20:20:17,760 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:29,442 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:29,577 - app.main - INFO - Shutting down application
2025-04-01 20:20:29,577 - app.main - INFO - Shutting down application
2025-04-01 20:20:29,583 - app.main - INFO - Database connections closed successfully
2025-04-01 20:20:29,583 - app.main - INFO - Database connections closed successfully
2025-04-01 20:20:29,958 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:32,465 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:20:32,525 - app.main - INFO - Starting up application
2025-04-01 20:20:32,525 - app.main - INFO - Starting up application
2025-04-01 20:20:32,582 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:20:32,583 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:32,585 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:20:32,586 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:32,588 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:20:32,588 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:20:32,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:20:32,598 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:32,598 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:32,602 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:32,603 - sqlalchemy.engine.Engine - INFO - [cached since 0.00463s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:32,604 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:20:32,604 - sqlalchemy.engine.Engine - INFO - [cached since 0.006435s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:20:32,606 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:20:32,608 - app.main - INFO - Database tables created successfully
2025-04-01 20:20:32,608 - app.main - INFO - Database tables created successfully
2025-04-01 20:20:32,816 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:20:57,292 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:20:57,306 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-01 20:20:57,306 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-01 20:20:57,315 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-01 20:20:57,315 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:20:57,323 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-01 20:20:57,324 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-01 20:20:57,337 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-01 20:20:57,338 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] (UUID('3e905fff-9d72-4ead-9cab-0652f0d2c912'), datetime.datetime(2025, 4, 1, 20, 20, 57, 337623, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'Dr. Anieti Udofia\t\t\t\t\t\t\t\tMarch 19, 2025\nHonourable Commisioner\nMinistry of Culture and Tourisim\nUyo\nAkwa Ibom State\nCONGRATULATORY LETTE ... (933 characters truncated) ... Dr. Otoabasi Ansa\t\t\t\tOsikhena James Oshomah\nPresident, UNIUYO Senior Staff Club\t              General Secretary, UNIUYO Senior Staff Club\n\n\n', 'congratulatory-letter-Anieti-Udofia.docx')
2025-04-01 20:20:57,345 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:20:57,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:20:57,356 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-01 20:20:57,356 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (UUID('3e905fff-9d72-4ead-9cab-0652f0d2c912'),)
2025-04-01 20:20:57,360 - app.services.rag_service - INFO - Processing note 3e905fff-9d72-4ead-9cab-0652f0d2c912 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-01 20:20:57,360 - app.services.rag_service - INFO - Processing note 3e905fff-9d72-4ead-9cab-0652f0d2c912 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-01 20:20:57,362 - app.services.document_processing - INFO - Created 4 line-based chunks
2025-04-01 20:20:57,362 - app.services.document_processing - INFO - Created 4 line-based chunks
2025-04-01 20:20:57,363 - app.services.document_processing - INFO - Total document chunks created: 13
2025-04-01 20:20:57,363 - app.services.document_processing - INFO - Total document chunks created: 13
2025-04-01 20:20:57,363 - app.services.document_processing - INFO - Chunk 1: Dr. Anieti Udofia								March 19, 2025
Honourable Commisioner
Ministry of Culture and Tourisim
Uyo
...
2025-04-01 20:20:57,363 - app.services.document_processing - INFO - Chunk 1: Dr. Anieti Udofia								March 19, 2025
Honourable Commisioner
Ministry of Culture and Tourisim
Uyo
...
2025-04-01 20:20:57,363 - app.services.document_processing - INFO - Chunk 2: UNIUYO Senior Staff Club is delighted to celebrate your recent appointment as the Commissioner for C...
2025-04-01 20:20:57,363 - app.services.document_processing - INFO - Chunk 2: UNIUYO Senior Staff Club is delighted to celebrate your recent appointment as the Commissioner for C...
2025-04-01 20:20:57,364 - app.services.document_processing - INFO - Chunk 3: Your appointment fills us with immense pride, as it reflects the high esteem in which you are held b...
2025-04-01 20:20:57,364 - app.services.document_processing - INFO - Chunk 3: Your appointment fills us with immense pride, as it reflects the high esteem in which you are held b...
2025-04-01 20:20:57,364 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-01 20:20:57,364 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-01 20:20:57,365 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-01 20:20:57,365 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-01 20:20:57,434 - watchfiles.main - INFO - 3 changes detected
2025-04-01 20:21:00,207 - app - ERROR -  Vector store initialization failed: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1976, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/opt/conda/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/conda/lib/python3.10/site-packages/transformers/modeling_utils.py", line 55, in <module>
    from .integrations.flex_attention import flex_attention_forward
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 46, in <module>
    class WrappedFlexAttention:
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 61, in WrappedFlexAttention
    @torch.compiler.disable(recursive=False)
AttributeError: module 'torch' has no attribute 'compiler'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 26, in initialize
    self.embeddings = HuggingFaceEmbeddings(model_name=self.embedding_model)
  File "/opt/conda/lib/python3.10/site-packages/langchain_huggingface/embeddings/huggingface.py", line 52, in __init__
    import sentence_transformers  # type: ignore[import]
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/__init__.py", line 14, in <module>
    from sentence_transformers.cross_encoder import (
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py", line 15, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1964, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1978, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-01 20:21:00,207 - app - ERROR -  Vector store initialization failed: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1976, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/opt/conda/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/conda/lib/python3.10/site-packages/transformers/modeling_utils.py", line 55, in <module>
    from .integrations.flex_attention import flex_attention_forward
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 46, in <module>
    class WrappedFlexAttention:
  File "/opt/conda/lib/python3.10/site-packages/transformers/integrations/flex_attention.py", line 61, in WrappedFlexAttention
    @torch.compiler.disable(recursive=False)
AttributeError: module 'torch' has no attribute 'compiler'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 26, in initialize
    self.embeddings = HuggingFaceEmbeddings(model_name=self.embedding_model)
  File "/opt/conda/lib/python3.10/site-packages/langchain_huggingface/embeddings/huggingface.py", line 52, in __init__
    import sentence_transformers  # type: ignore[import]
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/__init__.py", line 14, in <module>
    from sentence_transformers.cross_encoder import (
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "/opt/conda/lib/python3.10/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py", line 15, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1964, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/opt/conda/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1978, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-01 20:21:00,210 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:21:00,393 - watchfiles.main - INFO - 3 changes detected
2025-04-01 20:26:27,220 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:26:27,376 - app.main - INFO - Shutting down application
2025-04-01 20:26:27,376 - app.main - INFO - Shutting down application
2025-04-01 20:26:27,415 - app.main - INFO - Database connections closed successfully
2025-04-01 20:26:27,415 - app.main - INFO - Database connections closed successfully
2025-04-01 20:26:27,907 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:26:29,964 - watchfiles.main - INFO - 2 changes detected
2025-04-01 20:26:30,315 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:26:30,666 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:26:31,074 - app.main - INFO - Starting up application
2025-04-01 20:26:31,074 - app.main - INFO - Starting up application
2025-04-01 20:26:31,134 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-01 20:26:31,134 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:26:31,138 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-01 20:26:31,138 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:26:31,140 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-01 20:26:31,141 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-01 20:26:31,143 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-01 20:26:31,148 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:26:31,148 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:26:31,151 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:26:31,152 - sqlalchemy.engine.Engine - INFO - [cached since 0.004304s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:26:31,153 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-01 20:26:31,153 - sqlalchemy.engine.Engine - INFO - [cached since 0.005746s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-01 20:26:31,155 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-01 20:26:31,156 - app.main - INFO - Database tables created successfully
2025-04-01 20:26:31,156 - app.main - INFO - Database tables created successfully
2025-04-01 20:26:31,167 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:31:12,274 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:31:12,625 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:31:21,300 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:31:21,651 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:32:57,823 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:32:58,174 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:32:58,525 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:33:49,517 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:33:49,868 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:35:26,058 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:35:26,409 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:37:03,444 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:37:03,795 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:46:14,048 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:46:14,399 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:46:14,750 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:56:26,248 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:56:26,600 - watchfiles.main - INFO - 1 change detected
2025-04-01 20:56:26,951 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:40:32,436 - __main__ - INFO - Starting development server
2025-04-02 03:40:37,233 - app.main - INFO - Starting up application
2025-04-02 03:40:37,233 - app.main - INFO - Starting up application
2025-04-02 03:40:37,331 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 03:40:37,332 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 03:40:37,336 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 03:40:37,336 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 03:40:37,339 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 03:40:37,339 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 03:40:37,341 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 03:40:37,345 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 03:40:37,346 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 03:40:37,357 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 03:40:37,358 - sqlalchemy.engine.Engine - INFO - [cached since 0.01265s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 03:40:37,359 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 03:40:37,360 - sqlalchemy.engine.Engine - INFO - [cached since 0.01429s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 03:40:37,361 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 03:40:37,363 - app.main - INFO - Database tables created successfully
2025-04-02 03:40:37,363 - app.main - INFO - Database tables created successfully
2025-04-02 03:40:37,608 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:21,870 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 03:41:21,882 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 03:41:21,882 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 03:41:21,892 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:21,892 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:21,902 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 03:41:21,903 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:21,909 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:21,910 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:21,912 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-02 03:41:22,085 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:22,231 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 03:41:22,412 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 03:41:22,416 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 03:41:22,417 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 03:41:22,428 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:22,428 - sqlalchemy.engine.Engine - INFO - [cached since 0.5368s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:22,432 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 03:41:22,433 - sqlalchemy.engine.Engine - INFO - [cached since 0.5307s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:22,436 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:22,438 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:22,438 - sqlalchemy.engine.Engine - INFO - [cached since 0.5293s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:22,442 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 03:41:22,445 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 03:41:22,445 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 03:41:22,484 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 03:41:22,486 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 03:41:22,486 - sqlalchemy.engine.Engine - INFO - [cached since 0.06979s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 03:41:22,497 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:22,498 - sqlalchemy.engine.Engine - INFO - [cached since 0.6066s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:22,502 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 03:41:22,502 - sqlalchemy.engine.Engine - INFO - [cached since 0.6s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:22,507 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:22,517 - sqlalchemy.engine.Engine - INFO - [cached since 0.6075s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:22,521 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 03:41:22,523 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 03:41:22,523 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 03:41:46,847 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 03:41:46,848 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 03:41:46,848 - sqlalchemy.engine.Engine - INFO - [cached since 24.43s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 03:41:46,850 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:46,850 - sqlalchemy.engine.Engine - INFO - [cached since 24.96s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:46,854 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 03:41:46,854 - sqlalchemy.engine.Engine - INFO - [cached since 24.95s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:46,858 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 03:41:46,858 - sqlalchemy.engine.Engine - INFO - [cached since 24.95s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 03:41:46,882 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 03:41:46,883 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (UUID('b073b7bc-05be-44e3-91ea-68ad99520850'), datetime.datetime(2025, 4, 2, 3, 41, 46, 882630, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 03:41:46,908 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 03:41:46,999 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 03:41:47,003 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 03:41:47,003 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (UUID('b073b7bc-05be-44e3-91ea-68ad99520850'),)
2025-04-02 03:41:47,006 - app.services.rag_service - INFO - Processing note b073b7bc-05be-44e3-91ea-68ad99520850 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 03:41:47,006 - app.services.rag_service - INFO - Processing note b073b7bc-05be-44e3-91ea-68ad99520850 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 03:41:47,007 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 03:41:47,007 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 03:41:47,008 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 03:41:47,009 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 03:41:47,009 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 03:41:47,009 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 03:41:47,009 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 03:41:47,061 - watchfiles.main - INFO - 3 changes detected
2025-04-02 03:41:47,412 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:53,567 - app - ERROR - Failed to initialize embeddings: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-02 03:41:53,567 - app - ERROR - Failed to initialize embeddings: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
module 'torch' has no attribute 'compiler'
2025-04-02 03:41:53,568 - app - INFO - Creating vector store
2025-04-02 03:41:53,568 - app - INFO - Creating vector store
2025-04-02 03:41:53,679 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:54,113 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-02 03:41:54,280 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:54,631 - watchfiles.main - INFO - 3 changes detected
2025-04-02 03:41:54,982 - watchfiles.main - INFO - 2 changes detected
2025-04-02 03:41:55,333 - watchfiles.main - INFO - 3 changes detected
2025-04-02 03:41:55,684 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:56,387 - watchfiles.main - INFO - 3 changes detected
2025-04-02 03:41:56,739 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:57,893 - watchfiles.main - INFO - 2 changes detected
2025-04-02 03:41:58,243 - watchfiles.main - INFO - 4 changes detected
2025-04-02 03:41:58,594 - watchfiles.main - INFO - 1 change detected
2025-04-02 03:41:59,081 - app - INFO -  Vector store initialized successfully
2025-04-02 03:41:59,081 - app - INFO -  Vector store initialized successfully
2025-04-02 03:41:59,082 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 03:41:59,096 - watchfiles.main - INFO - 2 changes detected
2025-04-02 03:41:59,447 - watchfiles.main - INFO - 11 changes detected
2025-04-02 04:13:37,622 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:13:37,974 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:13:39,127 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:13:39,478 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:52:59,956 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:00,122 - app.main - INFO - Shutting down application
2025-04-02 04:53:00,122 - app.main - INFO - Shutting down application
2025-04-02 04:53:00,142 - app.main - INFO - Database connections closed successfully
2025-04-02 04:53:00,142 - app.main - INFO - Database connections closed successfully
2025-04-02 04:53:00,541 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:03,574 - watchfiles.main - INFO - 2 changes detected
2025-04-02 04:53:03,925 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:05,002 - app.main - INFO - Starting up application
2025-04-02 04:53:05,002 - app.main - INFO - Starting up application
2025-04-02 04:53:05,074 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 04:53:05,074 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:05,078 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 04:53:05,078 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:05,078 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:05,081 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 04:53:05,082 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:05,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 04:53:05,091 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:05,091 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:05,096 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:05,096 - sqlalchemy.engine.Engine - INFO - [cached since 0.005414s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:05,097 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:05,097 - sqlalchemy.engine.Engine - INFO - [cached since 0.006807s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:05,099 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 04:53:05,100 - app.main - INFO - Database tables created successfully
2025-04-02 04:53:05,100 - app.main - INFO - Database tables created successfully
2025-04-02 04:53:05,430 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:18,027 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:18,135 - app.main - INFO - Shutting down application
2025-04-02 04:53:18,135 - app.main - INFO - Shutting down application
2025-04-02 04:53:18,139 - app.main - INFO - Database connections closed successfully
2025-04-02 04:53:18,139 - app.main - INFO - Database connections closed successfully
2025-04-02 04:53:18,508 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:20,412 - watchfiles.main - INFO - 2 changes detected
2025-04-02 04:53:20,763 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:21,345 - app.main - INFO - Starting up application
2025-04-02 04:53:21,345 - app.main - INFO - Starting up application
2025-04-02 04:53:21,400 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 04:53:21,400 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:21,404 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 04:53:21,405 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:21,407 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 04:53:21,407 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:21,409 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 04:53:21,414 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:21,414 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:21,418 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:21,418 - sqlalchemy.engine.Engine - INFO - [cached since 0.004248s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:21,420 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:21,420 - sqlalchemy.engine.Engine - INFO - [cached since 0.006283s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:21,422 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 04:53:21,423 - app.main - INFO - Database tables created successfully
2025-04-02 04:53:21,423 - app.main - INFO - Database tables created successfully
2025-04-02 04:53:21,616 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:35,459 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:35,660 - app.main - INFO - Shutting down application
2025-04-02 04:53:35,660 - app.main - INFO - Shutting down application
2025-04-02 04:53:35,664 - app.main - INFO - Database connections closed successfully
2025-04-02 04:53:35,664 - app.main - INFO - Database connections closed successfully
2025-04-02 04:53:36,039 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:36,390 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:38,144 - watchfiles.main - INFO - 2 changes detected
2025-04-02 04:53:38,496 - watchfiles.main - INFO - 1 change detected
2025-04-02 04:53:38,890 - app.main - INFO - Starting up application
2025-04-02 04:53:38,890 - app.main - INFO - Starting up application
2025-04-02 04:53:38,949 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 04:53:38,950 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:38,954 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 04:53:38,954 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:38,956 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 04:53:38,957 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 04:53:38,959 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 04:53:38,963 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:38,963 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:38,968 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:38,969 - sqlalchemy.engine.Engine - INFO - [cached since 0.00565s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:38,970 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 04:53:38,970 - sqlalchemy.engine.Engine - INFO - [cached since 0.007287s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 04:53:38,972 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 04:53:38,973 - app.main - INFO - Database tables created successfully
2025-04-02 04:53:38,973 - app.main - INFO - Database tables created successfully
2025-04-02 07:06:18,337 - __main__ - INFO - Starting development server
2025-04-02 07:06:21,725 - app.main - INFO - Starting up application
2025-04-02 07:06:21,725 - app.main - INFO - Starting up application
2025-04-02 07:06:21,816 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 07:06:21,816 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 07:06:21,821 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 07:06:21,822 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 07:06:21,824 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 07:06:21,825 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 07:06:21,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 07:06:21,834 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 07:06:21,834 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 07:06:21,842 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 07:06:21,843 - sqlalchemy.engine.Engine - INFO - [cached since 0.008791s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 07:06:21,844 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 07:06:21,845 - sqlalchemy.engine.Engine - INFO - [cached since 0.01084s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 07:06:21,846 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 07:06:21,847 - app.main - INFO - Database tables created successfully
2025-04-02 07:06:21,847 - app.main - INFO - Database tables created successfully
2025-04-02 07:06:21,961 - watchfiles.main - INFO - 1 change detected
2025-04-02 07:06:41,039 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 07:06:41,055 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 07:06:41,055 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 07:06:41,069 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:41,070 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,080 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 07:06:41,080 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,086 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:41,086 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,089 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-02 07:06:41,219 - watchfiles.main - INFO - 1 change detected
2025-04-02 07:06:41,432 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 07:06:41,610 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 07:06:41,619 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 07:06:41,619 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 07:06:41,627 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:41,628 - sqlalchemy.engine.Engine - INFO - [cached since 0.5589s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,631 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 07:06:41,632 - sqlalchemy.engine.Engine - INFO - [cached since 0.5521s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,638 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:41,638 - sqlalchemy.engine.Engine - INFO - [cached since 0.5522s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,640 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 07:06:41,644 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 07:06:41,644 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 07:06:41,755 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 07:06:41,762 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 07:06:41,764 - sqlalchemy.engine.Engine - INFO - [cached since 0.1455s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 07:06:41,768 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:41,768 - sqlalchemy.engine.Engine - INFO - [cached since 0.6992s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,771 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 07:06:41,772 - sqlalchemy.engine.Engine - INFO - [cached since 0.6919s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,779 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:41,780 - sqlalchemy.engine.Engine - INFO - [cached since 0.6936s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:41,783 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 07:06:41,785 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 07:06:41,785 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 07:06:49,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 07:06:49,990 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 07:06:49,991 - sqlalchemy.engine.Engine - INFO - [cached since 8.372s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 07:06:49,993 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:49,994 - sqlalchemy.engine.Engine - INFO - [cached since 8.925s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:49,996 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 07:06:49,996 - sqlalchemy.engine.Engine - INFO - [cached since 8.916s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:49,999 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 07:06:49,999 - sqlalchemy.engine.Engine - INFO - [cached since 8.914s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 07:06:50,106 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 07:06:50,107 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (UUID('5706dd35-c5b8-4338-99a9-3ae3d68b8339'), datetime.datetime(2025, 4, 2, 7, 6, 50, 106491, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), ' \n \n \n \n \n \n \n \n \n \n \nDr Cletus Bassey         March 22 , 2025   \nDepartment of Fine Art  \nFaculty of Environmental Stu dies \nUniversit ... (1701 characters truncated) ...            Secretary:  Osikhena  J. Oshomah  \nSENIOR  STAFF  CLUB  \nP.M.B.  1017,  Uyo, Akwa  Ibom  State,  Nigeria  \nUNIVERSITY OF  UYO  \nT \n\n', 'Dr-Cletus-Bassey-Condolence-letter.pdf')
2025-04-02 07:06:50,112 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 07:06:50,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 07:06:50,121 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 07:06:50,121 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('5706dd35-c5b8-4338-99a9-3ae3d68b8339'),)
2025-04-02 07:06:50,125 - app.services.rag_service - INFO - Processing note 5706dd35-c5b8-4338-99a9-3ae3d68b8339 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 07:06:50,125 - app.services.rag_service - INFO - Processing note 5706dd35-c5b8-4338-99a9-3ae3d68b8339 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 07:06:50,127 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 07:06:50,127 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Total document chunks created: 25
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Total document chunks created: 25
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Chunk 1: Dr Cletus Bassey         March 22 , 2025   
Department of Fine Art  
Faculty of Environmental Stu di...
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Chunk 1: Dr Cletus Bassey         March 22 , 2025   
Department of Fine Art  
Faculty of Environmental Stu di...
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Chunk 2: University of Uyo  
Uyo 
Akwa Ibom State  
 
MESSAGE OF CONDOLENCE  
It is with heavy hearts that we...
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Chunk 2: University of Uyo  
Uyo 
Akwa Ibom State  
 
MESSAGE OF CONDOLENCE  
It is with heavy hearts that we...
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Chunk 3: Staff Club  (Since 1980) , extend our deepest condolences to you and your 
family on the passing of ...
2025-04-02 07:06:50,128 - app.services.document_processing - INFO - Chunk 3: Staff Club  (Since 1980) , extend our deepest condolences to you and your 
family on the passing of ...
2025-04-02 07:06:50,129 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 07:06:50,129 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 07:06:50,129 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 07:06:50,129 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 07:06:50,247 - watchfiles.main - INFO - 3 changes detected
2025-04-02 07:06:57,186 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-02 07:06:57,186 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 07:06:57,468 - watchfiles.main - INFO - 1 change detected
2025-04-02 07:07:47,230 - app - INFO - Removing existing vector store at /backend/backend/chroma_db
2025-04-02 07:07:47,230 - app - INFO - Removing existing vector store at /backend/backend/chroma_db
2025-04-02 07:07:47,237 - app - INFO - Creating vector store
2025-04-02 07:07:47,237 - app - INFO - Creating vector store
2025-04-02 07:07:47,398 - watchfiles.main - INFO - 9 changes detected
2025-04-02 07:07:47,996 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-02 07:07:48,301 - watchfiles.main - INFO - 2 changes detected
2025-04-02 07:07:48,652 - watchfiles.main - INFO - 3 changes detected
2025-04-02 07:07:49,003 - watchfiles.main - INFO - 1 change detected
2025-04-02 07:07:49,353 - watchfiles.main - INFO - 2 changes detected
2025-04-02 07:07:49,704 - watchfiles.main - INFO - 1 change detected
2025-04-02 07:07:50,403 - app - INFO -  Vector store initialized successfully
2025-04-02 07:07:50,403 - app - INFO -  Vector store initialized successfully
2025-04-02 07:07:50,404 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 07:07:50,707 - watchfiles.main - INFO - 10 changes detected
2025-04-02 08:53:53,951 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 08:53:53,967 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 08:53:53,968 - sqlalchemy.engine.Engine - INFO - [cached since 2602s ago] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 08:53:54,037 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:53:54,038 - sqlalchemy.engine.Engine - INFO - [cached since 2602s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:54,055 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 08:53:54,057 - sqlalchemy.engine.Engine - INFO - [cached since 2602s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:54,070 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:53:54,071 - sqlalchemy.engine.Engine - INFO - [cached since 2602s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:54,084 - watchfiles.main - INFO - 1 change detected
2025-04-02 08:53:54,455 - watchfiles.main - INFO - 1 change detected
2025-04-02 08:53:54,635 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 08:53:55,094 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 08:53:55,104 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 08:53:55,107 - sqlalchemy.engine.Engine - INFO - [cached since 2602s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 08:53:55,132 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:53:55,133 - sqlalchemy.engine.Engine - INFO - [cached since 2603s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:55,146 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 08:53:55,149 - sqlalchemy.engine.Engine - INFO - [cached since 2603s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:55,161 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:53:55,165 - sqlalchemy.engine.Engine - INFO - [cached since 2603s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:55,173 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 08:53:55,194 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 08:53:55,194 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 08:53:55,283 - watchfiles.main - INFO - 1 change detected
2025-04-02 08:53:55,305 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 08:53:55,308 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 08:53:55,310 - sqlalchemy.engine.Engine - INFO - [cached since 2602s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 08:53:55,347 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:53:55,348 - sqlalchemy.engine.Engine - INFO - [cached since 2603s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:55,365 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 08:53:55,366 - sqlalchemy.engine.Engine - INFO - [cached since 2603s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:55,384 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:53:55,385 - sqlalchemy.engine.Engine - INFO - [cached since 2603s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:53:55,389 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 08:53:55,392 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 08:53:55,392 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 45, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 08:54:17,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 08:54:17,719 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 08:54:17,720 - sqlalchemy.engine.Engine - INFO - [cached since 2625s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 08:54:17,735 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:54:17,736 - sqlalchemy.engine.Engine - INFO - [cached since 2625s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:54:17,742 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 08:54:17,743 - sqlalchemy.engine.Engine - INFO - [cached since 2625s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:54:17,749 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 08:54:17,749 - sqlalchemy.engine.Engine - INFO - [cached since 2625s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 08:54:17,786 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Prof Sunday Ita is in which department
2025-04-02 08:54:17,786 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Prof Sunday Ita is in which department
2025-04-02 08:54:17,789 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 08:54:17,794 - app.main - ERROR - Unhandled exception during request processing: VectorStore.hybrid_search() got an unexpected keyword argument 'filter'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 20, in send_message
    rag_response = query_notes(current_user.id, chat_request.message)
  File "/backend/app/services/rag_service.py", line 283, in query_notes
    return rag_service.query_for_user(user_id, query)
  File "/backend/app/services/rag_service.py", line 208, in query_for_user
    context = self.retriever.hybrid_search(query, filter={"user_id": str(user_id)})
TypeError: VectorStore.hybrid_search() got an unexpected keyword argument 'filter'
2025-04-02 08:54:17,794 - app.main - ERROR - Unhandled exception during request processing: VectorStore.hybrid_search() got an unexpected keyword argument 'filter'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 20, in send_message
    rag_response = query_notes(current_user.id, chat_request.message)
  File "/backend/app/services/rag_service.py", line 283, in query_notes
    return rag_service.query_for_user(user_id, query)
  File "/backend/app/services/rag_service.py", line 208, in query_for_user
    context = self.retriever.hybrid_search(query, filter={"user_id": str(user_id)})
TypeError: VectorStore.hybrid_search() got an unexpected keyword argument 'filter'
2025-04-02 08:54:17,884 - watchfiles.main - INFO - 1 change detected
2025-04-02 08:57:41,836 - watchfiles.main - INFO - 1 change detected
2025-04-02 08:57:42,102 - app.main - INFO - Shutting down application
2025-04-02 08:57:42,102 - app.main - INFO - Shutting down application
2025-04-02 08:57:42,146 - app.main - INFO - Database connections closed successfully
2025-04-02 08:57:42,146 - app.main - INFO - Database connections closed successfully
2025-04-02 08:57:42,859 - watchfiles.main - INFO - 2 changes detected
2025-04-02 08:57:48,745 - watchfiles.main - INFO - 2 changes detected
2025-04-02 08:57:49,098 - watchfiles.main - INFO - 1 change detected
2025-04-02 08:57:49,449 - watchfiles.main - INFO - 1 change detected
2025-04-02 08:57:55,734 - app.main - INFO - Starting up application
2025-04-02 08:57:55,734 - app.main - INFO - Starting up application
2025-04-02 08:57:55,888 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 08:57:55,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 08:57:55,895 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 08:57:55,896 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 08:57:55,901 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 08:57:55,902 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 08:57:55,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 08:57:55,916 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 08:57:55,916 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 08:57:55,930 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 08:57:55,931 - sqlalchemy.engine.Engine - INFO - [cached since 0.01516s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 08:57:55,933 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 08:57:55,934 - sqlalchemy.engine.Engine - INFO - [cached since 0.01787s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 08:57:55,936 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 08:57:55,939 - app.main - INFO - Database tables created successfully
2025-04-02 08:57:55,939 - app.main - INFO - Database tables created successfully
2025-04-02 08:57:55,973 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:00:23,497 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:00:23,629 - app.main - INFO - Shutting down application
2025-04-02 09:00:23,629 - app.main - INFO - Shutting down application
2025-04-02 09:00:23,665 - app.main - INFO - Database connections closed successfully
2025-04-02 09:00:23,665 - app.main - INFO - Database connections closed successfully
2025-04-02 09:00:24,079 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:00:24,458 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:00:27,741 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:00:28,096 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:00:28,448 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:00:32,112 - app.main - INFO - Starting up application
2025-04-02 09:00:32,112 - app.main - INFO - Starting up application
2025-04-02 09:00:32,218 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:00:32,219 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:00:32,227 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:00:32,228 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:00:32,233 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:00:32,234 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:00:32,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:00:32,256 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:00:32,257 - sqlalchemy.engine.Engine - INFO - [generated in 0.00149s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:00:32,261 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:00:32,273 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:00:32,274 - sqlalchemy.engine.Engine - INFO - [cached since 0.01855s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:00:32,277 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:00:32,278 - sqlalchemy.engine.Engine - INFO - [cached since 0.02274s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:00:32,281 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:00:32,283 - app.main - INFO - Database tables created successfully
2025-04-02 09:00:32,283 - app.main - INFO - Database tables created successfully
2025-04-02 09:04:42,187 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:04:42,384 - app.main - INFO - Shutting down application
2025-04-02 09:04:42,384 - app.main - INFO - Shutting down application
2025-04-02 09:04:42,509 - app.main - INFO - Database connections closed successfully
2025-04-02 09:04:42,509 - app.main - INFO - Database connections closed successfully
2025-04-02 09:04:43,011 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:04:43,391 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:04:45,813 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:04:46,165 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:04:46,521 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:04:49,518 - app.main - INFO - Starting up application
2025-04-02 09:04:49,518 - app.main - INFO - Starting up application
2025-04-02 09:04:49,663 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:04:49,664 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:04:49,670 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:04:49,671 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:04:49,677 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:04:49,677 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:04:49,682 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:04:49,693 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:04:49,693 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:04:49,701 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:04:49,702 - sqlalchemy.engine.Engine - INFO - [cached since 0.009172s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:04:49,704 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:04:49,705 - sqlalchemy.engine.Engine - INFO - [cached since 0.01234s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:04:49,708 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:04:49,710 - app.main - INFO - Database tables created successfully
2025-04-02 09:04:49,710 - app.main - INFO - Database tables created successfully
2025-04-02 09:04:49,734 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:06:08,965 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:06:08,995 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 09:06:08,997 - sqlalchemy.engine.Engine - INFO - [generated in 0.00174s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 09:06:09,027 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 09:06:09,027 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 09:06:09,045 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 09:06:09,050 - sqlalchemy.engine.Engine - INFO - [generated in 0.00522s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 09:06:09,067 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 09:06:09,067 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 09:06:09,078 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Prof Sunday Ita is in which department
2025-04-02 09:06:09,078 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Prof Sunday Ita is in which department
2025-04-02 09:06:09,079 - app - ERROR -  Vector store not initialized
2025-04-02 09:06:09,079 - app - ERROR -  Vector store not initialized
2025-04-02 09:06:09,079 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 09:06:09,079 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 09:06:09,097 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 09:06:09,101 - app.main - ERROR - Unhandled exception during request processing: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}

2025-04-02 09:06:09,101 - app.main - ERROR - Unhandled exception during request processing: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}

2025-04-02 09:06:09,208 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:06:09,559 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:27,226 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:27,421 - app.main - INFO - Shutting down application
2025-04-02 09:08:27,421 - app.main - INFO - Shutting down application
2025-04-02 09:08:27,430 - app.main - INFO - Database connections closed successfully
2025-04-02 09:08:27,430 - app.main - INFO - Database connections closed successfully
2025-04-02 09:08:27,828 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:28,746 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:29,112 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:29,464 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:31,479 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:08:31,831 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:34,904 - app.main - INFO - Starting up application
2025-04-02 09:08:34,904 - app.main - INFO - Starting up application
2025-04-02 09:08:35,008 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:08:35,008 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:08:35,013 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:08:35,014 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:08:35,018 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:08:35,018 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:08:35,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:08:35,030 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:08:35,030 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:08:35,037 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:08:35,038 - sqlalchemy.engine.Engine - INFO - [cached since 0.007946s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:08:35,040 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:08:35,040 - sqlalchemy.engine.Engine - INFO - [cached since 0.01081s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:08:35,043 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:08:35,045 - app.main - INFO - Database tables created successfully
2025-04-02 09:08:35,045 - app.main - INFO - Database tables created successfully
2025-04-02 09:08:35,094 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:08:35,446 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:09:18,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:09:18,187 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 09:09:18,189 - sqlalchemy.engine.Engine - INFO - [generated in 0.00189s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 09:09:18,208 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 09:09:18,209 - sqlalchemy.engine.Engine - INFO - [generated in 0.00173s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 09:09:18,232 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 09:09:18,233 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 09:09:18,246 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 09:09:18,247 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 09:09:18,254 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Prof Sunday Ita is in which department
2025-04-02 09:09:18,254 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Prof Sunday Ita is in which department
2025-04-02 09:09:18,256 - app - ERROR -  Vector store not initialized
2025-04-02 09:09:18,256 - app - ERROR -  Vector store not initialized
2025-04-02 09:09:18,259 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 09:09:18,259 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 09:09:18,266 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 09:09:18,269 - app.main - ERROR - Unhandled exception during request processing: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}

2025-04-02 09:09:18,269 - app.main - ERROR - Unhandled exception during request processing: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 2 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': None}
  {'type': 'datetime_type', 'loc': ('response', 'timestamp'), 'msg': 'Input should be a valid datetime', 'input': None}

2025-04-02 09:09:18,493 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:32,128 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:32,249 - app.main - INFO - Shutting down application
2025-04-02 09:13:32,249 - app.main - INFO - Shutting down application
2025-04-02 09:13:32,276 - app.main - INFO - Database connections closed successfully
2025-04-02 09:13:32,276 - app.main - INFO - Database connections closed successfully
2025-04-02 09:13:32,696 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:33,928 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:34,310 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:34,661 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:36,318 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:13:36,670 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:41,070 - app.main - INFO - Starting up application
2025-04-02 09:13:41,070 - app.main - INFO - Starting up application
2025-04-02 09:13:41,150 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:13:41,241 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:13:41,245 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:13:41,259 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:13:41,262 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:13:41,270 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:13:41,273 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:13:41,279 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:13:41,292 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:13:41,295 - sqlalchemy.engine.Engine - INFO - [generated in 0.00379s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:13:41,322 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:13:41,324 - sqlalchemy.engine.Engine - INFO - [cached since 0.03222s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:13:41,329 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:13:41,334 - sqlalchemy.engine.Engine - INFO - [cached since 0.0426s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:13:41,338 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:13:41,347 - app.main - INFO - Database tables created successfully
2025-04-02 09:13:41,347 - app.main - INFO - Database tables created successfully
2025-04-02 09:23:22,961 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:23,159 - app.main - INFO - Shutting down application
2025-04-02 09:23:23,159 - app.main - INFO - Shutting down application
2025-04-02 09:23:23,205 - app.main - INFO - Database connections closed successfully
2025-04-02 09:23:23,205 - app.main - INFO - Database connections closed successfully
2025-04-02 09:23:23,619 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:25,402 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:23:25,770 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:30,558 - app.main - INFO - Starting up application
2025-04-02 09:23:30,558 - app.main - INFO - Starting up application
2025-04-02 09:23:30,786 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:23:30,787 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:23:30,794 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:23:30,795 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:23:30,805 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:23:30,806 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:23:30,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:23:30,826 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:23:30,826 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:23:30,835 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:23:30,836 - sqlalchemy.engine.Engine - INFO - [cached since 0.01051s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:23:30,839 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:23:30,841 - sqlalchemy.engine.Engine - INFO - [cached since 0.0153s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:23:30,844 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:23:30,845 - app.main - INFO - Database tables created successfully
2025-04-02 09:23:30,845 - app.main - INFO - Database tables created successfully
2025-04-02 09:23:30,901 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:44,771 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:44,905 - app.main - INFO - Shutting down application
2025-04-02 09:23:44,905 - app.main - INFO - Shutting down application
2025-04-02 09:23:44,918 - app.main - INFO - Database connections closed successfully
2025-04-02 09:23:44,918 - app.main - INFO - Database connections closed successfully
2025-04-02 09:23:45,318 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:45,669 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:46,573 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:23:46,929 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:23:50,332 - app.main - INFO - Starting up application
2025-04-02 09:23:50,332 - app.main - INFO - Starting up application
2025-04-02 09:23:50,420 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:23:50,421 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:23:50,426 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:23:50,427 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:23:50,430 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:23:50,430 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:23:50,434 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:23:50,441 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:23:50,441 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:23:50,447 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:23:50,447 - sqlalchemy.engine.Engine - INFO - [cached since 0.006671s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:23:50,449 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:23:50,450 - sqlalchemy.engine.Engine - INFO - [cached since 0.00914s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:23:50,453 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:23:50,454 - app.main - INFO - Database tables created successfully
2025-04-02 09:23:50,454 - app.main - INFO - Database tables created successfully
2025-04-02 09:23:50,492 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:02,589 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:02,755 - app.main - INFO - Shutting down application
2025-04-02 09:25:02,755 - app.main - INFO - Shutting down application
2025-04-02 09:25:02,763 - app.main - INFO - Database connections closed successfully
2025-04-02 09:25:02,763 - app.main - INFO - Database connections closed successfully
2025-04-02 09:25:03,182 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:03,534 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:04,143 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:25:04,505 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:25:14,073 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:14,428 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:19,502 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:19,858 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:21,640 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:25:21,992 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:25,823 - app.main - INFO - Starting up application
2025-04-02 09:25:25,823 - app.main - INFO - Starting up application
2025-04-02 09:25:25,922 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:25:25,923 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:25:25,929 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:25:25,929 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:25:25,934 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:25:25,935 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:25:25,939 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:25:25,948 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:25:25,949 - sqlalchemy.engine.Engine - INFO - [generated in 0.00129s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:25:25,956 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:25:25,957 - sqlalchemy.engine.Engine - INFO - [cached since 0.008882s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:25:25,959 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:25:25,960 - sqlalchemy.engine.Engine - INFO - [cached since 0.01214s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:25:25,963 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:25:25,966 - app.main - INFO - Database tables created successfully
2025-04-02 09:25:25,966 - app.main - INFO - Database tables created successfully
2025-04-02 09:25:26,173 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:25:26,524 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:26:27,716 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:26:27,862 - app.main - INFO - Shutting down application
2025-04-02 09:26:27,862 - app.main - INFO - Shutting down application
2025-04-02 09:26:27,880 - app.main - INFO - Database connections closed successfully
2025-04-02 09:26:27,880 - app.main - INFO - Database connections closed successfully
2025-04-02 09:26:28,356 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:26:28,707 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:26:30,151 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:26:30,503 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:26:32,298 - watchfiles.main - INFO - 2 changes detected
2025-04-02 09:26:32,649 - watchfiles.main - INFO - 1 change detected
2025-04-02 09:26:36,543 - app.main - INFO - Starting up application
2025-04-02 09:26:36,543 - app.main - INFO - Starting up application
2025-04-02 09:26:36,646 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 09:26:36,646 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:26:36,652 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 09:26:36,652 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:26:36,656 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 09:26:36,657 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 09:26:36,661 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 09:26:36,681 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:26:36,682 - sqlalchemy.engine.Engine - INFO - [generated in 0.00119s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:26:36,699 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:26:36,700 - sqlalchemy.engine.Engine - INFO - [cached since 0.01896s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:26:36,703 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 09:26:36,703 - sqlalchemy.engine.Engine - INFO - [cached since 0.02262s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 09:26:36,706 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 09:26:36,708 - app.main - INFO - Database tables created successfully
2025-04-02 09:26:36,708 - app.main - INFO - Database tables created successfully
2025-04-02 09:26:36,823 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:49:53,398 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:49:53,763 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:50:08,154 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:50:08,506 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:53:38,713 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:53:38,749 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 19:53:38,749 - sqlalchemy.engine.Engine - INFO - [generated in 0.00112s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 19:53:38,801 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:38,801 - sqlalchemy.engine.Engine - INFO - [generated in 0.00133s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:38,819 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 19:53:38,822 - sqlalchemy.engine.Engine - INFO - [generated in 0.00398s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:38,833 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:38,835 - sqlalchemy.engine.Engine - INFO - [generated in 0.00182s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:38,842 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-02 19:53:38,930 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:53:39,175 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:53:39,400 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:53:39,403 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 19:53:39,403 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 19:53:39,422 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:39,423 - sqlalchemy.engine.Engine - INFO - [cached since 0.6225s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:39,436 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 19:53:39,437 - sqlalchemy.engine.Engine - INFO - [cached since 0.6188s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:39,444 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:39,444 - sqlalchemy.engine.Engine - INFO - [cached since 0.6112s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:39,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 19:53:39,466 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 19:53:39,466 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 19:53:39,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:53:39,524 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 19:53:39,524 - sqlalchemy.engine.Engine - INFO - [cached since 0.1217s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 19:53:39,528 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:39,534 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:53:39,531 - sqlalchemy.engine.Engine - INFO - [cached since 0.7305s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:39,546 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 19:53:39,547 - sqlalchemy.engine.Engine - INFO - [cached since 0.7285s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:39,555 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:39,556 - sqlalchemy.engine.Engine - INFO - [cached since 0.7224s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:39,566 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 19:53:39,568 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 19:53:39,568 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 19:53:51,259 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:53:51,259 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 19:53:51,260 - sqlalchemy.engine.Engine - INFO - [cached since 11.86s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 19:53:51,262 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:51,263 - sqlalchemy.engine.Engine - INFO - [cached since 12.47s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:51,265 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 19:53:51,266 - sqlalchemy.engine.Engine - INFO - [cached since 12.45s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:51,269 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:53:51,269 - sqlalchemy.engine.Engine - INFO - [cached since 12.44s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:53:51,327 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 19:53:51,327 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] (UUID('84777c66-5706-48ac-92d0-9e731e15ca19'), datetime.datetime(2025, 4, 2, 19, 53, 51, 327377, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\nMs Thelma Ononokpono\t \t\t\t\t\t\tMarch 26, 2025\nDeans Office\nFaculty of Arts\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Ms Ono ... (1501 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Thelma Ononokpono-Committe-letter.docx')
2025-04-02 19:53:51,337 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:53:51,343 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:53:51,348 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 19:53:51,349 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] (UUID('84777c66-5706-48ac-92d0-9e731e15ca19'),)
2025-04-02 19:53:51,353 - app.services.rag_service - INFO - Processing note 84777c66-5706-48ac-92d0-9e731e15ca19 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 19:53:51,353 - app.services.rag_service - INFO - Processing note 84777c66-5706-48ac-92d0-9e731e15ca19 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 19:53:51,363 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 19:53:51,363 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 19:53:51,364 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 19:53:51,364 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 19:53:51,364 - app.services.document_processing - INFO - Chunk 1: Ms Thelma Ononokpono	 						March 26, 2025
Deans Office
Faculty of Arts
University of Uyo
Uyo
Akwa ...
2025-04-02 19:53:51,364 - app.services.document_processing - INFO - Chunk 1: Ms Thelma Ononokpono	 						March 26, 2025
Deans Office
Faculty of Arts
University of Uyo
Uyo
Akwa ...
2025-04-02 19:53:51,365 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 19:53:51,365 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 19:53:51,366 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 19:53:51,366 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 19:53:51,367 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 19:53:51,367 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 19:53:51,368 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 19:53:51,368 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 19:53:51,567 - watchfiles.main - INFO - 3 changes detected
2025-04-02 19:53:59,443 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-02 19:53:59,444 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 19:53:59,691 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:54:03,803 - app - INFO - Removing existing vector store at /backend/chroma_db
2025-04-02 19:54:03,803 - app - INFO - Removing existing vector store at /backend/chroma_db
2025-04-02 19:54:03,804 - app - ERROR -  Vector store initialization failed: [Errno 16] Device or resource busy: '/backend/chroma_db'
Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 35, in initialize
    shutil.rmtree(self.persist_directory)
  File "/opt/conda/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/opt/conda/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
OSError: [Errno 16] Device or resource busy: '/backend/chroma_db'
2025-04-02 19:54:03,804 - app - ERROR -  Vector store initialization failed: [Errno 16] Device or resource busy: '/backend/chroma_db'
Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 35, in initialize
    shutil.rmtree(self.persist_directory)
  File "/opt/conda/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/opt/conda/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
OSError: [Errno 16] Device or resource busy: '/backend/chroma_db'
2025-04-02 19:54:03,810 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:54:03,904 - watchfiles.main - INFO - 3 changes detected
2025-04-02 19:54:13,616 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:54:13,618 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 19:54:13,619 - sqlalchemy.engine.Engine - INFO - [cached since 34.22s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 19:54:13,623 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:54:13,624 - sqlalchemy.engine.Engine - INFO - [cached since 34.83s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:54:13,626 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 19:54:13,627 - sqlalchemy.engine.Engine - INFO - [cached since 34.81s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:54:13,629 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:54:13,630 - sqlalchemy.engine.Engine - INFO - [cached since 34.8s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:54:13,634 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Who is Thelma
2025-04-02 19:54:13,634 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Who is Thelma
2025-04-02 19:54:13,635 - app - ERROR -  Vector store not initialized
2025-04-02 19:54:13,635 - app - ERROR -  Vector store not initialized
2025-04-02 19:54:13,637 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 19:54:13,637 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 19:54:13,640 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 19:54:13,640 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (UUID('b4af308d-1e4a-48d8-bb7e-ff0f6ddc251d'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'Who is Thelma', 'Sorry, there was an error processing your query.', datetime.datetime(2025, 4, 2, 19, 54, 13, 640219, tzinfo=datetime.timezone.utc))
2025-04-02 19:54:13,644 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:54:13,647 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:54:13,650 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 19:54:13,651 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (UUID('b4af308d-1e4a-48d8-bb7e-ff0f6ddc251d'),)
2025-04-02 19:54:13,655 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 19:54:13,657 - app.main - ERROR - Unhandled exception during request processing: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('b4af308d-1e4a-48d8-bb7e-ff0f6ddc251d')}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('b4af308d-1e4a-48d8-bb7e-ff0f6ddc251d')}

2025-04-02 19:54:13,657 - app.main - ERROR - Unhandled exception during request processing: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('b4af308d-1e4a-48d8-bb7e-ff0f6ddc251d')}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'int_type', 'loc': ('response', 'id'), 'msg': 'Input should be a valid integer', 'input': UUID('b4af308d-1e4a-48d8-bb7e-ff0f6ddc251d')}

2025-04-02 19:54:13,831 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:55:48,262 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:55:48,405 - app.main - INFO - Shutting down application
2025-04-02 19:55:48,405 - app.main - INFO - Shutting down application
2025-04-02 19:55:48,422 - app.main - INFO - Database connections closed successfully
2025-04-02 19:55:48,422 - app.main - INFO - Database connections closed successfully
2025-04-02 19:55:48,862 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:55:52,477 - watchfiles.main - INFO - 2 changes detected
2025-04-02 19:55:52,787 - app.main - INFO - Starting up application
2025-04-02 19:55:52,787 - app.main - INFO - Starting up application
2025-04-02 19:55:52,829 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:55:52,893 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 19:55:52,893 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 19:55:52,899 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 19:55:52,899 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 19:55:52,903 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 19:55:52,903 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 19:55:52,906 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:55:52,914 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 19:55:52,914 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 19:55:52,923 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 19:55:52,923 - sqlalchemy.engine.Engine - INFO - [cached since 0.009323s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 19:55:52,925 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 19:55:52,925 - sqlalchemy.engine.Engine - INFO - [cached since 0.01153s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 19:55:52,927 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:55:52,929 - app.main - INFO - Database tables created successfully
2025-04-02 19:55:52,929 - app.main - INFO - Database tables created successfully
2025-04-02 19:56:21,658 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:56:21,807 - app.main - INFO - Shutting down application
2025-04-02 19:56:21,807 - app.main - INFO - Shutting down application
2025-04-02 19:56:21,811 - app.main - INFO - Database connections closed successfully
2025-04-02 19:56:21,811 - app.main - INFO - Database connections closed successfully
2025-04-02 19:56:22,187 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:56:22,538 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:56:24,643 - watchfiles.main - INFO - 2 changes detected
2025-04-02 19:56:24,878 - app.main - INFO - Starting up application
2025-04-02 19:56:24,878 - app.main - INFO - Starting up application
2025-04-02 19:56:24,985 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 19:56:24,985 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 19:56:24,991 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 19:56:24,993 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 19:56:24,994 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:56:24,998 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 19:56:24,998 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 19:56:25,002 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:56:25,011 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 19:56:25,012 - sqlalchemy.engine.Engine - INFO - [generated in 0.00122s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 19:56:25,023 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 19:56:25,023 - sqlalchemy.engine.Engine - INFO - [cached since 0.0124s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 19:56:25,026 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 19:56:25,026 - sqlalchemy.engine.Engine - INFO - [cached since 0.01566s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 19:56:25,029 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:56:25,030 - app.main - INFO - Database tables created successfully
2025-04-02 19:56:25,030 - app.main - INFO - Database tables created successfully
2025-04-02 19:56:25,346 - watchfiles.main - INFO - 1 change detected
2025-04-02 19:57:18,148 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:57:18,170 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 19:57:18,170 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 19:57:18,181 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:57:18,181 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:57:18,192 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 19:57:18,192 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:57:18,200 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 19:57:18,200 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:57:18,207 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 19:57:18,208 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 19:57:18,214 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Who is Thelma
2025-04-02 19:57:18,214 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Who is Thelma
2025-04-02 19:57:18,214 - app - ERROR -  Vector store not initialized
2025-04-02 19:57:18,214 - app - ERROR -  Vector store not initialized
2025-04-02 19:57:18,215 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 19:57:18,215 - app.services.rag_service - ERROR - Error in query_for_user: 'VectorStore' object has no attribute 'get_documents_for_context'
Traceback (most recent call last):
  File "/backend/app/services/rag_service.py", line 214, in query_for_user
    source_docs = self.retriever.get_documents_for_context(context)
AttributeError: 'VectorStore' object has no attribute 'get_documents_for_context'
2025-04-02 19:57:18,224 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 19:57:18,225 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] (UUID('45ebc4ac-2fa8-4876-86fc-2daa9883873b'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'Who is Thelma', 'Sorry, there was an error processing your query.', datetime.datetime(2025, 4, 2, 19, 57, 18, 224712, tzinfo=datetime.timezone.utc))
2025-04-02 19:57:18,232 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:57:18,237 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 19:57:18,246 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 19:57:18,247 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] (UUID('45ebc4ac-2fa8-4876-86fc-2daa9883873b'),)
2025-04-02 19:57:18,252 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 19:57:18,444 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:12,578 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:12,772 - app.main - INFO - Shutting down application
2025-04-02 20:02:12,772 - app.main - INFO - Shutting down application
2025-04-02 20:02:12,778 - app.main - INFO - Database connections closed successfully
2025-04-02 20:02:12,778 - app.main - INFO - Database connections closed successfully
2025-04-02 20:02:13,155 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:13,506 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:15,009 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:02:15,361 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:15,712 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:15,906 - app.main - INFO - Starting up application
2025-04-02 20:02:15,906 - app.main - INFO - Starting up application
2025-04-02 20:02:15,972 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:02:15,973 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:15,977 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:02:15,977 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:15,980 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:02:15,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:15,983 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:02:15,989 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:15,989 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:15,997 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:15,998 - sqlalchemy.engine.Engine - INFO - [cached since 0.008842s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:15,999 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:16,000 - sqlalchemy.engine.Engine - INFO - [cached since 0.01098s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:16,002 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:02:16,003 - app.main - INFO - Database tables created successfully
2025-04-02 20:02:16,003 - app.main - INFO - Database tables created successfully
2025-04-02 20:02:26,745 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:26,937 - app.main - INFO - Shutting down application
2025-04-02 20:02:26,937 - app.main - INFO - Shutting down application
2025-04-02 20:02:26,942 - app.main - INFO - Database connections closed successfully
2025-04-02 20:02:26,942 - app.main - INFO - Database connections closed successfully
2025-04-02 20:02:27,311 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:27,662 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:29,116 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:02:29,467 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:30,140 - app.main - INFO - Starting up application
2025-04-02 20:02:30,140 - app.main - INFO - Starting up application
2025-04-02 20:02:30,216 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:02:30,217 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:30,221 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:02:30,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:30,225 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:02:30,225 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:30,227 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:02:30,232 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:30,232 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:30,237 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:30,237 - sqlalchemy.engine.Engine - INFO - [cached since 0.005479s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:30,239 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:30,239 - sqlalchemy.engine.Engine - INFO - [cached since 0.007611s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:30,241 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:02:30,242 - app.main - INFO - Database tables created successfully
2025-04-02 20:02:30,242 - app.main - INFO - Database tables created successfully
2025-04-02 20:02:30,320 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:38,442 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:38,567 - app.main - INFO - Shutting down application
2025-04-02 20:02:38,567 - app.main - INFO - Shutting down application
2025-04-02 20:02:38,572 - app.main - INFO - Database connections closed successfully
2025-04-02 20:02:38,572 - app.main - INFO - Database connections closed successfully
2025-04-02 20:02:38,974 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:39,683 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:40,055 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:40,413 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:40,765 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:44,815 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:02:45,166 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:45,518 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:02:45,959 - app.main - INFO - Starting up application
2025-04-02 20:02:45,959 - app.main - INFO - Starting up application
2025-04-02 20:02:46,026 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:02:46,026 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:46,029 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:02:46,030 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:46,032 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:02:46,032 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:02:46,035 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:02:46,043 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:46,044 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:46,050 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:46,050 - sqlalchemy.engine.Engine - INFO - [cached since 0.007297s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:46,052 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:02:46,053 - sqlalchemy.engine.Engine - INFO - [cached since 0.009835s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:02:46,055 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:02:46,057 - app.main - INFO - Database tables created successfully
2025-04-02 20:02:46,057 - app.main - INFO - Database tables created successfully
2025-04-02 20:02:46,321 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:05:11,779 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:05:11,819 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:05:11,819 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:05:11,847 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:05:11,847 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:11,864 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:05:11,865 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:11,875 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:05:11,877 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:05:11,880 - sqlalchemy.engine.Engine - INFO - [generated in 0.00498s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:11,894 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:05:11,894 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:11,898 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 20:05:11,900 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:05:11,900 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 119, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:05:24,246 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:05:24,247 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:05:24,247 - sqlalchemy.engine.Engine - INFO - [cached since 12.43s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:05:24,252 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:05:24,253 - sqlalchemy.engine.Engine - INFO - [cached since 12.41s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:24,256 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:05:24,256 - sqlalchemy.engine.Engine - INFO - [cached since 12.39s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:24,261 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:05:24,261 - sqlalchemy.engine.Engine - INFO - [cached since 12.39s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:24,264 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:05:24,264 - sqlalchemy.engine.Engine - INFO - [cached since 12.37s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:05:24,301 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 20:05:24,301 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] (UUID('d4ddfe3f-d2a8-4772-b842-30f407c8287d'), datetime.datetime(2025, 4, 2, 20, 5, 24, 301299, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 20:05:24,311 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:05:24,315 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:05:24,320 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 20:05:24,320 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] (UUID('d4ddfe3f-d2a8-4772-b842-30f407c8287d'),)
2025-04-02 20:05:24,326 - app.services.rag_service - INFO - Processing note d4ddfe3f-d2a8-4772-b842-30f407c8287d for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:05:24,326 - app.services.rag_service - INFO - Processing note d4ddfe3f-d2a8-4772-b842-30f407c8287d for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:05:24,334 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:05:24,334 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:05:24,335 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:05:24,335 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:05:24,335 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:05:24,335 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:05:24,336 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:05:24,336 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:05:24,336 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:05:24,336 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:05:24,337 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:05:24,337 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:05:24,337 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:05:24,337 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:05:24,517 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:05:31,437 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-02 20:05:31,437 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:05:31,705 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:05:36,211 - app - INFO - Removing existing vector store at /backend/chroma_db
2025-04-02 20:05:36,211 - app - INFO - Removing existing vector store at /backend/chroma_db
2025-04-02 20:05:36,212 - app - ERROR -  Vector store initialization failed: [Errno 16] Device or resource busy: '/backend/chroma_db'
Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 35, in initialize
    shutil.rmtree(self.persist_directory)
  File "/opt/conda/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/opt/conda/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
OSError: [Errno 16] Device or resource busy: '/backend/chroma_db'
2025-04-02 20:05:36,212 - app - ERROR -  Vector store initialization failed: [Errno 16] Device or resource busy: '/backend/chroma_db'
Traceback (most recent call last):
  File "/backend/app/services/vector_store.py", line 35, in initialize
    shutil.rmtree(self.persist_directory)
  File "/opt/conda/lib/python3.10/shutil.py", line 731, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File "/opt/conda/lib/python3.10/shutil.py", line 729, in rmtree
    os.rmdir(path)
OSError: [Errno 16] Device or resource busy: '/backend/chroma_db'
2025-04-02 20:05:36,215 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:05:36,519 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:06:32,483 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:32,669 - app.main - INFO - Shutting down application
2025-04-02 20:06:32,669 - app.main - INFO - Shutting down application
2025-04-02 20:06:32,676 - app.main - INFO - Database connections closed successfully
2025-04-02 20:06:32,676 - app.main - INFO - Database connections closed successfully
2025-04-02 20:06:33,128 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:33,479 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:35,773 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:06:36,129 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:36,480 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:37,112 - app.main - INFO - Starting up application
2025-04-02 20:06:37,112 - app.main - INFO - Starting up application
2025-04-02 20:06:37,190 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:06:37,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:06:37,195 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:06:37,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:06:37,197 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:06:37,198 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:06:37,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:06:37,208 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:06:37,208 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:06:37,212 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:06:37,213 - sqlalchemy.engine.Engine - INFO - [cached since 0.005245s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:06:37,215 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:06:37,216 - sqlalchemy.engine.Engine - INFO - [cached since 0.007967s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:06:37,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:06:37,219 - app.main - INFO - Database tables created successfully
2025-04-02 20:06:37,219 - app.main - INFO - Database tables created successfully
2025-04-02 20:06:37,283 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:40,594 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:40,732 - app.main - INFO - Shutting down application
2025-04-02 20:06:40,732 - app.main - INFO - Shutting down application
2025-04-02 20:06:40,739 - app.main - INFO - Database connections closed successfully
2025-04-02 20:06:40,739 - app.main - INFO - Database connections closed successfully
2025-04-02 20:06:41,122 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:41,523 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:06:44,522 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:06:44,873 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:45,795 - app.main - INFO - Starting up application
2025-04-02 20:06:45,795 - app.main - INFO - Starting up application
2025-04-02 20:06:45,871 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:06:45,871 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:06:45,876 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:06:45,877 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:06:45,881 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:06:45,881 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:06:45,884 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:06:45,892 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:06:45,892 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:06:45,896 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:06:45,896 - sqlalchemy.engine.Engine - INFO - [cached since 0.004346s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:06:45,897 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:06:45,898 - sqlalchemy.engine.Engine - INFO - [cached since 0.006141s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:06:45,900 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:06:45,902 - app.main - INFO - Database tables created successfully
2025-04-02 20:06:45,902 - app.main - INFO - Database tables created successfully
2025-04-02 20:06:46,034 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:46,385 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:58,667 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:58,835 - app.main - INFO - Shutting down application
2025-04-02 20:06:58,835 - app.main - INFO - Shutting down application
2025-04-02 20:06:58,841 - app.main - INFO - Database connections closed successfully
2025-04-02 20:06:58,841 - app.main - INFO - Database connections closed successfully
2025-04-02 20:06:59,210 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:59,562 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:06:59,913 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:07:03,205 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:07:03,556 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:07:04,452 - app.main - INFO - Starting up application
2025-04-02 20:07:04,452 - app.main - INFO - Starting up application
2025-04-02 20:07:04,564 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:07:04,564 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:04,570 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:07:04,572 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:04,578 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:07:04,578 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:04,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:07:04,588 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:04,589 - sqlalchemy.engine.Engine - INFO - [generated in 0.00117s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:04,594 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:04,595 - sqlalchemy.engine.Engine - INFO - [cached since 0.006811s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:04,597 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:04,597 - sqlalchemy.engine.Engine - INFO - [cached since 0.009448s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:04,600 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:07:04,601 - app.main - INFO - Database tables created successfully
2025-04-02 20:07:04,601 - app.main - INFO - Database tables created successfully
2025-04-02 20:07:04,710 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:07:08,623 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:07:08,815 - app.main - INFO - Shutting down application
2025-04-02 20:07:08,815 - app.main - INFO - Shutting down application
2025-04-02 20:07:08,830 - app.main - INFO - Database connections closed successfully
2025-04-02 20:07:08,830 - app.main - INFO - Database connections closed successfully
2025-04-02 20:07:09,247 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:07:09,599 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:07:12,477 - app.main - INFO - Starting up application
2025-04-02 20:07:12,477 - app.main - INFO - Starting up application
2025-04-02 20:07:12,558 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:07:12,559 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:12,562 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:07:12,563 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:12,566 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:07:12,567 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:12,572 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:07:12,580 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:12,580 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:12,586 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:12,586 - sqlalchemy.engine.Engine - INFO - [cached since 0.006847s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:12,589 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:12,590 - sqlalchemy.engine.Engine - INFO - [cached since 0.0106s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:12,593 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:07:12,595 - app.main - INFO - Database tables created successfully
2025-04-02 20:07:12,595 - app.main - INFO - Database tables created successfully
2025-04-02 20:07:12,809 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:07:12,997 - app.main - INFO - Shutting down application
2025-04-02 20:07:12,997 - app.main - INFO - Shutting down application
2025-04-02 20:07:13,002 - app.main - INFO - Database connections closed successfully
2025-04-02 20:07:13,002 - app.main - INFO - Database connections closed successfully
2025-04-02 20:07:13,002 - app.main - INFO - Vector store closed successfully
2025-04-02 20:07:13,002 - app.main - INFO - Vector store closed successfully
2025-04-02 20:07:14,922 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:07:15,273 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:07:15,624 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:07:15,883 - app.main - INFO - Starting up application
2025-04-02 20:07:15,883 - app.main - INFO - Starting up application
2025-04-02 20:07:15,939 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:07:15,939 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:15,942 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:07:15,942 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:15,944 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:07:15,945 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:07:15,947 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:07:15,951 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:15,952 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:15,955 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:15,955 - sqlalchemy.engine.Engine - INFO - [cached since 0.004004s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:15,957 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:07:15,957 - sqlalchemy.engine.Engine - INFO - [cached since 0.005744s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:07:15,959 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:07:15,959 - app.main - INFO - Database tables created successfully
2025-04-02 20:07:15,959 - app.main - INFO - Database tables created successfully
2025-04-02 20:09:42,241 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:09:42,361 - app.main - INFO - Shutting down application
2025-04-02 20:09:42,361 - app.main - INFO - Shutting down application
2025-04-02 20:09:42,365 - app.main - INFO - Database connections closed successfully
2025-04-02 20:09:42,365 - app.main - INFO - Database connections closed successfully
2025-04-02 20:09:42,366 - app.main - INFO - Vector store closed successfully
2025-04-02 20:09:42,366 - app.main - INFO - Vector store closed successfully
2025-04-02 20:09:42,736 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:09:45,483 - app.main - INFO - Starting up application
2025-04-02 20:09:45,483 - app.main - INFO - Starting up application
2025-04-02 20:09:45,539 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:09:45,539 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:09:45,542 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:09:45,542 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:09:45,544 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:09:45,545 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:09:45,547 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:09:45,551 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:09:45,551 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:09:45,555 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:09:45,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.003936s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:09:45,556 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:09:45,556 - sqlalchemy.engine.Engine - INFO - [cached since 0.005348s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:09:45,558 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:09:45,559 - app.main - INFO - Database tables created successfully
2025-04-02 20:09:45,559 - app.main - INFO - Database tables created successfully
2025-04-02 20:09:45,592 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:11:54,055 - __main__ - INFO - Starting development server
2025-04-02 20:11:58,502 - app.main - INFO - Starting up application
2025-04-02 20:11:58,502 - app.main - INFO - Starting up application
2025-04-02 20:11:58,641 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:11:58,812 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:11:58,813 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:11:58,821 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:11:58,822 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:11:58,828 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:11:58,829 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:11:58,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:11:58,839 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:11:58,839 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:11:58,858 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:11:58,859 - sqlalchemy.engine.Engine - INFO - [cached since 0.02008s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:11:58,860 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:11:58,860 - sqlalchemy.engine.Engine - INFO - [cached since 0.02123s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:11:58,861 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:11:58,862 - app.main - INFO - Database tables created successfully
2025-04-02 20:11:58,862 - app.main - INFO - Database tables created successfully
2025-04-02 20:12:11,750 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:12:11,808 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:12:11,808 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:12:11,851 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:12:11,852 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:11,868 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:12:11,870 - sqlalchemy.engine.Engine - INFO - [generated in 0.00186s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:11,900 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:12:11,903 - sqlalchemy.engine.Engine - INFO - [generated in 0.00306s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:11,911 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:12:11,911 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:11,915 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 20:12:11,918 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 125, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:12:11,918 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 125, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:12:12,026 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:12:12,377 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:12:52,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:12:52,702 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:12:52,702 - sqlalchemy.engine.Engine - INFO - [cached since 40.9s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:12:52,708 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:12:52,709 - sqlalchemy.engine.Engine - INFO - [cached since 40.86s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:52,712 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:12:52,713 - sqlalchemy.engine.Engine - INFO - [cached since 40.85s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:52,716 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:12:52,716 - sqlalchemy.engine.Engine - INFO - [cached since 40.82s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:52,718 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:12:52,719 - sqlalchemy.engine.Engine - INFO - [cached since 40.81s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:12:52,743 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 20:12:52,744 - sqlalchemy.engine.Engine - INFO - [generated in 0.00137s] (UUID('bceaea10-27da-468e-aeab-e5fab34023e4'), datetime.datetime(2025, 4, 2, 20, 12, 52, 743322, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 20:12:52,781 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:12:52,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:12:52,792 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 20:12:52,792 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (UUID('bceaea10-27da-468e-aeab-e5fab34023e4'),)
2025-04-02 20:12:52,795 - app.services.rag_service - INFO - Processing note bceaea10-27da-468e-aeab-e5fab34023e4 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:12:52,795 - app.services.rag_service - INFO - Processing note bceaea10-27da-468e-aeab-e5fab34023e4 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:12:52,799 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:12:52,799 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:12:52,800 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:12:52,800 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:12:52,800 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:12:52,800 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:12:52,800 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:12:52,800 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:12:52,801 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:12:52,801 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:12:52,802 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:12:52,802 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:12:52,802 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:12:52,802 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:12:52,943 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:12:59,038 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-02 20:12:59,038 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:12:59,262 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:14:32,364 - app - INFO - Loading existing vector store from /backend/chroma_db
2025-04-02 20:14:32,364 - app - INFO - Loading existing vector store from /backend/chroma_db
2025-04-02 20:14:32,509 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:14:33,116 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-02 20:14:33,412 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:14:33,763 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:14:33,841 - app - INFO -  Vector store initialized successfully
2025-04-02 20:14:33,841 - app - INFO -  Vector store initialized successfully
2025-04-02 20:14:33,843 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:14:34,114 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:14:34,465 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:15:09,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:15:09,315 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:15:09,316 - sqlalchemy.engine.Engine - INFO - [cached since 177.5s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:15:09,321 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:15:09,321 - sqlalchemy.engine.Engine - INFO - [cached since 177.5s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:09,324 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:15:09,325 - sqlalchemy.engine.Engine - INFO - [cached since 177.5s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:09,329 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:15:09,329 - sqlalchemy.engine.Engine - INFO - [cached since 177.4s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:09,332 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:15:09,333 - sqlalchemy.engine.Engine - INFO - [cached since 177.4s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:09,335 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Who is Professor Ita
2025-04-02 20:15:09,335 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: Who is Professor Ita
2025-04-02 20:15:09,342 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:09,342 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:09,346 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:09,346 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:09,347 - app.services.rag_service - ERROR - Retrieval failed. No context was returned.
2025-04-02 20:15:09,347 - app.services.rag_service - ERROR - Retrieval failed. No context was returned.
2025-04-02 20:15:09,350 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 20:15:09,350 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] (UUID('3a05cdd0-c064-4e5a-ad3a-1f891700569c'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'Who is Professor Ita', "I couldn't find any relevant information in your notes.", datetime.datetime(2025, 4, 2, 20, 15, 9, 350516, tzinfo=datetime.timezone.utc))
2025-04-02 20:15:09,353 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:15:09,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:15:09,361 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 20:15:09,362 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] (UUID('3a05cdd0-c064-4e5a-ad3a-1f891700569c'),)
2025-04-02 20:15:09,365 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:15:09,514 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:15:41,544 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:15:41,545 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:15:41,546 - sqlalchemy.engine.Engine - INFO - [cached since 209.8s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:15:41,550 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:15:41,551 - sqlalchemy.engine.Engine - INFO - [cached since 209.7s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:41,554 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:15:41,555 - sqlalchemy.engine.Engine - INFO - [cached since 209.7s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:41,559 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:15:41,560 - sqlalchemy.engine.Engine - INFO - [cached since 209.7s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:41,564 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:15:41,564 - sqlalchemy.engine.Engine - INFO - [cached since 209.7s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:15:41,566 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: What department is Professor Ita
2025-04-02 20:15:41,566 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: What department is Professor Ita
2025-04-02 20:15:41,570 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:41,570 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:41,574 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:41,574 - app - ERROR -  Vector store not initialized
2025-04-02 20:15:41,574 - app.services.rag_service - ERROR - Retrieval failed. No context was returned.
2025-04-02 20:15:41,574 - app.services.rag_service - ERROR - Retrieval failed. No context was returned.
2025-04-02 20:15:41,576 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 20:15:41,576 - sqlalchemy.engine.Engine - INFO - [cached since 32.23s ago] (UUID('21f70c6e-76a1-4cee-a688-ecca18393e04'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'What department is Professor Ita', "I couldn't find any relevant information in your notes.", datetime.datetime(2025, 4, 2, 20, 15, 41, 576159, tzinfo=datetime.timezone.utc))
2025-04-02 20:15:41,578 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:15:41,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:15:41,582 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 20:15:41,583 - sqlalchemy.engine.Engine - INFO - [cached since 32.22s ago] (UUID('21f70c6e-76a1-4cee-a688-ecca18393e04'),)
2025-04-02 20:15:41,585 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:15:41,654 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:14,740 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:14,922 - app.main - INFO - Shutting down application
2025-04-02 20:18:14,922 - app.main - INFO - Shutting down application
2025-04-02 20:18:14,928 - app.main - INFO - Database connections closed successfully
2025-04-02 20:18:14,928 - app.main - INFO - Database connections closed successfully
2025-04-02 20:18:14,929 - app.main - INFO - Vector store closed successfully
2025-04-02 20:18:14,929 - app.main - INFO - Vector store closed successfully
2025-04-02 20:18:15,382 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:15,734 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:16,545 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:18:16,899 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:19,107 - app.main - INFO - Starting up application
2025-04-02 20:18:19,107 - app.main - INFO - Starting up application
2025-04-02 20:18:19,190 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:18:19,190 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:19,194 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:18:19,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:19,196 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:18:19,197 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:19,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:18:19,206 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:19,206 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:19,211 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:19,211 - sqlalchemy.engine.Engine - INFO - [cached since 0.005171s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:19,212 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:19,213 - sqlalchemy.engine.Engine - INFO - [cached since 0.006978s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:19,215 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:18:19,216 - app.main - INFO - Database tables created successfully
2025-04-02 20:18:19,216 - app.main - INFO - Database tables created successfully
2025-04-02 20:18:19,263 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:23,776 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:23,930 - app.main - INFO - Shutting down application
2025-04-02 20:18:23,930 - app.main - INFO - Shutting down application
2025-04-02 20:18:23,936 - app.main - INFO - Database connections closed successfully
2025-04-02 20:18:23,936 - app.main - INFO - Database connections closed successfully
2025-04-02 20:18:23,938 - app.main - INFO - Vector store closed successfully
2025-04-02 20:18:23,938 - app.main - INFO - Vector store closed successfully
2025-04-02 20:18:24,369 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:18:24,740 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:27,897 - app.main - INFO - Starting up application
2025-04-02 20:18:27,897 - app.main - INFO - Starting up application
2025-04-02 20:18:27,964 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:18:27,964 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:27,969 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:18:27,969 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:27,972 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:18:27,973 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:27,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:18:27,982 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:27,982 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:27,987 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:27,988 - sqlalchemy.engine.Engine - INFO - [cached since 0.006555s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:27,990 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:27,990 - sqlalchemy.engine.Engine - INFO - [cached since 0.00856s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:27,992 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:18:27,993 - app.main - INFO - Database tables created successfully
2025-04-02 20:18:27,993 - app.main - INFO - Database tables created successfully
2025-04-02 20:18:27,998 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:29,803 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:30,001 - app.main - INFO - Shutting down application
2025-04-02 20:18:30,001 - app.main - INFO - Shutting down application
2025-04-02 20:18:30,005 - app.main - INFO - Database connections closed successfully
2025-04-02 20:18:30,005 - app.main - INFO - Database connections closed successfully
2025-04-02 20:18:30,006 - app.main - INFO - Vector store closed successfully
2025-04-02 20:18:30,006 - app.main - INFO - Vector store closed successfully
2025-04-02 20:18:30,376 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:18:30,727 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:18:34,149 - app.main - INFO - Starting up application
2025-04-02 20:18:34,149 - app.main - INFO - Starting up application
2025-04-02 20:18:34,226 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:18:34,226 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:34,230 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:18:34,230 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:34,235 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:18:34,236 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:18:34,241 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:18:34,247 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:34,248 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:34,253 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:34,254 - sqlalchemy.engine.Engine - INFO - [cached since 0.006792s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:34,256 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:18:34,256 - sqlalchemy.engine.Engine - INFO - [cached since 0.009357s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:18:34,259 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:18:34,260 - app.main - INFO - Database tables created successfully
2025-04-02 20:18:34,260 - app.main - INFO - Database tables created successfully
2025-04-02 20:18:34,288 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:20:34,720 - __main__ - INFO - Starting development server
2025-04-02 20:20:38,128 - app.main - INFO - Starting up application
2025-04-02 20:20:38,128 - app.main - INFO - Starting up application
2025-04-02 20:20:38,217 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:20:38,217 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:20:38,221 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:20:38,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:20:38,224 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:20:38,224 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:20:38,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:20:38,232 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:20:38,234 - sqlalchemy.engine.Engine - INFO - [generated in 0.00139s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:20:38,242 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:20:38,242 - sqlalchemy.engine.Engine - INFO - [cached since 0.01019s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:20:38,244 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:20:38,244 - sqlalchemy.engine.Engine - INFO - [cached since 0.01237s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:20:38,246 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:20:38,247 - app.main - INFO - Database tables created successfully
2025-04-02 20:20:38,247 - app.main - INFO - Database tables created successfully
2025-04-02 20:20:38,340 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:20:53,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:20:53,308 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:20:53,317 - sqlalchemy.engine.Engine - INFO - [generated in 0.00992s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:20:53,375 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:20:53,378 - sqlalchemy.engine.Engine - INFO - [generated in 0.00376s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:20:53,416 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:20:53,418 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:20:53,417 - sqlalchemy.engine.Engine - INFO - [generated in 0.00657s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:20:53,447 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:20:53,448 - sqlalchemy.engine.Engine - INFO - [generated in 0.00170s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:20:53,466 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:20:53,467 - sqlalchemy.engine.Engine - INFO - [generated in 0.00160s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:20:53,472 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 20:20:53,475 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 124, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:20:53,475 - app.main - ERROR - Unhandled exception during request processing: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 124, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 83, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:21:00,960 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:21:00,960 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:21:00,961 - sqlalchemy.engine.Engine - INFO - [cached since 7.653s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:21:00,964 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:21:00,964 - sqlalchemy.engine.Engine - INFO - [cached since 7.59s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:21:00,967 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:21:00,967 - sqlalchemy.engine.Engine - INFO - [cached since 7.556s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:21:00,970 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:21:00,971 - sqlalchemy.engine.Engine - INFO - [cached since 7.524s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:21:00,974 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:21:00,975 - sqlalchemy.engine.Engine - INFO - [cached since 7.51s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:21:00,996 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 20:21:00,997 - sqlalchemy.engine.Engine - INFO - [generated in 0.00170s] (UUID('09aa0296-8c08-444a-babb-fa192acb3e4d'), datetime.datetime(2025, 4, 2, 20, 21, 0, 996012, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 20:21:01,003 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:21:01,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:21:01,012 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 20:21:01,012 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (UUID('09aa0296-8c08-444a-babb-fa192acb3e4d'),)
2025-04-02 20:21:01,017 - app.services.rag_service - INFO - Processing note 09aa0296-8c08-444a-babb-fa192acb3e4d for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:21:01,017 - app.services.rag_service - INFO - Processing note 09aa0296-8c08-444a-babb-fa192acb3e4d for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:21:01,021 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:21:01,021 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:21:01,022 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:21:01,022 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:21:01,022 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:21:01,022 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:21:01,023 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:21:01,023 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:21:01,023 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:21:01,023 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:21:01,024 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:21:01,024 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:21:01,024 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:21:01,024 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:21:01,240 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:21:08,859 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-02 20:21:08,859 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:21:09,061 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:21:09,412 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:22:15,082 - app - INFO - Loading existing vector store from /backend/chroma_db
2025-04-02 20:22:15,082 - app - INFO - Loading existing vector store from /backend/chroma_db
2025-04-02 20:22:15,184 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:22:15,513 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-02 20:22:15,730 - app - INFO -  Vector store initialized successfully
2025-04-02 20:22:15,730 - app - INFO -  Vector store initialized successfully
2025-04-02 20:22:15,732 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:22:16,086 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:22:16,437 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:22:38,546 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:22:38,547 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:22:38,547 - sqlalchemy.engine.Engine - INFO - [cached since 105.2s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:22:38,551 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:22:38,552 - sqlalchemy.engine.Engine - INFO - [cached since 105.2s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:22:38,558 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:22:38,558 - sqlalchemy.engine.Engine - INFO - [cached since 105.2s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:22:38,563 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:22:38,564 - sqlalchemy.engine.Engine - INFO - [cached since 105.1s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:22:38,568 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:22:38,568 - sqlalchemy.engine.Engine - INFO - [cached since 105.1s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:22:38,572 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is professor ita
2025-04-02 20:22:38,572 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is professor ita
2025-04-02 20:22:38,599 - app - ERROR -  Vector store not initialized
2025-04-02 20:22:38,599 - app - ERROR -  Vector store not initialized
2025-04-02 20:22:38,603 - app - ERROR -  Vector store not initialized
2025-04-02 20:22:38,603 - app - ERROR -  Vector store not initialized
2025-04-02 20:22:38,604 - app.services.rag_service - ERROR - Retrieval failed. No context was returned.
2025-04-02 20:22:38,604 - app.services.rag_service - ERROR - Retrieval failed. No context was returned.
2025-04-02 20:22:38,606 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 20:22:38,607 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] (UUID('848872b2-3cd9-4b07-821a-38f904a03ac0'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'who is professor ita', "I couldn't find any relevant information in your notes.", datetime.datetime(2025, 4, 2, 20, 22, 38, 606857, tzinfo=datetime.timezone.utc))
2025-04-02 20:22:38,610 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:22:38,614 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:22:38,619 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 20:22:38,619 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('848872b2-3cd9-4b07-821a-38f904a03ac0'),)
2025-04-02 20:22:38,624 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:22:38,649 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:02,949 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:03,124 - app.main - INFO - Shutting down application
2025-04-02 20:29:03,124 - app.main - INFO - Shutting down application
2025-04-02 20:29:03,131 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:03,131 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:03,142 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:03,142 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:03,562 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:04,765 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:29:05,116 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:05,467 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:05,818 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:07,512 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:29:07,863 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:09,886 - app.main - INFO - Starting up application
2025-04-02 20:29:09,886 - app.main - INFO - Starting up application
2025-04-02 20:29:09,959 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:29:09,960 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:09,963 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:29:09,964 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:09,967 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:29:09,967 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:09,969 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:29:09,974 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:09,975 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:09,979 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:09,980 - sqlalchemy.engine.Engine - INFO - [cached since 0.005921s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:09,982 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:09,983 - sqlalchemy.engine.Engine - INFO - [cached since 0.009115s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:09,986 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:29:09,987 - app.main - INFO - Database tables created successfully
2025-04-02 20:29:09,987 - app.main - INFO - Database tables created successfully
2025-04-02 20:29:10,219 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:10,570 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:29:10,691 - app.main - INFO - Shutting down application
2025-04-02 20:29:10,691 - app.main - INFO - Shutting down application
2025-04-02 20:29:10,698 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:10,698 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:10,698 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:10,698 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:12,026 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:29:12,377 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:14,146 - app.main - INFO - Starting up application
2025-04-02 20:29:14,146 - app.main - INFO - Starting up application
2025-04-02 20:29:14,218 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:29:14,218 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:14,222 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:29:14,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:14,226 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:29:14,226 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:14,229 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:29:14,237 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:14,237 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:14,242 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:14,243 - sqlalchemy.engine.Engine - INFO - [cached since 0.006185s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:14,245 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:14,245 - sqlalchemy.engine.Engine - INFO - [cached since 0.008524s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:14,247 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:29:14,248 - app.main - INFO - Database tables created successfully
2025-04-02 20:29:14,248 - app.main - INFO - Database tables created successfully
2025-04-02 20:29:14,388 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:48,990 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:49,141 - app.main - INFO - Shutting down application
2025-04-02 20:29:49,141 - app.main - INFO - Shutting down application
2025-04-02 20:29:49,148 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:49,148 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:49,149 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:49,149 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:49,528 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:50,782 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:29:51,134 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:51,485 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:52,671 - app.main - INFO - Starting up application
2025-04-02 20:29:52,671 - app.main - INFO - Starting up application
2025-04-02 20:29:52,730 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:29:52,730 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:52,734 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:29:52,734 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:52,737 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:29:52,737 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:29:52,739 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:29:52,745 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:52,746 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:52,751 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:52,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.006307s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:52,754 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:29:52,755 - sqlalchemy.engine.Engine - INFO - [cached since 0.009506s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:29:52,757 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:29:52,758 - app.main - INFO - Database tables created successfully
2025-04-02 20:29:52,758 - app.main - INFO - Database tables created successfully
2025-04-02 20:29:52,888 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:57,101 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:57,271 - app.main - INFO - Shutting down application
2025-04-02 20:29:57,271 - app.main - INFO - Shutting down application
2025-04-02 20:29:57,275 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:57,275 - app.main - INFO - Database connections closed successfully
2025-04-02 20:29:57,275 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:57,275 - app.main - INFO - Vector store closed successfully
2025-04-02 20:29:57,646 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:29:58,599 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:29:58,950 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:30:00,371 - app.main - INFO - Starting up application
2025-04-02 20:30:00,371 - app.main - INFO - Starting up application
2025-04-02 20:30:00,425 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:30:00,426 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:30:00,429 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:30:00,429 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:30:00,432 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:30:00,432 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:30:00,434 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:30:00,439 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:30:00,439 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:30:00,443 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:30:00,443 - sqlalchemy.engine.Engine - INFO - [cached since 0.004383s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:30:00,444 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:30:00,445 - sqlalchemy.engine.Engine - INFO - [cached since 0.005967s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:30:00,446 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:30:00,448 - app.main - INFO - Database tables created successfully
2025-04-02 20:30:00,448 - app.main - INFO - Database tables created successfully
2025-04-02 20:30:00,704 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:36:24,315 - __main__ - INFO - Starting development server
2025-04-02 20:36:27,367 - app.main - INFO - Starting up application
2025-04-02 20:36:27,367 - app.main - INFO - Starting up application
2025-04-02 20:36:27,485 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:36:27,485 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:36:27,488 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:36:27,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:36:27,490 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:36:27,491 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:36:27,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:36:27,498 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:36:27,498 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:36:27,510 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:36:27,511 - sqlalchemy.engine.Engine - INFO - [cached since 0.01338s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:36:27,512 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:36:27,512 - sqlalchemy.engine.Engine - INFO - [cached since 0.01475s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:36:27,513 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:36:27,514 - app.main - INFO - Database tables created successfully
2025-04-02 20:36:27,514 - app.main - INFO - Database tables created successfully
2025-04-02 20:36:27,630 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:36:55,037 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:36:55,062 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 20:36:55,062 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 20:36:55,077 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:36:55,078 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,092 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:36:55,092 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,099 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:36:55,099 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,106 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:36:55,106 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,110 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-02 20:36:55,332 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:36:55,431 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:36:55,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:36:55,834 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:36:55,835 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:36:55,839 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:36:55,840 - sqlalchemy.engine.Engine - INFO - [cached since 0.7625s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,846 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:36:55,846 - sqlalchemy.engine.Engine - INFO - [cached since 0.7548s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,852 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:36:55,852 - sqlalchemy.engine.Engine - INFO - [cached since 0.7531s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,857 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:36:55,858 - sqlalchemy.engine.Engine - INFO - [cached since 0.752s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,860 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:36:55,860 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:36:55,861 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:36:55,861 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:36:55,862 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 20:36:55,872 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:36:55,873 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:36:55,874 - sqlalchemy.engine.Engine - INFO - [cached since 0.03992s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:36:55,879 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:36:55,883 - sqlalchemy.engine.Engine - INFO - [cached since 0.8052s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,893 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:36:55,895 - sqlalchemy.engine.Engine - INFO - [cached since 0.8034s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,909 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:36:55,909 - sqlalchemy.engine.Engine - INFO - [cached since 0.8102s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,913 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:36:55,914 - sqlalchemy.engine.Engine - INFO - [cached since 0.8082s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:36:55,916 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:36:55,916 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:36:55,917 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:36:55,917 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:36:55,929 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 20:37:07,758 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:37:07,759 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:37:07,759 - sqlalchemy.engine.Engine - INFO - [cached since 11.93s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:37:07,761 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:37:07,761 - sqlalchemy.engine.Engine - INFO - [cached since 12.68s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:37:07,763 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:37:07,763 - sqlalchemy.engine.Engine - INFO - [cached since 12.67s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:37:07,766 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:37:07,766 - sqlalchemy.engine.Engine - INFO - [cached since 12.67s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:37:07,769 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:37:07,769 - sqlalchemy.engine.Engine - INFO - [cached since 12.66s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:37:07,786 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 20:37:07,787 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('2e926bd6-10fd-4cb3-8e9a-35ffa858b803'), datetime.datetime(2025, 4, 2, 20, 37, 7, 786894, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 20:37:07,789 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:37:07,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:37:07,798 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 20:37:07,798 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (UUID('2e926bd6-10fd-4cb3-8e9a-35ffa858b803'),)
2025-04-02 20:37:07,801 - app.services.rag_service - INFO - Processing note 2e926bd6-10fd-4cb3-8e9a-35ffa858b803 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:37:07,801 - app.services.rag_service - INFO - Processing note 2e926bd6-10fd-4cb3-8e9a-35ffa858b803 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:37:07,804 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:37:07,804 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:37:07,804 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:37:07,804 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:37:07,804 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:37:07,804 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:37:07,805 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:37:07,805 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:37:07,805 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:37:07,805 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:37:07,806 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:37:07,806 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 20:37:07,806 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:37:07,806 - app - INFO - Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:37:07,968 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:37:14,738 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-02 20:37:14,739 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-02 20:37:14,886 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:38:44,330 - app - INFO - Loading existing vector store from /backend/chroma_db
2025-04-02 20:38:44,330 - app - INFO - Loading existing vector store from /backend/chroma_db
2025-04-02 20:38:44,743 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:38:44,930 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-02 20:38:45,197 - app - INFO -  Vector store initialized successfully
2025-04-02 20:38:45,197 - app - INFO -  Vector store initialized successfully
2025-04-02 20:38:45,198 - app.services.rag_service - INFO -  Retriever initialized successfully
2025-04-02 20:38:45,198 - app.services.rag_service - INFO -  Retriever initialized successfully
2025-04-02 20:38:45,198 - app.services.rag_service - INFO -  Note 2e926bd6-10fd-4cb3-8e9a-35ffa858b803 processed and added to retriever
2025-04-02 20:38:45,198 - app.services.rag_service - INFO -  Note 2e926bd6-10fd-4cb3-8e9a-35ffa858b803 processed and added to retriever
2025-04-02 20:38:45,199 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:38:45,395 - watchfiles.main - INFO - 3 changes detected
2025-04-02 20:39:18,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:39:18,977 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:39:18,978 - sqlalchemy.engine.Engine - INFO - [cached since 143.2s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:39:18,992 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:39:18,992 - sqlalchemy.engine.Engine - INFO - [cached since 143.9s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:39:18,997 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:39:18,997 - sqlalchemy.engine.Engine - INFO - [cached since 143.9s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:39:19,002 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:39:19,007 - sqlalchemy.engine.Engine - INFO - [cached since 143.9s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:39:19,016 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:39:19,017 - sqlalchemy.engine.Engine - INFO - [cached since 143.9s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:39:19,020 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:39:19,020 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:39:19,021 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is professor Ita
2025-04-02 20:39:19,021 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is professor Ita
2025-04-02 20:39:19,052 - app - ERROR -  Vector store not initialized
2025-04-02 20:39:19,052 - app - ERROR -  Vector store not initialized
2025-04-02 20:39:19,057 - app - ERROR -  Vector store not initialized
2025-04-02 20:39:19,057 - app - ERROR -  Vector store not initialized
2025-04-02 20:39:19,057 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 20:39:19,057 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 20:39:19,061 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 20:39:19,061 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (UUID('5f4fcdd8-0b1b-4113-aa87-3057e3a5e59f'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'who is professor Ita', "I couldn't find any relevant information in your notes.", datetime.datetime(2025, 4, 2, 20, 39, 19, 61252, tzinfo=datetime.timezone.utc))
2025-04-02 20:39:19,082 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:39:19,086 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:39:19,090 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:39:19,093 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 20:39:19,094 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] (UUID('5f4fcdd8-0b1b-4113-aa87-3057e3a5e59f'),)
2025-04-02 20:39:19,098 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:39:19,098 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:39:19,099 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:39:19,442 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:00,431 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:00,561 - app.main - INFO - Shutting down application
2025-04-02 20:41:00,561 - app.main - INFO - Shutting down application
2025-04-02 20:41:00,568 - app.main - INFO - Database connections closed successfully
2025-04-02 20:41:00,568 - app.main - INFO - Database connections closed successfully
2025-04-02 20:41:00,575 - app.main - INFO - Vector store closed successfully
2025-04-02 20:41:00,575 - app.main - INFO - Vector store closed successfully
2025-04-02 20:41:00,997 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:04,039 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:41:04,390 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:05,074 - app.main - INFO - Starting up application
2025-04-02 20:41:05,074 - app.main - INFO - Starting up application
2025-04-02 20:41:05,142 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:41:05,142 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:41:05,146 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:41:05,146 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:41:05,151 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:41:05,151 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:41:05,153 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:41:05,159 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:41:05,159 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:41:05,164 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:41:05,165 - sqlalchemy.engine.Engine - INFO - [cached since 0.006034s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:41:05,166 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:41:05,167 - sqlalchemy.engine.Engine - INFO - [cached since 0.008146s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:41:05,168 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:41:05,169 - app.main - INFO - Database tables created successfully
2025-04-02 20:41:05,169 - app.main - INFO - Database tables created successfully
2025-04-02 20:41:05,242 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:11,258 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:11,396 - app.main - INFO - Shutting down application
2025-04-02 20:41:11,396 - app.main - INFO - Shutting down application
2025-04-02 20:41:11,403 - app.main - INFO - Database connections closed successfully
2025-04-02 20:41:11,403 - app.main - INFO - Database connections closed successfully
2025-04-02 20:41:11,405 - app.main - INFO - Vector store closed successfully
2025-04-02 20:41:11,405 - app.main - INFO - Vector store closed successfully
2025-04-02 20:41:11,782 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:13,086 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:41:13,436 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:41:26,243 - app.main - INFO - Starting up application
2025-04-02 20:41:26,243 - app.main - INFO - Starting up application
2025-04-02 20:41:26,308 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:41:26,309 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:41:26,313 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:41:26,313 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:41:26,316 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:41:26,316 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:41:26,319 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:41:26,328 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:41:26,328 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:41:26,332 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:41:26,333 - sqlalchemy.engine.Engine - INFO - [cached since 0.005142s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:41:26,334 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:41:26,334 - sqlalchemy.engine.Engine - INFO - [cached since 0.006852s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:41:26,336 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:41:26,338 - app.main - INFO - Database tables created successfully
2025-04-02 20:41:26,338 - app.main - INFO - Database tables created successfully
2025-04-02 20:41:26,636 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:23,763 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:23,922 - app.main - INFO - Shutting down application
2025-04-02 20:42:23,922 - app.main - INFO - Shutting down application
2025-04-02 20:42:23,927 - app.main - INFO - Database connections closed successfully
2025-04-02 20:42:23,927 - app.main - INFO - Database connections closed successfully
2025-04-02 20:42:23,956 - app.main - INFO - Vector store closed successfully
2025-04-02 20:42:23,956 - app.main - INFO - Vector store closed successfully
2025-04-02 20:42:24,369 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:24,721 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:26,484 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:42:26,835 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:37,234 - app.main - INFO - Starting up application
2025-04-02 20:42:37,234 - app.main - INFO - Starting up application
2025-04-02 20:42:37,287 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:42:37,288 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:42:37,291 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:42:37,291 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:42:37,294 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:42:37,294 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:42:37,296 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:42:37,301 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:42:37,301 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:42:37,304 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:42:37,304 - sqlalchemy.engine.Engine - INFO - [cached since 0.003852s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:42:37,306 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:42:37,306 - sqlalchemy.engine.Engine - INFO - [cached since 0.005872s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:42:37,308 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:42:37,309 - app.main - INFO - Database tables created successfully
2025-04-02 20:42:37,309 - app.main - INFO - Database tables created successfully
2025-04-02 20:42:37,364 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:47,591 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:47,742 - app.main - INFO - Shutting down application
2025-04-02 20:42:47,742 - app.main - INFO - Shutting down application
2025-04-02 20:42:47,747 - app.main - INFO - Database connections closed successfully
2025-04-02 20:42:47,747 - app.main - INFO - Database connections closed successfully
2025-04-02 20:42:47,771 - app.main - INFO - Vector store closed successfully
2025-04-02 20:42:47,771 - app.main - INFO - Vector store closed successfully
2025-04-02 20:42:48,168 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:48,519 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:49,078 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:42:49,429 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:42:59,126 - app.main - INFO - Starting up application
2025-04-02 20:42:59,126 - app.main - INFO - Starting up application
2025-04-02 20:42:59,181 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:42:59,181 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:42:59,186 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:42:59,186 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:42:59,190 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:42:59,190 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:42:59,193 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:42:59,199 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:42:59,199 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:42:59,203 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:42:59,203 - sqlalchemy.engine.Engine - INFO - [cached since 0.005049s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:42:59,206 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:42:59,206 - sqlalchemy.engine.Engine - INFO - [cached since 0.007833s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:42:59,209 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:42:59,211 - app.main - INFO - Database tables created successfully
2025-04-02 20:42:59,211 - app.main - INFO - Database tables created successfully
2025-04-02 20:42:59,288 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:44:10,868 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:44:10,912 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:44:10,912 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:44:10,956 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:44:10,957 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:10,979 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:44:10,980 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:11,001 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:44:11,005 - sqlalchemy.engine.Engine - INFO - [generated in 0.00421s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:11,016 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:44:11,017 - sqlalchemy.engine.Engine - INFO - [generated in 0.00111s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:11,024 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:11,024 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:11,025 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:44:11,025 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:44:11,029 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 20:44:11,193 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:44:20,397 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:44:20,400 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:44:20,401 - sqlalchemy.engine.Engine - INFO - [cached since 9.492s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:44:20,407 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:44:20,408 - sqlalchemy.engine.Engine - INFO - [cached since 9.454s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:20,412 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:44:20,413 - sqlalchemy.engine.Engine - INFO - [cached since 9.436s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:20,416 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:44:20,417 - sqlalchemy.engine.Engine - INFO - [cached since 9.418s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:20,422 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:44:20,422 - sqlalchemy.engine.Engine - INFO - [cached since 9.409s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:20,447 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 20:44:20,448 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (UUID('4decff6e-6420-45fd-ad60-51db6f65fa50'), datetime.datetime(2025, 4, 2, 20, 44, 20, 447725, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 20:44:20,453 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:44:20,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:44:20,462 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 20:44:20,463 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('4decff6e-6420-45fd-ad60-51db6f65fa50'),)
2025-04-02 20:44:20,467 - app.services.rag_service - INFO - Processing note 4decff6e-6420-45fd-ad60-51db6f65fa50 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:20,467 - app.services.rag_service - INFO - Processing note 4decff6e-6420-45fd-ad60-51db6f65fa50 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:20,467 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:44:20,470 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:44:20,470 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:44:20,471 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:44:20,471 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:44:20,471 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:44:20,471 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:44:20,471 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:44:20,471 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:44:20,472 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:44:20,472 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:44:20,473 - app.services.rag_service - INFO - Adding documents to existing retriever...
2025-04-02 20:44:20,473 - app.services.rag_service - INFO - Adding documents to existing retriever...
2025-04-02 20:44:20,498 - app - ERROR -  Vector store not initialized
2025-04-02 20:44:20,498 - app - ERROR -  Vector store not initialized
2025-04-02 20:44:20,499 - app.services.rag_service - ERROR -  Failed to process note 4decff6e-6420-45fd-ad60-51db6f65fa50
2025-04-02 20:44:20,499 - app.services.rag_service - ERROR -  Failed to process note 4decff6e-6420-45fd-ad60-51db6f65fa50
2025-04-02 20:44:20,500 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:44:20,820 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:44:53,558 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:44:53,559 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:44:53,559 - sqlalchemy.engine.Engine - INFO - [cached since 42.65s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:44:53,565 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:44:53,566 - sqlalchemy.engine.Engine - INFO - [cached since 42.61s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:53,570 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:44:53,570 - sqlalchemy.engine.Engine - INFO - [cached since 42.6s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:53,573 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:44:53,574 - sqlalchemy.engine.Engine - INFO - [cached since 42.58s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:53,577 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:44:53,577 - sqlalchemy.engine.Engine - INFO - [cached since 42.57s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:44:53,582 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:53,582 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:53,582 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is Ita
2025-04-02 20:44:53,582 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is Ita
2025-04-02 20:44:53,585 - app - ERROR -  Vector store not initialized
2025-04-02 20:44:53,585 - app - ERROR -  Vector store not initialized
2025-04-02 20:44:53,589 - app - ERROR -  Vector store not initialized
2025-04-02 20:44:53,589 - app - ERROR -  Vector store not initialized
2025-04-02 20:44:53,590 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 20:44:53,590 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 20:44:53,593 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 20:44:53,593 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (UUID('ff770485-a320-4f49-9f82-486d2fd082e6'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'who is Ita', "I couldn't find any relevant information in your notes.", datetime.datetime(2025, 4, 2, 20, 44, 53, 592993, tzinfo=datetime.timezone.utc))
2025-04-02 20:44:53,597 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:44:53,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:44:53,605 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 20:44:53,605 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (UUID('ff770485-a320-4f49-9f82-486d2fd082e6'),)
2025-04-02 20:44:53,608 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:53,608 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:44:53,609 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:44:53,861 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:47:22,067 - __main__ - INFO - Starting development server
2025-04-02 20:47:36,948 - app.main - INFO - Starting up application
2025-04-02 20:47:36,948 - app.main - INFO - Starting up application
2025-04-02 20:47:37,062 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:47:37,063 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:47:37,071 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:47:37,071 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:47:37,076 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:47:37,076 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:47:37,079 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:47:37,086 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:47:37,086 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:47:37,108 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:47:37,108 - sqlalchemy.engine.Engine - INFO - [cached since 0.02268s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:47:37,110 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:47:37,111 - sqlalchemy.engine.Engine - INFO - [cached since 0.02497s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:47:37,112 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:47:37,113 - app.main - INFO - Database tables created successfully
2025-04-02 20:47:37,113 - app.main - INFO - Database tables created successfully
2025-04-02 20:47:37,135 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:48:08,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:48:08,569 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:48:08,569 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:48:08,589 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:48:08,590 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:48:08,602 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:48:08,602 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:48:08,655 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:48:08,655 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:48:08,660 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:48:08,661 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:48:08,678 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 20:48:08,678 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (UUID('4f37b9e0-3088-41be-ad61-71bab41716ab'), datetime.datetime(2025, 4, 2, 20, 48, 8, 678152, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 20:48:08,685 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:48:08,692 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:48:08,695 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 20:48:08,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] (UUID('4f37b9e0-3088-41be-ad61-71bab41716ab'),)
2025-04-02 20:48:08,699 - app.services.rag_service - INFO - Processing note 4f37b9e0-3088-41be-ad61-71bab41716ab for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:48:08,699 - app.services.rag_service - INFO - Processing note 4f37b9e0-3088-41be-ad61-71bab41716ab for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:48:08,702 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:48:08,703 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:48:08,703 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:48:08,705 - app.services.rag_service - INFO - Adding documents to existing retriever...
2025-04-02 20:48:08,705 - app.services.rag_service - INFO - Adding documents to existing retriever...
2025-04-02 20:48:08,729 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:48:08,731 - app - ERROR -  Vector store not initialized
2025-04-02 20:48:08,731 - app - ERROR -  Vector store not initialized
2025-04-02 20:48:08,731 - app.services.rag_service - ERROR -  Failed to process note 4f37b9e0-3088-41be-ad61-71bab41716ab
2025-04-02 20:48:08,731 - app.services.rag_service - ERROR -  Failed to process note 4f37b9e0-3088-41be-ad61-71bab41716ab
2025-04-02 20:48:08,733 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:48:09,080 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:48:09,431 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:04,513 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:04,639 - app.main - INFO - Shutting down application
2025-04-02 20:50:04,639 - app.main - INFO - Shutting down application
2025-04-02 20:50:04,650 - app.main - INFO - Database connections closed successfully
2025-04-02 20:50:04,650 - app.main - INFO - Database connections closed successfully
2025-04-02 20:50:04,657 - app.main - INFO - Vector store closed successfully
2025-04-02 20:50:04,657 - app.main - INFO - Vector store closed successfully
2025-04-02 20:50:05,108 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:05,460 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:06,636 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:50:06,988 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:20,246 - app.main - INFO - Starting up application
2025-04-02 20:50:20,246 - app.main - INFO - Starting up application
2025-04-02 20:50:20,310 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:50:20,310 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:50:20,313 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:50:20,313 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:50:20,316 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:50:20,316 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:50:20,319 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:50:20,325 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:50:20,325 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:50:20,332 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:50:20,332 - sqlalchemy.engine.Engine - INFO - [cached since 0.007726s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:50:20,334 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:50:20,334 - sqlalchemy.engine.Engine - INFO - [cached since 0.009586s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:50:20,336 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:50:20,337 - app.main - INFO - Database tables created successfully
2025-04-02 20:50:20,337 - app.main - INFO - Database tables created successfully
2025-04-02 20:50:20,477 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:43,943 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:44,098 - app.main - INFO - Shutting down application
2025-04-02 20:50:44,098 - app.main - INFO - Shutting down application
2025-04-02 20:50:44,103 - app.main - INFO - Database connections closed successfully
2025-04-02 20:50:44,103 - app.main - INFO - Database connections closed successfully
2025-04-02 20:50:44,123 - app.main - INFO - Vector store closed successfully
2025-04-02 20:50:44,123 - app.main - INFO - Vector store closed successfully
2025-04-02 20:50:44,518 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:45,421 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:50:45,772 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:50:55,605 - app.main - INFO - Starting up application
2025-04-02 20:50:55,605 - app.main - INFO - Starting up application
2025-04-02 20:50:55,660 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:50:55,660 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:50:55,663 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:50:55,663 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:50:55,666 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:50:55,666 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:50:55,668 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:50:55,673 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:50:55,673 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:50:55,677 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:50:55,677 - sqlalchemy.engine.Engine - INFO - [cached since 0.004233s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:50:55,678 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:50:55,678 - sqlalchemy.engine.Engine - INFO - [cached since 0.005638s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:50:55,680 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:50:55,681 - app.main - INFO - Database tables created successfully
2025-04-02 20:50:55,681 - app.main - INFO - Database tables created successfully
2025-04-02 20:50:55,955 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:51:38,976 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:51:39,327 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:51:39,678 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:51:52,211 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:51:52,335 - app.main - INFO - Shutting down application
2025-04-02 20:51:52,335 - app.main - INFO - Shutting down application
2025-04-02 20:51:52,339 - app.main - INFO - Database connections closed successfully
2025-04-02 20:51:52,339 - app.main - INFO - Database connections closed successfully
2025-04-02 20:51:52,363 - app.main - INFO - Vector store closed successfully
2025-04-02 20:51:52,363 - app.main - INFO - Vector store closed successfully
2025-04-02 20:51:52,766 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:51:54,622 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:51:54,972 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:52:06,458 - app.main - INFO - Starting up application
2025-04-02 20:52:06,458 - app.main - INFO - Starting up application
2025-04-02 20:52:06,512 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 20:52:06,512 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:52:06,515 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 20:52:06,515 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:52:06,517 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 20:52:06,517 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 20:52:06,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:52:06,524 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:52:06,524 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:52:06,527 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:52:06,527 - sqlalchemy.engine.Engine - INFO - [cached since 0.004073s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:52:06,529 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 20:52:06,529 - sqlalchemy.engine.Engine - INFO - [cached since 0.00568s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 20:52:06,531 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:52:06,532 - app.main - INFO - Database tables created successfully
2025-04-02 20:52:06,532 - app.main - INFO - Database tables created successfully
2025-04-02 20:52:06,655 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:52:24,358 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:52:24,709 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:52:59,301 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:52:59,324 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:52:59,324 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:52:59,342 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:52:59,342 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:52:59,356 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:52:59,356 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:52:59,364 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:52:59,364 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:52:59,371 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:52:59,371 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:52:59,374 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:52:59,374 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:52:59,374 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:52:59,374 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 20:52:59,376 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 20:52:59,562 - watchfiles.main - INFO - 1 change detected
2025-04-02 20:53:16,748 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:53:16,750 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:53:16,751 - sqlalchemy.engine.Engine - INFO - [cached since 17.43s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:53:16,758 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:53:16,758 - sqlalchemy.engine.Engine - INFO - [cached since 17.42s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:16,764 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:53:16,765 - sqlalchemy.engine.Engine - INFO - [cached since 17.41s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:16,771 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:53:16,772 - sqlalchemy.engine.Engine - INFO - [cached since 17.41s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:16,777 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:53:16,778 - sqlalchemy.engine.Engine - INFO - [cached since 17.41s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:16,798 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 20:53:16,799 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('44078bc6-4354-4536-be1f-c0cc786bc262'), datetime.datetime(2025, 4, 2, 20, 53, 16, 798548, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 20:53:16,802 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:53:16,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:53:16,811 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 20:53:16,811 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (UUID('44078bc6-4354-4536-be1f-c0cc786bc262'),)
2025-04-02 20:53:16,815 - app.services.rag_service - INFO - Processing note 44078bc6-4354-4536-be1f-c0cc786bc262 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:53:16,815 - app.services.rag_service - INFO - Processing note 44078bc6-4354-4536-be1f-c0cc786bc262 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:53:16,818 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:53:16,818 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 20:53:16,818 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:53:16,818 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 20:53:16,819 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:53:16,819 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 20:53:16,819 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:53:16,819 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 20:53:16,819 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:53:16,819 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 20:53:16,820 - app.services.rag_service - INFO - Adding documents to existing retriever...
2025-04-02 20:53:16,820 - app.services.rag_service - INFO - Adding documents to existing retriever...
2025-04-02 20:53:16,851 - app - ERROR -  Vector store not initialized
2025-04-02 20:53:16,851 - app - ERROR -  Vector store not initialized
2025-04-02 20:53:16,852 - app.services.rag_service - ERROR -  Failed to process note 44078bc6-4354-4536-be1f-c0cc786bc262
2025-04-02 20:53:16,852 - app.services.rag_service - ERROR -  Failed to process note 44078bc6-4354-4536-be1f-c0cc786bc262
2025-04-02 20:53:16,855 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:53:17,009 - watchfiles.main - INFO - 2 changes detected
2025-04-02 20:53:27,234 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:53:27,235 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 20:53:27,236 - sqlalchemy.engine.Engine - INFO - [cached since 27.91s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 20:53:27,240 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:53:27,240 - sqlalchemy.engine.Engine - INFO - [cached since 27.9s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:27,243 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:53:27,244 - sqlalchemy.engine.Engine - INFO - [cached since 27.89s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:27,248 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 20:53:27,249 - sqlalchemy.engine.Engine - INFO - [cached since 27.89s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:27,252 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 20:53:27,253 - sqlalchemy.engine.Engine - INFO - [cached since 27.88s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 20:53:27,256 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:53:27,256 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:53:27,257 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is prof Ita
2025-04-02 20:53:27,257 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is prof Ita
2025-04-02 20:53:27,261 - app - ERROR -  Vector store not initialized
2025-04-02 20:53:27,261 - app - ERROR -  Vector store not initialized
2025-04-02 20:53:27,265 - app - ERROR -  Vector store not initialized
2025-04-02 20:53:27,265 - app - ERROR -  Vector store not initialized
2025-04-02 20:53:27,266 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 20:53:27,266 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 20:53:27,269 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 20:53:27,269 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('0a7ef05f-4fdf-468a-9197-619e4e7d6b02'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'who is prof Ita', "I couldn't find any relevant information in your notes.", datetime.datetime(2025, 4, 2, 20, 53, 27, 269001, tzinfo=datetime.timezone.utc))
2025-04-02 20:53:27,272 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:53:27,275 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 20:53:27,280 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 20:53:27,281 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] (UUID('0a7ef05f-4fdf-468a-9197-619e4e7d6b02'),)
2025-04-02 20:53:27,285 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:53:27,285 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 20:53:27,286 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 20:53:27,542 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:06,631 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:06,832 - app.main - INFO - Shutting down application
2025-04-02 21:00:06,832 - app.main - INFO - Shutting down application
2025-04-02 21:00:06,839 - app.main - INFO - Database connections closed successfully
2025-04-02 21:00:06,839 - app.main - INFO - Database connections closed successfully
2025-04-02 21:00:06,844 - app.main - INFO - Vector store closed successfully
2025-04-02 21:00:06,844 - app.main - INFO - Vector store closed successfully
2025-04-02 21:00:07,264 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:07,627 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:09,360 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:00:09,711 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:18,984 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:19,355 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:19,715 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:20,775 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:00:21,146 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:21,496 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:32,804 - app.main - INFO - Starting up application
2025-04-02 21:00:32,804 - app.main - INFO - Starting up application
2025-04-02 21:00:32,908 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:00:32,909 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:00:32,915 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:00:32,915 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:00:32,919 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:00:32,919 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:00:32,926 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:00:32,937 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:00:32,937 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:00:32,942 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:00:32,942 - sqlalchemy.engine.Engine - INFO - [cached since 0.005785s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:00:32,944 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:00:32,945 - sqlalchemy.engine.Engine - INFO - [cached since 0.007998s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:00:32,947 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:00:32,948 - app.main - INFO - Database tables created successfully
2025-04-02 21:00:32,948 - app.main - INFO - Database tables created successfully
2025-04-02 21:00:33,131 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:00:33,482 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:07:54,657 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:07:54,797 - app.main - INFO - Shutting down application
2025-04-02 21:07:54,797 - app.main - INFO - Shutting down application
2025-04-02 21:07:54,803 - app.main - INFO - Database connections closed successfully
2025-04-02 21:07:54,803 - app.main - INFO - Database connections closed successfully
2025-04-02 21:07:54,840 - app.main - INFO - Vector store closed successfully
2025-04-02 21:07:54,840 - app.main - INFO - Vector store closed successfully
2025-04-02 21:07:55,230 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:07:55,581 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:07:59,492 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:07:59,844 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:08:09,200 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:08:09,552 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:08:22,438 - app.main - INFO - Starting up application
2025-04-02 21:08:22,438 - app.main - INFO - Starting up application
2025-04-02 21:08:22,513 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:08:22,514 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:08:22,520 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:08:22,520 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:08:22,524 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:08:22,525 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:08:22,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:08:22,539 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:08:22,540 - sqlalchemy.engine.Engine - INFO - [generated in 0.00111s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:08:22,549 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:08:22,549 - sqlalchemy.engine.Engine - INFO - [cached since 0.01031s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:08:22,551 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:08:22,552 - sqlalchemy.engine.Engine - INFO - [cached since 0.01267s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:08:22,554 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:08:22,555 - app.main - INFO - Database tables created successfully
2025-04-02 21:08:22,555 - app.main - INFO - Database tables created successfully
2025-04-02 21:08:22,647 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:11:26,652 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:11:26,803 - app.main - INFO - Shutting down application
2025-04-02 21:11:26,803 - app.main - INFO - Shutting down application
2025-04-02 21:11:26,815 - app.main - INFO - Database connections closed successfully
2025-04-02 21:11:26,815 - app.main - INFO - Database connections closed successfully
2025-04-02 21:11:26,892 - app.main - INFO - Vector store closed successfully
2025-04-02 21:11:26,892 - app.main - INFO - Vector store closed successfully
2025-04-02 21:11:27,502 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:11:27,910 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:11:36,862 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:11:37,221 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:11:37,577 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:11:50,507 - app.main - INFO - Starting up application
2025-04-02 21:11:50,507 - app.main - INFO - Starting up application
2025-04-02 21:11:50,580 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:11:50,580 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:11:50,585 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:11:50,586 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:11:50,589 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:11:50,590 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:11:50,593 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:11:50,602 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:11:50,603 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:11:50,609 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:11:50,610 - sqlalchemy.engine.Engine - INFO - [cached since 0.007736s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:11:50,612 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:11:50,612 - sqlalchemy.engine.Engine - INFO - [cached since 0.009914s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:11:50,614 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:11:50,615 - app.main - INFO - Database tables created successfully
2025-04-02 21:11:50,615 - app.main - INFO - Database tables created successfully
2025-04-02 21:11:50,670 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:12:14,289 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:12:14,327 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:12:14,329 - sqlalchemy.engine.Engine - INFO - [generated in 0.00254s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:12:14,345 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:14,346 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,357 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:14,358 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,370 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:14,370 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,378 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:14,380 - sqlalchemy.engine.Engine - INFO - [generated in 0.00146s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,384 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-02 21:12:14,448 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:12:14,718 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:12:14,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:12:14,853 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:12:14,854 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:12:14,862 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:14,862 - sqlalchemy.engine.Engine - INFO - [cached since 0.5171s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,878 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:14,878 - sqlalchemy.engine.Engine - INFO - [cached since 0.5213s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,884 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:14,884 - sqlalchemy.engine.Engine - INFO - [cached since 0.5147s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,919 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:14,920 - sqlalchemy.engine.Engine - INFO - [cached since 0.5417s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,924 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:14,924 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:14,925 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:12:14,925 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:12:14,927 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:12:14,958 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:12:14,959 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:12:14,959 - sqlalchemy.engine.Engine - INFO - [cached since 0.1058s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:12:14,973 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:14,974 - sqlalchemy.engine.Engine - INFO - [cached since 0.629s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:14,988 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:14,988 - sqlalchemy.engine.Engine - INFO - [cached since 0.6311s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:15,003 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:15,004 - sqlalchemy.engine.Engine - INFO - [cached since 0.6345s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:15,009 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:15,010 - sqlalchemy.engine.Engine - INFO - [cached since 0.6317s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:15,013 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:15,013 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:15,014 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:12:15,014 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 130, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:12:15,026 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:12:15,351 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:12:26,681 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:12:26,681 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:12:26,682 - sqlalchemy.engine.Engine - INFO - [cached since 11.83s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:12:26,685 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:26,686 - sqlalchemy.engine.Engine - INFO - [cached since 12.34s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:26,690 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:26,690 - sqlalchemy.engine.Engine - INFO - [cached since 12.33s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:26,695 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:26,695 - sqlalchemy.engine.Engine - INFO - [cached since 12.33s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:26,699 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:26,700 - sqlalchemy.engine.Engine - INFO - [cached since 12.32s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:26,723 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, upload_date, user_id, note_text, file_name) VALUES ($1::UUID, $2::TIMESTAMP WITH TIME ZONE, $3::UUID, $4::VARCHAR, $5::VARCHAR)
2025-04-02 21:12:26,723 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] (UUID('adebcca6-5efa-404b-adea-f94acca92861'), datetime.datetime(2025, 4, 2, 21, 12, 26, 722953, tzinfo=datetime.timezone.utc), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx')
2025-04-02 21:12:26,727 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:12:26,738 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:12:26,742 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.upload_date, notes.user_id, notes.note_text, notes.file_name, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.id = $1::UUID
2025-04-02 21:12:26,742 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (UUID('adebcca6-5efa-404b-adea-f94acca92861'),)
2025-04-02 21:12:26,745 - app.services.rag_service - INFO - Processing note adebcca6-5efa-404b-adea-f94acca92861 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:26,745 - app.services.rag_service - INFO - Processing note adebcca6-5efa-404b-adea-f94acca92861 for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:26,748 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 21:12:26,748 - app.services.document_processing - INFO - Created 9 line-based chunks
2025-04-02 21:12:26,748 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 21:12:26,748 - app.services.document_processing - INFO - Total document chunks created: 23
2025-04-02 21:12:26,750 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 21:12:26,750 - app.services.document_processing - INFO - Chunk 1: Professor Sunday Out Ita 	 					March 26, 2025
Department of Physiology
Faculty of Basic Medical Sci...
2025-04-02 21:12:26,751 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 21:12:26,751 - app.services.document_processing - INFO - Chunk 2: I am pleased to inform you that you have been selected to serve on a three-man Committee to manage t...
2025-04-02 21:12:26,754 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 21:12:26,754 - app.services.document_processing - INFO - Chunk 3: . Your appointment is based on your dedication and trustworthiness as a committed Club Member, and w...
2025-04-02 21:12:26,783 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:12:26,791 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 21:12:26,791 - app.services.rag_service - INFO - Initializing retriever with new documents...
2025-04-02 21:12:26,792 - app - INFO - Initializing vector store...
2025-04-02 21:12:26,792 - app - INFO - Initializing vector store...
2025-04-02 21:12:26,792 - app - INFO - Loading existing vector store
2025-04-02 21:12:26,792 - app - INFO - Loading existing vector store
2025-04-02 21:12:26,805 - app - INFO -  Successfully loaded existing vector store
2025-04-02 21:12:26,805 - app - INFO -  Successfully loaded existing vector store
2025-04-02 21:12:26,806 - app.services.rag_service - INFO -  Retriever initialized successfully
2025-04-02 21:12:26,806 - app.services.rag_service - INFO -  Retriever initialized successfully
2025-04-02 21:12:26,807 - app.services.rag_service - INFO -  Note adebcca6-5efa-404b-adea-f94acca92861 processed and added to retriever
2025-04-02 21:12:26,807 - app.services.rag_service - INFO -  Note adebcca6-5efa-404b-adea-f94acca92861 processed and added to retriever
2025-04-02 21:12:26,809 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:12:27,134 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:12:27,485 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:12:53,400 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:12:53,402 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:12:53,402 - sqlalchemy.engine.Engine - INFO - [cached since 38.55s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:12:53,408 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:53,408 - sqlalchemy.engine.Engine - INFO - [cached since 39.06s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:53,412 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:53,412 - sqlalchemy.engine.Engine - INFO - [cached since 39.06s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:53,419 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.upload_date AS notes_upload_date, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM notes LEFT OUTER JOIN users AS users_1 ON users_1.id = notes.user_id 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:12:53,420 - sqlalchemy.engine.Engine - INFO - [cached since 39.05s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:53,424 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:12:53,425 - sqlalchemy.engine.Engine - INFO - [cached since 39.05s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:12:53,428 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:53,428 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:53,428 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is Prof Ita
2025-04-02 21:12:53,428 - app.services.rag_service - INFO - Processing query for user 692d28f2-d213-4a40-85f9-7cf09264cd3a: who is Prof Ita
2025-04-02 21:12:53,434 - app - ERROR -  Vector store not initialized
2025-04-02 21:12:53,434 - app - ERROR -  Vector store not initialized
2025-04-02 21:12:53,440 - app - ERROR -  Vector store not initialized
2025-04-02 21:12:53,440 - app - ERROR -  Vector store not initialized
2025-04-02 21:12:53,440 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 21:12:53,440 - app.services.rag_service - WARNING - No documents found for user
2025-04-02 21:12:53,443 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 21:12:53,444 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] (UUID('6c9d53df-a476-439c-97b9-9f8d876b93fe'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'who is Prof Ita', "I couldn't find any relevant information in your notes.", datetime.datetime(2025, 4, 2, 21, 12, 53, 443451, tzinfo=datetime.timezone.utc))
2025-04-02 21:12:53,447 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:12:53,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:12:53,456 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-02 21:12:53,457 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] (UUID('6c9d53df-a476-439c-97b9-9f8d876b93fe'),)
2025-04-02 21:12:53,465 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:53,465 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:12:53,465 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:12:53,516 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:19,572 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:19,727 - app.main - INFO - Shutting down application
2025-04-02 21:14:19,727 - app.main - INFO - Shutting down application
2025-04-02 21:14:19,737 - app.main - INFO - Database connections closed successfully
2025-04-02 21:14:19,737 - app.main - INFO - Database connections closed successfully
2025-04-02 21:14:19,745 - app.main - INFO - Vector store closed successfully
2025-04-02 21:14:19,745 - app.main - INFO - Vector store closed successfully
2025-04-02 21:14:20,162 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:20,513 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:22,574 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:14:22,929 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:33,131 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:33,536 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:34,940 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:14:35,291 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:35,643 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:14:46,120 - app.main - INFO - Starting up application
2025-04-02 21:14:46,120 - app.main - INFO - Starting up application
2025-04-02 21:14:46,176 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:14:46,176 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:14:46,180 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:14:46,180 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:14:46,183 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:14:46,184 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:14:46,185 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:14:46,190 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:14:46,190 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:14:46,193 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:14:46,194 - sqlalchemy.engine.Engine - INFO - [cached since 0.004092s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:14:46,195 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:14:46,195 - sqlalchemy.engine.Engine - INFO - [cached since 0.005688s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:14:46,197 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:14:46,198 - app.main - INFO - Database tables created successfully
2025-04-02 21:14:46,198 - app.main - INFO - Database tables created successfully
2025-04-02 21:14:46,520 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:18:22,906 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:18:23,097 - app.main - INFO - Shutting down application
2025-04-02 21:18:23,097 - app.main - INFO - Shutting down application
2025-04-02 21:18:23,103 - app.main - INFO - Database connections closed successfully
2025-04-02 21:18:23,103 - app.main - INFO - Database connections closed successfully
2025-04-02 21:18:23,142 - app.main - INFO - Vector store closed successfully
2025-04-02 21:18:23,142 - app.main - INFO - Vector store closed successfully
2025-04-02 21:18:23,579 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:18:25,906 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:18:26,258 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:18:26,609 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:18:41,186 - app.main - INFO - Starting up application
2025-04-02 21:18:41,186 - app.main - INFO - Starting up application
2025-04-02 21:18:41,245 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:18:41,246 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:18:41,249 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:18:41,250 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:18:41,251 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:18:41,254 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:18:41,255 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:18:41,258 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:18:41,263 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:18:41,264 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:18:41,268 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:18:41,269 - sqlalchemy.engine.Engine - INFO - [cached since 0.005623s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:18:41,271 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:18:41,272 - sqlalchemy.engine.Engine - INFO - [cached since 0.008591s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:18:41,274 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:18:41,275 - app.main - INFO - Database tables created successfully
2025-04-02 21:18:41,275 - app.main - INFO - Database tables created successfully
2025-04-02 21:22:23,229 - watchfiles.main - INFO - 4 changes detected
2025-04-02 21:22:23,362 - app.main - INFO - Shutting down application
2025-04-02 21:22:23,362 - app.main - INFO - Shutting down application
2025-04-02 21:22:23,369 - app.main - INFO - Database connections closed successfully
2025-04-02 21:22:23,369 - app.main - INFO - Database connections closed successfully
2025-04-02 21:22:23,397 - app.main - INFO - Vector store closed successfully
2025-04-02 21:22:23,397 - app.main - INFO - Vector store closed successfully
2025-04-02 21:22:23,799 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:25,691 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:26,088 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:26,439 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:33,560 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:22:33,963 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:36,264 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:36,651 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:43,219 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:22:43,602 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:45,950 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:46,323 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:46,686 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:56,201 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:22:56,595 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:58,909 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:59,277 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:22:59,628 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:23:08,553 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:08,935 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:10,088 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:23:10,441 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:12,161 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:12,534 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:13,990 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:23:14,341 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:14,692 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:15,194 - watchfiles.main - INFO - 5 changes detected
2025-04-02 21:23:15,545 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:23,026 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:23,379 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:35,047 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:23:35,400 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:23:36,253 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:23:36,604 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:08,660 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:09,015 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:09,366 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:18,909 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:19,265 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:19,616 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:21,574 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:31:21,925 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:31,201 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:31,581 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:34,265 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:31:34,616 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:37,574 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:37,926 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:39,681 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:31:40,032 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:31:40,383 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:32:13,624 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:32:13,976 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:32:16,955 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:32:17,306 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:32:17,657 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:32:21,187 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:32:21,539 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:32:23,320 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:32:23,673 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:32:26,339 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:32:26,691 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:32:27,545 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:32:27,896 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:35,519 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:35,882 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:37,352 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:37,713 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:39,769 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:33:40,122 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:40,475 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:50,905 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:51,258 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:51,609 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:51,960 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:33:52,673 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:53,037 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:53,388 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:53,890 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:33:54,492 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:54,862 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:55,721 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:33:56,072 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:33:56,423 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:35:07,633 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:35:07,987 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:35:10,028 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:35:10,402 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:35:56,058 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:35:56,414 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:35:57,919 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:35:58,275 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:35:58,629 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:36:01,186 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:36:01,538 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:36:02,692 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:36:03,043 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:36:03,394 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:02,741 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:03,094 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:03,444 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:03,946 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:38:05,151 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:05,523 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:06,676 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:38:07,027 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:07,379 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:18,704 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:19,067 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:19,418 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:38:21,186 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:38:21,552 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:39:01,792 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:39:02,151 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:39:02,502 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:39:05,764 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:39:06,115 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:39:06,466 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:39:29,533 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:39:29,885 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:40:13,745 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:40:14,100 - watchfiles.main - INFO - 3 changes detected
2025-04-02 21:40:14,452 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:40:17,616 - app.main - INFO - Starting up application
2025-04-02 21:40:17,616 - app.main - INFO - Starting up application
2025-04-02 21:40:17,672 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:40:17,683 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:40:17,683 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:40:17,687 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:40:17,687 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:40:17,689 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:40:17,690 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:40:17,692 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:40:17,699 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:40:17,700 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:40:17,704 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:40:17,705 - sqlalchemy.engine.Engine - INFO - [cached since 0.005669s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:40:17,706 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:40:17,707 - sqlalchemy.engine.Engine - INFO - [cached since 0.007533s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:40:17,708 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:40:17,709 - sqlalchemy.engine.Engine - INFO - [cached since 0.00962s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:40:17,710 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:40:17,711 - sqlalchemy.engine.Engine - INFO - [cached since 0.01158s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:40:17,714 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE document_chunks (
	id UUID NOT NULL, 
	document_id UUID NOT NULL, 
	content TEXT NOT NULL, 
	chunk_type VARCHAR NOT NULL, 
	chunk_metadata JSONB, 
	created_at TIMESTAMP WITH TIME ZONE, 
	updated_at TIMESTAMP WITH TIME ZONE, 
	PRIMARY KEY (id), 
	FOREIGN KEY(document_id) REFERENCES notes (id) ON DELETE CASCADE
)


2025-04-02 21:40:17,714 - sqlalchemy.engine.Engine - INFO - [no key 0.00044s] ()
2025-04-02 21:40:17,860 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE document_embeddings (
	id UUID NOT NULL, 
	chunk_id UUID NOT NULL, 
	embedding VARCHAR NOT NULL, 
	created_at TIMESTAMP WITH TIME ZONE, 
	updated_at TIMESTAMP WITH TIME ZONE, 
	PRIMARY KEY (id), 
	FOREIGN KEY(chunk_id) REFERENCES document_chunks (id) ON DELETE CASCADE
)


2025-04-02 21:40:17,861 - sqlalchemy.engine.Engine - INFO - [no key 0.00051s] ()
2025-04-02 21:40:17,886 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:40:17,896 - app.main - INFO - Database tables created successfully
2025-04-02 21:40:17,896 - app.main - INFO - Database tables created successfully
2025-04-02 21:41:02,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:41:02,723 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:41:02,725 - app.main - ERROR - Unhandled exception during request processing: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 52, in login
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1655, in do_init
    self._process_dependent_arguments()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1696, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/clsregistry.py", line 368, in __getattr__
    raise AttributeError(
AttributeError: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
2025-04-02 21:41:02,725 - app.main - ERROR - Unhandled exception during request processing: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 52, in login
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1655, in do_init
    self._process_dependent_arguments()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1696, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/clsregistry.py", line 368, in __getattr__
    raise AttributeError(
AttributeError: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
2025-04-02 21:41:02,809 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:41:07,841 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:41:07,843 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:41:07,844 - app.main - ERROR - Unhandled exception during request processing: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 52, in login
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
2025-04-02 21:41:07,844 - app.main - ERROR - Unhandled exception during request processing: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 52, in login
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
2025-04-02 21:41:07,925 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:41:38,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:41:38,653 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:41:38,654 - app.main - ERROR - Unhandled exception during request processing: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
2025-04-02 21:41:38,654 - app.main - ERROR - Unhandled exception during request processing: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/base.py", line 686, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2630, in to_compile_state
    _MapperEntity(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 2710, in __init__
    entity._post_inspect
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Class <class 'app.models.note.Note'> does not have a mapped column named 'upload_date'
2025-04-02 21:41:38,937 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:43:44,669 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:43:44,792 - app.main - INFO - Shutting down application
2025-04-02 21:43:44,792 - app.main - INFO - Shutting down application
2025-04-02 21:43:44,799 - app.main - INFO - Database connections closed successfully
2025-04-02 21:43:44,799 - app.main - INFO - Database connections closed successfully
2025-04-02 21:43:45,173 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:43:45,525 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:43:46,177 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:43:46,528 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:43:48,244 - app.main - INFO - Starting up application
2025-04-02 21:43:48,244 - app.main - INFO - Starting up application
2025-04-02 21:43:48,332 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:43:48,333 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:43:48,337 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:43:48,337 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:43:48,340 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:43:48,341 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:43:48,346 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:43:48,353 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:43:48,355 - sqlalchemy.engine.Engine - INFO - [generated in 0.00150s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:43:48,363 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:43:48,364 - sqlalchemy.engine.Engine - INFO - [cached since 0.01048s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:43:48,366 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:43:48,367 - sqlalchemy.engine.Engine - INFO - [cached since 0.01348s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:43:48,371 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:43:48,371 - sqlalchemy.engine.Engine - INFO - [cached since 0.01815s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:43:48,373 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:43:48,375 - sqlalchemy.engine.Engine - INFO - [cached since 0.02169s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:43:48,379 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:43:48,381 - app.main - INFO - Database tables created successfully
2025-04-02 21:43:48,381 - app.main - INFO - Database tables created successfully
2025-04-02 21:43:48,591 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:44:10,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:44:10,215 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:44:10,216 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:44:10,227 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:44:10,227 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:44:10,238 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC
2025-04-02 21:44:10,239 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:44:10,246 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:44:10,249 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:44:10,249 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:44:10,555 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:44:59,292 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:44:59,472 - app.main - INFO - Shutting down application
2025-04-02 21:44:59,472 - app.main - INFO - Shutting down application
2025-04-02 21:44:59,477 - app.main - INFO - Database connections closed successfully
2025-04-02 21:44:59,477 - app.main - INFO - Database connections closed successfully
2025-04-02 21:44:59,862 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:45:02,305 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:45:02,680 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:45:07,205 - app.main - INFO - Starting up application
2025-04-02 21:45:07,205 - app.main - INFO - Starting up application
2025-04-02 21:45:07,287 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:45:07,287 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:45:07,295 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:45:07,297 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:45:07,301 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:45:07,301 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:45:07,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:45:07,317 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:45:07,317 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:45:07,322 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:45:07,323 - sqlalchemy.engine.Engine - INFO - [cached since 0.006229s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:45:07,325 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:45:07,326 - sqlalchemy.engine.Engine - INFO - [cached since 0.009092s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:45:07,328 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:45:07,330 - sqlalchemy.engine.Engine - INFO - [cached since 0.01319s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:45:07,333 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:45:07,336 - sqlalchemy.engine.Engine - INFO - [cached since 0.0196s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:45:07,340 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:45:07,343 - app.main - INFO - Database tables created successfully
2025-04-02 21:45:07,343 - app.main - INFO - Database tables created successfully
2025-04-02 21:45:07,444 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:46:24,126 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:46:24,242 - app.main - INFO - Shutting down application
2025-04-02 21:46:24,242 - app.main - INFO - Shutting down application
2025-04-02 21:46:24,248 - app.main - INFO - Database connections closed successfully
2025-04-02 21:46:24,248 - app.main - INFO - Database connections closed successfully
2025-04-02 21:46:24,624 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:46:27,436 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:46:27,787 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:46:28,647 - app.main - INFO - Starting up application
2025-04-02 21:46:28,647 - app.main - INFO - Starting up application
2025-04-02 21:46:28,705 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:46:28,706 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:46:28,709 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:46:28,709 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:46:28,711 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:46:28,712 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:46:28,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:46:28,718 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:46:28,718 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:46:28,722 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:46:28,722 - sqlalchemy.engine.Engine - INFO - [cached since 0.004057s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:46:28,724 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:46:28,724 - sqlalchemy.engine.Engine - INFO - [cached since 0.006395s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:46:28,726 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:46:28,726 - sqlalchemy.engine.Engine - INFO - [cached since 0.008508s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:46:28,728 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:46:28,729 - sqlalchemy.engine.Engine - INFO - [cached since 0.01053s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:46:28,731 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:46:28,732 - app.main - INFO - Database tables created successfully
2025-04-02 21:46:28,732 - app.main - INFO - Database tables created successfully
2025-04-02 21:46:28,941 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:46:45,757 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:46:45,783 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:46:45,784 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:46:45,794 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:46:45,794 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:46:45,801 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC
2025-04-02 21:46:45,801 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:46:45,804 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:46:45,807 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:46:45,807 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:46:46,087 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:46:46,439 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:47:36,023 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:47:36,224 - app.main - INFO - Shutting down application
2025-04-02 21:47:36,224 - app.main - INFO - Shutting down application
2025-04-02 21:47:36,230 - app.main - INFO - Database connections closed successfully
2025-04-02 21:47:36,230 - app.main - INFO - Database connections closed successfully
2025-04-02 21:47:36,625 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:47:37,528 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:47:37,879 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:47:39,981 - app.main - INFO - Starting up application
2025-04-02 21:47:39,981 - app.main - INFO - Starting up application
2025-04-02 21:47:40,044 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:47:40,044 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:47:40,047 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:47:40,048 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:47:40,050 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:47:40,050 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:47:40,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:47:40,058 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:47:40,058 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:47:40,062 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:47:40,063 - sqlalchemy.engine.Engine - INFO - [cached since 0.005051s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:47:40,064 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:47:40,065 - sqlalchemy.engine.Engine - INFO - [cached since 0.007111s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:47:40,066 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:47:40,067 - sqlalchemy.engine.Engine - INFO - [cached since 0.009175s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:47:40,068 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:47:40,068 - sqlalchemy.engine.Engine - INFO - [cached since 0.01096s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:47:40,070 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:47:40,071 - app.main - INFO - Database tables created successfully
2025-04-02 21:47:40,071 - app.main - INFO - Database tables created successfully
2025-04-02 21:47:40,237 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:48:06,912 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:48:07,040 - app.main - INFO - Shutting down application
2025-04-02 21:48:07,040 - app.main - INFO - Shutting down application
2025-04-02 21:48:07,045 - app.main - INFO - Database connections closed successfully
2025-04-02 21:48:07,045 - app.main - INFO - Database connections closed successfully
2025-04-02 21:48:07,411 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:48:08,214 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:48:08,565 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:48:10,034 - app.main - INFO - Starting up application
2025-04-02 21:48:10,034 - app.main - INFO - Starting up application
2025-04-02 21:48:10,113 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:48:10,113 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:48:10,117 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:48:10,118 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:48:10,189 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:48:10,189 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:48:10,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:48:10,212 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:48:10,212 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:48:10,218 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:48:10,218 - sqlalchemy.engine.Engine - INFO - [cached since 0.006922s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:48:10,220 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:48:10,221 - sqlalchemy.engine.Engine - INFO - [cached since 0.009477s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:48:10,223 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:48:10,223 - sqlalchemy.engine.Engine - INFO - [cached since 0.01223s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:48:10,231 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:48:10,234 - sqlalchemy.engine.Engine - INFO - [cached since 0.02267s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:48:10,236 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:48:10,237 - app.main - INFO - Database tables created successfully
2025-04-02 21:48:10,237 - app.main - INFO - Database tables created successfully
2025-04-02 21:48:10,319 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:48:16,815 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:48:16,848 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:48:16,848 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:48:16,864 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:48:16,865 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:48:16,874 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC
2025-04-02 21:48:16,874 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:48:16,883 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:48:16,886 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:48:16,886 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:48:16,937 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:49:20,831 - __main__ - INFO - Starting development server
2025-04-02 21:49:23,897 - app.main - INFO - Starting up application
2025-04-02 21:49:23,897 - app.main - INFO - Starting up application
2025-04-02 21:49:24,193 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:49:24,198 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:49:24,198 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:49:24,201 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:49:24,201 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:49:24,204 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:49:24,204 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:49:24,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:49:24,210 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:49:24,210 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:49:24,217 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:49:24,218 - sqlalchemy.engine.Engine - INFO - [cached since 0.008055s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:49:24,219 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:49:24,219 - sqlalchemy.engine.Engine - INFO - [cached since 0.009447s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:49:24,221 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:49:24,221 - sqlalchemy.engine.Engine - INFO - [cached since 0.01159s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:49:24,222 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:49:24,223 - sqlalchemy.engine.Engine - INFO - [cached since 0.01324s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:49:24,224 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:49:24,225 - app.main - INFO - Database tables created successfully
2025-04-02 21:49:24,225 - app.main - INFO - Database tables created successfully
2025-04-02 21:49:24,545 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:49:28,248 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:49:28,280 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:49:28,281 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:49:28,297 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:49:28,297 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:49:28,308 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC
2025-04-02 21:49:28,308 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:49:28,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:49:28,313 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:49:28,313 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.title does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.title AS notes_title, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:49:28,415 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:37,978 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:38,134 - app.main - INFO - Shutting down application
2025-04-02 21:50:38,134 - app.main - INFO - Shutting down application
2025-04-02 21:50:38,143 - app.main - INFO - Database connections closed successfully
2025-04-02 21:50:38,143 - app.main - INFO - Database connections closed successfully
2025-04-02 21:50:38,515 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:50:41,310 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:50:41,661 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:42,552 - app.main - INFO - Starting up application
2025-04-02 21:50:42,552 - app.main - INFO - Starting up application
2025-04-02 21:50:42,612 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:50:42,612 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:50:42,615 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:50:42,616 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:50:42,618 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:50:42,618 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:50:42,620 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:50:42,625 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:42,625 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:42,629 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:42,629 - sqlalchemy.engine.Engine - INFO - [cached since 0.004272s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:42,636 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:42,637 - sqlalchemy.engine.Engine - INFO - [cached since 0.01207s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:42,639 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:42,640 - sqlalchemy.engine.Engine - INFO - [cached since 0.01522s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:42,642 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:42,643 - sqlalchemy.engine.Engine - INFO - [cached since 0.01799s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:42,644 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:50:42,646 - app.main - INFO - Database tables created successfully
2025-04-02 21:50:42,646 - app.main - INFO - Database tables created successfully
2025-04-02 21:50:42,814 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:45,224 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:45,358 - app.main - INFO - Shutting down application
2025-04-02 21:50:45,358 - app.main - INFO - Shutting down application
2025-04-02 21:50:45,372 - app.main - INFO - Database connections closed successfully
2025-04-02 21:50:45,372 - app.main - INFO - Database connections closed successfully
2025-04-02 21:50:45,747 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:46,700 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:50:47,051 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:47,401 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:50:48,679 - app.main - INFO - Starting up application
2025-04-02 21:50:48,679 - app.main - INFO - Starting up application
2025-04-02 21:50:48,737 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:50:48,737 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:50:48,740 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:50:48,740 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:50:48,742 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:50:48,743 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:50:48,745 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:50:48,751 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:48,751 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:48,755 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:48,755 - sqlalchemy.engine.Engine - INFO - [cached since 0.00476s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:48,757 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:48,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.007041s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:48,760 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:48,760 - sqlalchemy.engine.Engine - INFO - [cached since 0.009741s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:48,762 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:50:48,762 - sqlalchemy.engine.Engine - INFO - [cached since 0.01145s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:50:48,764 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:50:48,765 - app.main - INFO - Database tables created successfully
2025-04-02 21:50:48,765 - app.main - INFO - Database tables created successfully
2025-04-02 21:50:48,807 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:51:00,868 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:51:01,018 - app.main - INFO - Shutting down application
2025-04-02 21:51:01,018 - app.main - INFO - Shutting down application
2025-04-02 21:51:01,022 - app.main - INFO - Database connections closed successfully
2025-04-02 21:51:01,022 - app.main - INFO - Database connections closed successfully
2025-04-02 21:51:01,387 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:51:02,089 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:51:02,440 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:51:03,909 - app.main - INFO - Starting up application
2025-04-02 21:51:03,909 - app.main - INFO - Starting up application
2025-04-02 21:51:03,966 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:51:03,966 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:51:03,970 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:51:03,970 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:51:03,972 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:51:03,972 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:51:03,975 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:51:03,980 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:51:03,980 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:51:03,983 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:51:03,984 - sqlalchemy.engine.Engine - INFO - [cached since 0.004171s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:51:03,985 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:51:03,985 - sqlalchemy.engine.Engine - INFO - [cached since 0.00551s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:51:03,987 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:51:03,987 - sqlalchemy.engine.Engine - INFO - [cached since 0.007956s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:51:03,990 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:51:03,990 - sqlalchemy.engine.Engine - INFO - [cached since 0.01064s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:51:03,991 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:51:03,993 - app.main - INFO - Database tables created successfully
2025-04-02 21:51:03,993 - app.main - INFO - Database tables created successfully
2025-04-02 21:51:04,195 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:51:04,546 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:51:12,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:51:12,628 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:51:12,629 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:51:12,639 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:51:12,639 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:51:12,647 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC
2025-04-02 21:51:12,647 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:51:12,649 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:51:12,651 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.content does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.content does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.content does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.content does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:51:12,651 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.content does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.content does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.content does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.content does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.content AS notes_content, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:51:12,940 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:39,992 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:40,178 - app.main - INFO - Shutting down application
2025-04-02 21:52:40,178 - app.main - INFO - Shutting down application
2025-04-02 21:52:40,183 - app.main - INFO - Database connections closed successfully
2025-04-02 21:52:40,183 - app.main - INFO - Database connections closed successfully
2025-04-02 21:52:40,560 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:42,718 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:52:43,069 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:43,419 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:43,748 - app.main - INFO - Starting up application
2025-04-02 21:52:43,748 - app.main - INFO - Starting up application
2025-04-02 21:52:43,814 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:52:43,814 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:52:43,817 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:52:43,818 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:52:43,820 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:52:43,820 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:52:43,822 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:52:43,827 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:43,827 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:43,832 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:43,833 - sqlalchemy.engine.Engine - INFO - [cached since 0.006011s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:43,835 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:43,835 - sqlalchemy.engine.Engine - INFO - [cached since 0.008061s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:43,836 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:43,837 - sqlalchemy.engine.Engine - INFO - [cached since 0.009821s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:43,838 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:43,839 - sqlalchemy.engine.Engine - INFO - [cached since 0.01172s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:43,840 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:52:43,842 - app.main - INFO - Database tables created successfully
2025-04-02 21:52:43,842 - app.main - INFO - Database tables created successfully
2025-04-02 21:52:47,535 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:47,659 - app.main - INFO - Shutting down application
2025-04-02 21:52:47,659 - app.main - INFO - Shutting down application
2025-04-02 21:52:47,663 - app.main - INFO - Database connections closed successfully
2025-04-02 21:52:47,663 - app.main - INFO - Database connections closed successfully
2025-04-02 21:52:48,033 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:48,384 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:49,035 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:52:49,386 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:50,913 - app.main - INFO - Starting up application
2025-04-02 21:52:50,913 - app.main - INFO - Starting up application
2025-04-02 21:52:50,972 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:52:50,973 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:52:50,976 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:52:50,977 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:52:50,979 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:52:50,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:52:50,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:52:50,986 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:50,987 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:50,990 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:50,991 - sqlalchemy.engine.Engine - INFO - [cached since 0.004599s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:50,992 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:50,993 - sqlalchemy.engine.Engine - INFO - [cached since 0.006753s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:50,995 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:50,995 - sqlalchemy.engine.Engine - INFO - [cached since 0.008765s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:50,997 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:52:50,997 - sqlalchemy.engine.Engine - INFO - [cached since 0.01104s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:52:50,999 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:52:51,000 - app.main - INFO - Database tables created successfully
2025-04-02 21:52:51,000 - app.main - INFO - Database tables created successfully
2025-04-02 21:52:51,152 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:52:51,503 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:53:03,516 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:53:03,652 - app.main - INFO - Shutting down application
2025-04-02 21:53:03,652 - app.main - INFO - Shutting down application
2025-04-02 21:53:03,656 - app.main - INFO - Database connections closed successfully
2025-04-02 21:53:03,656 - app.main - INFO - Database connections closed successfully
2025-04-02 21:53:04,026 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:53:04,377 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:53:04,979 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:53:05,581 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:53:05,932 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:53:06,763 - app.main - INFO - Starting up application
2025-04-02 21:53:06,763 - app.main - INFO - Starting up application
2025-04-02 21:53:06,822 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:53:06,823 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:53:06,827 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:53:06,828 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:53:06,831 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:53:06,831 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:53:06,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:53:06,840 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:53:06,841 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:53:06,847 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:53:06,847 - sqlalchemy.engine.Engine - INFO - [cached since 0.007803s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:53:06,849 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:53:06,850 - sqlalchemy.engine.Engine - INFO - [cached since 0.01006s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:53:06,851 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:53:06,852 - sqlalchemy.engine.Engine - INFO - [cached since 0.0121s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:53:06,854 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:53:06,854 - sqlalchemy.engine.Engine - INFO - [cached since 0.01487s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:53:06,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:53:06,858 - app.main - INFO - Database tables created successfully
2025-04-02 21:53:06,858 - app.main - INFO - Database tables created successfully
2025-04-02 21:53:07,085 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:53:07,437 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:53:10,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:53:10,832 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:53:10,832 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:53:10,844 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:53:10,844 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:53:10,855 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC
2025-04-02 21:53:10,856 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:53:10,861 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:53:10,863 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:53:10,863 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.file_path does not exist
HINT:  Perhaps you meant to reference the column "notes.file_name".
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_path AS notes_file_path, notes.file_type AS notes_file_type, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:53:11,013 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:53:11,365 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:54:51,071 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:54:51,222 - app.main - INFO - Shutting down application
2025-04-02 21:54:51,222 - app.main - INFO - Shutting down application
2025-04-02 21:54:51,228 - app.main - INFO - Database connections closed successfully
2025-04-02 21:54:51,228 - app.main - INFO - Database connections closed successfully
2025-04-02 21:54:51,608 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:54:53,773 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:54:54,124 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:54:54,475 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:54:54,803 - app.main - INFO - Starting up application
2025-04-02 21:54:54,803 - app.main - INFO - Starting up application
2025-04-02 21:54:54,861 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:54:54,862 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:54:54,864 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:54:54,865 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:54:54,867 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:54:54,867 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:54:54,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:54:54,874 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:54:54,875 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:54:54,878 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:54:54,879 - sqlalchemy.engine.Engine - INFO - [cached since 0.004611s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:54:54,880 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:54:54,880 - sqlalchemy.engine.Engine - INFO - [cached since 0.00628s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:54:54,882 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:54:54,882 - sqlalchemy.engine.Engine - INFO - [cached since 0.008106s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:54:54,884 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:54:54,884 - sqlalchemy.engine.Engine - INFO - [cached since 0.009935s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:54:54,885 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:54:54,886 - app.main - INFO - Database tables created successfully
2025-04-02 21:54:54,886 - app.main - INFO - Database tables created successfully
2025-04-02 21:55:16,360 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:55:16,494 - app.main - INFO - Shutting down application
2025-04-02 21:55:16,494 - app.main - INFO - Shutting down application
2025-04-02 21:55:16,508 - app.main - INFO - Database connections closed successfully
2025-04-02 21:55:16,508 - app.main - INFO - Database connections closed successfully
2025-04-02 21:55:16,898 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:55:18,503 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:55:18,854 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:55:19,542 - app.main - INFO - Starting up application
2025-04-02 21:55:19,542 - app.main - INFO - Starting up application
2025-04-02 21:55:19,606 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:55:19,606 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:55:19,610 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:55:19,611 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:55:19,616 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:55:19,616 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:55:19,621 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:55:19,629 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:55:19,629 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:55:19,633 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:55:19,633 - sqlalchemy.engine.Engine - INFO - [cached since 0.004451s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:55:19,636 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:55:19,637 - sqlalchemy.engine.Engine - INFO - [cached since 0.007838s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:55:19,638 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:55:19,638 - sqlalchemy.engine.Engine - INFO - [cached since 0.009611s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:55:19,640 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:55:19,640 - sqlalchemy.engine.Engine - INFO - [cached since 0.01156s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:55:19,642 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:55:19,643 - app.main - INFO - Database tables created successfully
2025-04-02 21:55:19,643 - app.main - INFO - Database tables created successfully
2025-04-02 21:55:19,707 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:55:24,280 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:55:24,322 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:55:24,322 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:55:24,333 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:55:24,333 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:55:24,342 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC
2025-04-02 21:55:24,342 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:55:24,347 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:55:24,349 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.created_at does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.created_at does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.created_at does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.created_at does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:55:24,349 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.created_at does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column notes.created_at does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.created_at does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/auth.py", line 26, in register
    result = await db.execute(query)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 309, in orm_execute_statement
    return cls.orm_setup_cursor_result(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 616, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 261, in instances
    _prebuffered = list(chunks(None))
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 246, in chunks
    post_load.invoke(context, path)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1560, in invoke
    loader(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3341, in _load_for_path
    self._load_via_parent(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/strategies.py", line 3417, in _load_via_parent
    context.session.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column notes.created_at does not exist
[SQL: SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.created_at AS notes_created_at, notes.updated_at AS notes_updated_at 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.created_at DESC]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-02 21:55:24,534 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:56:51,251 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:56:51,362 - app.main - INFO - Shutting down application
2025-04-02 21:56:51,362 - app.main - INFO - Shutting down application
2025-04-02 21:56:51,367 - app.main - INFO - Database connections closed successfully
2025-04-02 21:56:51,367 - app.main - INFO - Database connections closed successfully
2025-04-02 21:56:51,757 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:56:53,668 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:56:54,033 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:56:54,384 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:56:54,810 - app.main - INFO - Starting up application
2025-04-02 21:56:54,810 - app.main - INFO - Starting up application
2025-04-02 21:56:54,866 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:56:54,866 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:56:54,869 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:56:54,869 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:56:54,871 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:56:54,871 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:56:54,873 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:56:54,879 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:56:54,879 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:56:54,883 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:56:54,883 - sqlalchemy.engine.Engine - INFO - [cached since 0.004338s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:56:54,884 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:56:54,885 - sqlalchemy.engine.Engine - INFO - [cached since 0.00589s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:56:54,886 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:56:54,886 - sqlalchemy.engine.Engine - INFO - [cached since 0.007505s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:56:54,887 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:56:54,888 - sqlalchemy.engine.Engine - INFO - [cached since 0.009201s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:56:54,889 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:56:54,890 - app.main - INFO - Database tables created successfully
2025-04-02 21:56:54,890 - app.main - INFO - Database tables created successfully
2025-04-02 21:57:00,311 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:57:00,510 - app.main - INFO - Shutting down application
2025-04-02 21:57:00,510 - app.main - INFO - Shutting down application
2025-04-02 21:57:00,515 - app.main - INFO - Database connections closed successfully
2025-04-02 21:57:00,515 - app.main - INFO - Database connections closed successfully
2025-04-02 21:57:00,890 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:01,793 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:57:02,144 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:02,494 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:02,846 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:57:03,861 - app.main - INFO - Starting up application
2025-04-02 21:57:03,861 - app.main - INFO - Starting up application
2025-04-02 21:57:03,918 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:57:03,919 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:57:03,922 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:57:03,922 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:57:03,925 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:57:03,926 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:57:03,928 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:57:03,933 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:57:03,933 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:57:03,936 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:57:03,937 - sqlalchemy.engine.Engine - INFO - [cached since 0.004007s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:57:03,938 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:57:03,938 - sqlalchemy.engine.Engine - INFO - [cached since 0.005316s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:57:03,941 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:57:03,941 - sqlalchemy.engine.Engine - INFO - [cached since 0.008218s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:57:03,943 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:57:03,943 - sqlalchemy.engine.Engine - INFO - [cached since 0.01031s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:57:03,945 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:57:03,946 - app.main - INFO - Database tables created successfully
2025-04-02 21:57:03,946 - app.main - INFO - Database tables created successfully
2025-04-02 21:57:04,202 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:04,553 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:19,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:57:19,839 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:57:19,840 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:57:19,860 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:57:19,861 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:19,871 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:19,871 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:19,881 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:19,882 - sqlalchemy.engine.Engine - INFO - [generated in 0.00181s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:19,885 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:57:19,885 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:35,602 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:57:35,603 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-02 21:57:35,604 - sqlalchemy.engine.Engine - INFO - [cached since 15.76s ago] ('jamiebones2000@yahoo.co.uk',)
2025-04-02 21:57:35,607 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:57:35,608 - sqlalchemy.engine.Engine - INFO - [cached since 15.75s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:35,614 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:35,615 - sqlalchemy.engine.Engine - INFO - [cached since 15.75s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:35,623 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:35,624 - sqlalchemy.engine.Engine - INFO - [cached since 15.74s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:35,628 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-02 21:57:35,983 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:57:36,041 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:36,392 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:38,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:57:38,322 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:57:38,322 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:57:38,327 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:57:38,328 - sqlalchemy.engine.Engine - INFO - [cached since 18.47s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:38,337 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:38,338 - sqlalchemy.engine.Engine - INFO - [cached since 18.47s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:38,351 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:38,351 - sqlalchemy.engine.Engine - INFO - [cached since 18.47s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:38,355 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:57:38,355 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:57:38,361 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 107, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:57:38,361 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 107, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:57:38,367 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:57:38,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:57:38,378 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:57:38,378 - sqlalchemy.engine.Engine - INFO - [cached since 0.05698s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:57:38,387 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:57:38,387 - sqlalchemy.engine.Engine - INFO - [cached since 18.53s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:38,402 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:38,402 - sqlalchemy.engine.Engine - INFO - [cached since 18.53s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:38,420 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:38,420 - sqlalchemy.engine.Engine - INFO - [cached since 18.54s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:38,428 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:57:38,428 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:57:38,428 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 107, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:57:38,428 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 107, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:57:38,440 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:57:38,554 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:57:48,124 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:57:48,125 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:57:48,126 - sqlalchemy.engine.Engine - INFO - [cached since 9.806s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:57:48,129 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:57:48,130 - sqlalchemy.engine.Engine - INFO - [cached since 28.27s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:48,134 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:48,134 - sqlalchemy.engine.Engine - INFO - [cached since 28.27s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:48,137 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:57:48,138 - sqlalchemy.engine.Engine - INFO - [cached since 28.26s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:57:48,161 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:57:48,163 - app.main - ERROR - Unhandled exception during request processing: 'title' is an invalid keyword argument for Note
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 41, in upload_note
    note = Note(
  File "<string>", line 4, in __init__
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(
TypeError: 'title' is an invalid keyword argument for Note
2025-04-02 21:57:48,163 - app.main - ERROR - Unhandled exception during request processing: 'title' is an invalid keyword argument for Note
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 41, in upload_note
    note = Note(
  File "<string>", line 4, in __init__
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(
TypeError: 'title' is an invalid keyword argument for Note
2025-04-02 21:57:48,481 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:58:29,958 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:58:30,144 - app.main - INFO - Shutting down application
2025-04-02 21:58:30,144 - app.main - INFO - Shutting down application
2025-04-02 21:58:30,149 - app.main - INFO - Database connections closed successfully
2025-04-02 21:58:30,149 - app.main - INFO - Database connections closed successfully
2025-04-02 21:58:30,539 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:58:33,596 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:58:33,742 - app.main - INFO - Starting up application
2025-04-02 21:58:33,742 - app.main - INFO - Starting up application
2025-04-02 21:58:33,825 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 21:58:33,825 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:58:33,830 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 21:58:33,830 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:58:33,833 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 21:58:33,833 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 21:58:33,836 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:58:33,845 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:58:33,845 - sqlalchemy.engine.Engine - INFO - [generated in 0.00075s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:58:33,851 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:58:33,851 - sqlalchemy.engine.Engine - INFO - [cached since 0.006786s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:58:33,853 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:58:33,853 - sqlalchemy.engine.Engine - INFO - [cached since 0.008963s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:58:33,855 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:58:33,855 - sqlalchemy.engine.Engine - INFO - [cached since 0.01106s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:58:33,860 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 21:58:33,861 - sqlalchemy.engine.Engine - INFO - [cached since 0.01646s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 21:58:33,865 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:58:33,866 - app.main - INFO - Database tables created successfully
2025-04-02 21:58:33,866 - app.main - INFO - Database tables created successfully
2025-04-02 21:58:33,947 - watchfiles.main - INFO - 1 change detected
2025-04-02 21:59:02,012 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:59:02,032 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:59:02,032 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:59:02,040 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:59:02,041 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:59:02,048 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:59:02,048 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:59:02,053 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:59:02,053 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:59:02,069 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 21:59:02,069 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('a8c11793-286f-497a-9016-aabacd956a20'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 2, 21, 59, 2, 69402, tzinfo=datetime.timezone.utc))
2025-04-02 21:59:02,076 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 21:59:02,079 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:59:02,081 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.user_id, notes.note_text, notes.file_name, notes.upload_date 
FROM notes 
WHERE notes.id = $1::UUID
2025-04-02 21:59:02,082 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] (UUID('a8c11793-286f-497a-9016-aabacd956a20'),)
2025-04-02 21:59:02,084 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:59:02,086 - app.main - ERROR - Unhandled exception during request processing: process_user_note() takes from 3 to 4 positional arguments but 5 were given
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 52, in upload_note
    process_user_note(current_user.id, note.id, note_text, file.filename, db)
TypeError: process_user_note() takes from 3 to 4 positional arguments but 5 were given
2025-04-02 21:59:02,086 - app.main - ERROR - Unhandled exception during request processing: process_user_note() takes from 3 to 4 positional arguments but 5 were given
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 52, in upload_note
    process_user_note(current_user.id, note.id, note_text, file.filename, db)
TypeError: process_user_note() takes from 3 to 4 positional arguments but 5 were given
2025-04-02 21:59:02,181 - watchfiles.main - INFO - 2 changes detected
2025-04-02 21:59:07,600 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 21:59:07,601 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 21:59:07,602 - sqlalchemy.engine.Engine - INFO - [cached since 5.57s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 21:59:07,607 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 21:59:07,608 - sqlalchemy.engine.Engine - INFO - [cached since 5.568s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:59:07,621 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:59:07,621 - sqlalchemy.engine.Engine - INFO - [cached since 5.574s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:59:07,626 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 21:59:07,626 - sqlalchemy.engine.Engine - INFO - [cached since 5.574s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 21:59:07,637 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:59:07,637 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-02 21:59:07,639 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 107, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:59:07,639 - app.api.endpoints.chat - ERROR - Error fetching chat history: 'AsyncSession' object has no attribute 'query'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 107, in get_chat_history
    chats = db.query(Chat).filter(Chat.user_id == current_user.id).order_by(Chat.timestamp.asc()).all()
AttributeError: 'AsyncSession' object has no attribute 'query'
2025-04-02 21:59:07,642 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 21:59:07,900 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:04,155 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:04,306 - app.main - INFO - Shutting down application
2025-04-02 22:00:04,306 - app.main - INFO - Shutting down application
2025-04-02 22:00:04,312 - app.main - INFO - Database connections closed successfully
2025-04-02 22:00:04,312 - app.main - INFO - Database connections closed successfully
2025-04-02 22:00:04,735 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:05,939 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:00:06,290 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:06,641 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:08,042 - app.main - INFO - Starting up application
2025-04-02 22:00:08,042 - app.main - INFO - Starting up application
2025-04-02 22:00:08,104 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:00:08,104 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:00:08,108 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:00:08,108 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:00:08,111 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:00:08,111 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:00:08,113 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:00:08,119 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:00:08,120 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:00:08,124 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:00:08,124 - sqlalchemy.engine.Engine - INFO - [cached since 0.004781s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:00:08,125 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:00:08,126 - sqlalchemy.engine.Engine - INFO - [cached since 0.006679s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:00:08,128 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:00:08,128 - sqlalchemy.engine.Engine - INFO - [cached since 0.009167s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:00:08,130 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:00:08,131 - sqlalchemy.engine.Engine - INFO - [cached since 0.0114s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:00:08,132 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:00:08,134 - app.main - INFO - Database tables created successfully
2025-04-02 22:00:08,134 - app.main - INFO - Database tables created successfully
2025-04-02 22:00:08,345 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:28,059 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:00:28,105 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 22:00:28,106 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 22:00:28,121 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 22:00:28,122 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 22:00:28,140 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 22:00:28,140 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 22:00:28,148 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 22:00:28,149 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 22:00:28,189 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 22:00:28,190 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] (UUID('f130eb0b-c801-414e-a89a-bdee188984e2'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 2, 22, 0, 28, 189785, tzinfo=datetime.timezone.utc))
2025-04-02 22:00:28,197 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:00:28,199 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:28,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:00:28,206 - sqlalchemy.engine.Engine - INFO - SELECT notes.id, notes.user_id, notes.note_text, notes.file_name, notes.upload_date 
FROM notes 
WHERE notes.id = $1::UUID
2025-04-02 22:00:28,211 - sqlalchemy.engine.Engine - INFO - [generated in 0.00460s] (UUID('f130eb0b-c801-414e-a89a-bdee188984e2'),)
2025-04-02 22:00:28,219 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-02 22:00:28,225 - app.main - ERROR - Unhandled exception during request processing: process_user_note() takes from 3 to 4 positional arguments but 5 were given
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 52, in upload_note
    process_user_note(current_user.id, note.id, note_text, file.filename, db)
TypeError: process_user_note() takes from 3 to 4 positional arguments but 5 were given
2025-04-02 22:00:28,225 - app.main - ERROR - Unhandled exception during request processing: process_user_note() takes from 3 to 4 positional arguments but 5 were given
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 52, in upload_note
    process_user_note(current_user.id, note.id, note_text, file.filename, db)
TypeError: process_user_note() takes from 3 to 4 positional arguments but 5 were given
2025-04-02 22:00:28,550 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:59,497 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:00:59,695 - app.main - INFO - Shutting down application
2025-04-02 22:00:59,695 - app.main - INFO - Shutting down application
2025-04-02 22:00:59,700 - app.main - INFO - Database connections closed successfully
2025-04-02 22:00:59,700 - app.main - INFO - Database connections closed successfully
2025-04-02 22:01:00,070 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:01:00,421 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:01:02,527 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:01:02,614 - app.main - INFO - Starting up application
2025-04-02 22:01:02,614 - app.main - INFO - Starting up application
2025-04-02 22:01:02,671 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:01:02,671 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:01:02,675 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:01:02,675 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:01:02,677 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:01:02,678 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:01:02,681 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:01:02,686 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:01:02,686 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:01:02,690 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:01:02,690 - sqlalchemy.engine.Engine - INFO - [cached since 0.004374s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:01:02,691 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:01:02,692 - sqlalchemy.engine.Engine - INFO - [cached since 0.006023s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:01:02,694 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:01:02,694 - sqlalchemy.engine.Engine - INFO - [cached since 0.008433s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:01:02,696 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:01:02,697 - sqlalchemy.engine.Engine - INFO - [cached since 0.01119s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:01:02,698 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:01:02,699 - app.main - INFO - Database tables created successfully
2025-04-02 22:01:02,699 - app.main - INFO - Database tables created successfully
2025-04-02 22:01:02,878 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:03:55,764 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:03:55,873 - app.main - INFO - Shutting down application
2025-04-02 22:03:55,873 - app.main - INFO - Shutting down application
2025-04-02 22:03:55,879 - app.main - INFO - Database connections closed successfully
2025-04-02 22:03:55,879 - app.main - INFO - Database connections closed successfully
2025-04-02 22:03:56,263 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:03:56,614 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:03:57,265 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:03:57,616 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:03:59,574 - app.main - INFO - Starting up application
2025-04-02 22:03:59,574 - app.main - INFO - Starting up application
2025-04-02 22:03:59,655 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:03:59,655 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:03:59,660 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:03:59,661 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:03:59,664 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:03:59,665 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:03:59,669 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:03:59,676 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:03:59,677 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:03:59,682 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:03:59,683 - sqlalchemy.engine.Engine - INFO - [cached since 0.006618s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:03:59,684 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:03:59,684 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:03:59,685 - sqlalchemy.engine.Engine - INFO - [cached since 0.008608s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:03:59,687 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:03:59,687 - sqlalchemy.engine.Engine - INFO - [cached since 0.01132s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:03:59,689 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:03:59,690 - sqlalchemy.engine.Engine - INFO - [cached since 0.0137s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:03:59,692 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:03:59,694 - app.main - INFO - Database tables created successfully
2025-04-02 22:03:59,694 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:03,294 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:03,405 - app.main - INFO - Shutting down application
2025-04-02 22:04:03,405 - app.main - INFO - Shutting down application
2025-04-02 22:04:03,410 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:03,410 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:03,800 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:07,523 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:04:07,788 - app.main - INFO - Starting up application
2025-04-02 22:04:07,788 - app.main - INFO - Starting up application
2025-04-02 22:04:07,874 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:04:07,875 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:07,876 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:07,879 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:04:07,879 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:07,882 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:04:07,883 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:07,890 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:04:07,897 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:07,897 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:07,902 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:07,903 - sqlalchemy.engine.Engine - INFO - [cached since 0.007021s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:07,906 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:07,907 - sqlalchemy.engine.Engine - INFO - [cached since 0.01105s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:07,910 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:07,911 - sqlalchemy.engine.Engine - INFO - [cached since 0.01442s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:07,914 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:07,918 - sqlalchemy.engine.Engine - INFO - [cached since 0.02212s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:07,923 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:04:07,924 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:07,924 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:09,029 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:09,131 - app.main - INFO - Shutting down application
2025-04-02 22:04:09,131 - app.main - INFO - Shutting down application
2025-04-02 22:04:09,135 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:09,135 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:09,510 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:10,514 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:04:10,865 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:12,658 - app.main - INFO - Starting up application
2025-04-02 22:04:12,658 - app.main - INFO - Starting up application
2025-04-02 22:04:12,714 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:04:12,715 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:12,718 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:04:12,718 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:12,721 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:04:12,721 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:12,723 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:04:12,728 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:12,728 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:12,731 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:12,732 - sqlalchemy.engine.Engine - INFO - [cached since 0.003936s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:12,733 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:12,734 - sqlalchemy.engine.Engine - INFO - [cached since 0.005673s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:12,736 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:12,736 - sqlalchemy.engine.Engine - INFO - [cached since 0.008397s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:12,738 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:12,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.01047s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:12,740 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:04:12,741 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:12,741 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:12,920 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:22,259 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:04:22,367 - app.main - INFO - Shutting down application
2025-04-02 22:04:22,367 - app.main - INFO - Shutting down application
2025-04-02 22:04:22,372 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:22,372 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:22,748 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:23,750 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:04:24,101 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:24,454 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:25,558 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:04:25,655 - app.main - INFO - Starting up application
2025-04-02 22:04:25,655 - app.main - INFO - Starting up application
2025-04-02 22:04:25,729 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:04:25,730 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:25,734 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:04:25,735 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:25,737 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:04:25,738 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:25,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:04:25,747 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:25,747 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:25,752 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:25,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.005396s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:25,754 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:25,754 - sqlalchemy.engine.Engine - INFO - [cached since 0.007312s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:25,756 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:25,756 - sqlalchemy.engine.Engine - INFO - [cached since 0.009407s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:25,758 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:25,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.01148s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:25,761 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:04:25,762 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:25,762 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:25,909 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:50,275 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:50,442 - app.main - INFO - Shutting down application
2025-04-02 22:04:50,442 - app.main - INFO - Shutting down application
2025-04-02 22:04:50,446 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:50,446 - app.main - INFO - Database connections closed successfully
2025-04-02 22:04:50,824 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:51,776 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:04:52,127 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:52,480 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:53,807 - app.main - INFO - Starting up application
2025-04-02 22:04:53,807 - app.main - INFO - Starting up application
2025-04-02 22:04:53,880 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:04:53,880 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:53,884 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:04:53,885 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:53,888 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:04:53,889 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:04:53,893 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:04:53,902 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:53,902 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:53,907 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:53,907 - sqlalchemy.engine.Engine - INFO - [cached since 0.005677s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:53,909 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:53,910 - sqlalchemy.engine.Engine - INFO - [cached since 0.008481s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:53,912 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:53,913 - sqlalchemy.engine.Engine - INFO - [cached since 0.01144s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:53,916 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:04:53,916 - sqlalchemy.engine.Engine - INFO - [cached since 0.0144s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:04:53,918 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:04:53,919 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:53,919 - app.main - INFO - Database tables created successfully
2025-04-02 22:04:54,188 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:04:54,539 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:21,213 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:21,387 - app.main - INFO - Shutting down application
2025-04-02 22:05:21,387 - app.main - INFO - Shutting down application
2025-04-02 22:05:21,390 - app.main - INFO - Database connections closed successfully
2025-04-02 22:05:21,390 - app.main - INFO - Database connections closed successfully
2025-04-02 22:05:21,758 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:22,459 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:05:22,810 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:24,316 - app.main - INFO - Starting up application
2025-04-02 22:05:24,316 - app.main - INFO - Starting up application
2025-04-02 22:05:24,372 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:05:24,373 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:05:24,376 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:05:24,376 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:05:24,379 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:05:24,379 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:05:24,382 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:05:24,387 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:24,387 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:24,391 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:24,391 - sqlalchemy.engine.Engine - INFO - [cached since 0.004639s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:24,393 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:24,393 - sqlalchemy.engine.Engine - INFO - [cached since 0.006562s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:24,395 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:24,396 - sqlalchemy.engine.Engine - INFO - [cached since 0.00909s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:24,398 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:24,398 - sqlalchemy.engine.Engine - INFO - [cached since 0.01131s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:24,400 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:05:24,402 - app.main - INFO - Database tables created successfully
2025-04-02 22:05:24,402 - app.main - INFO - Database tables created successfully
2025-04-02 22:05:24,565 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:52,844 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:52,975 - app.main - INFO - Shutting down application
2025-04-02 22:05:52,975 - app.main - INFO - Shutting down application
2025-04-02 22:05:52,981 - app.main - INFO - Database connections closed successfully
2025-04-02 22:05:52,981 - app.main - INFO - Database connections closed successfully
2025-04-02 22:05:53,368 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:53,719 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:54,320 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:05:54,673 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:56,127 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:56,494 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:57,347 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:05:57,712 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:05:59,588 - app.main - INFO - Starting up application
2025-04-02 22:05:59,588 - app.main - INFO - Starting up application
2025-04-02 22:05:59,645 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:05:59,645 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:05:59,648 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:05:59,648 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:05:59,651 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:05:59,652 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:05:59,654 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:05:59,659 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:59,659 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:59,662 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:59,663 - sqlalchemy.engine.Engine - INFO - [cached since 0.003959s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:59,665 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:59,665 - sqlalchemy.engine.Engine - INFO - [cached since 0.00638s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:59,666 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:59,667 - sqlalchemy.engine.Engine - INFO - [cached since 0.008179s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:59,669 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:05:59,670 - sqlalchemy.engine.Engine - INFO - [cached since 0.01163s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:05:59,673 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:05:59,674 - app.main - INFO - Database tables created successfully
2025-04-02 22:05:59,674 - app.main - INFO - Database tables created successfully
2025-04-02 22:05:59,768 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:06:21,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:06:21,113 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-02 22:06:21,113 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-02 22:06:21,120 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-02 22:06:21,120 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 22:06:21,128 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 22:06:21,128 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 22:06:21,133 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-02 22:06:21,134 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-02 22:06:21,150 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-02 22:06:21,150 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] (UUID('001f765b-a11d-4e1f-88e8-6779fab1627d'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 2, 22, 6, 21, 150191, tzinfo=datetime.timezone.utc))
2025-04-02 22:06:21,154 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:06:21,162 - app.main - ERROR - Unhandled exception during request processing: DocumentProcessor.__init__() missing 1 required positional argument: 'document_path'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 51, in upload_note
    await process_user_note(current_user.id, note.id, note_text, db)
  File "/backend/app/services/rag_service.py", line 104, in process_user_note
    rag_service = RAGService(db)
  File "/backend/app/services/rag_service.py", line 33, in __init__
    self.document_processor = DocumentProcessingService(db)
  File "/backend/app/services/document_processing_service.py", line 16, in __init__
    self.document_processor = DocumentProcessor()
TypeError: DocumentProcessor.__init__() missing 1 required positional argument: 'document_path'
2025-04-02 22:06:21,162 - app.main - ERROR - Unhandled exception during request processing: DocumentProcessor.__init__() missing 1 required positional argument: 'document_path'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 51, in upload_note
    await process_user_note(current_user.id, note.id, note_text, db)
  File "/backend/app/services/rag_service.py", line 104, in process_user_note
    rag_service = RAGService(db)
  File "/backend/app/services/rag_service.py", line 33, in __init__
    self.document_processor = DocumentProcessingService(db)
  File "/backend/app/services/document_processing_service.py", line 16, in __init__
    self.document_processor = DocumentProcessor()
TypeError: DocumentProcessor.__init__() missing 1 required positional argument: 'document_path'
2025-04-02 22:06:21,435 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:06:58,746 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:06:58,856 - app.main - INFO - Shutting down application
2025-04-02 22:06:58,856 - app.main - INFO - Shutting down application
2025-04-02 22:06:58,861 - app.main - INFO - Database connections closed successfully
2025-04-02 22:06:58,861 - app.main - INFO - Database connections closed successfully
2025-04-02 22:06:59,249 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:06:59,600 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:07:01,748 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:07:02,099 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:07:02,450 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:07:02,669 - app.main - INFO - Starting up application
2025-04-02 22:07:02,669 - app.main - INFO - Starting up application
2025-04-02 22:07:02,725 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:07:02,725 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:07:02,728 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:07:02,728 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:07:02,731 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:07:02,731 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:07:02,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:07:02,737 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:07:02,738 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:07:02,742 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:07:02,742 - sqlalchemy.engine.Engine - INFO - [cached since 0.005039s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:07:02,744 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:07:02,744 - sqlalchemy.engine.Engine - INFO - [cached since 0.006714s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:07:02,746 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:07:02,746 - sqlalchemy.engine.Engine - INFO - [cached since 0.008643s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:07:02,747 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:07:02,748 - sqlalchemy.engine.Engine - INFO - [cached since 0.01054s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:07:02,750 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:07:02,751 - app.main - INFO - Database tables created successfully
2025-04-02 22:07:02,751 - app.main - INFO - Database tables created successfully
2025-04-02 22:10:21,769 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:21,885 - app.main - INFO - Shutting down application
2025-04-02 22:10:21,885 - app.main - INFO - Shutting down application
2025-04-02 22:10:21,890 - app.main - INFO - Database connections closed successfully
2025-04-02 22:10:21,890 - app.main - INFO - Database connections closed successfully
2025-04-02 22:10:22,260 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:22,611 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:23,865 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:10:24,216 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:24,567 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:25,042 - app.main - INFO - Starting up application
2025-04-02 22:10:25,042 - app.main - INFO - Starting up application
2025-04-02 22:10:25,097 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:10:25,097 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:25,100 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:10:25,101 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:25,103 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:10:25,103 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:25,105 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:10:25,110 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:25,110 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:25,113 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:25,114 - sqlalchemy.engine.Engine - INFO - [cached since 0.003852s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:25,115 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:25,115 - sqlalchemy.engine.Engine - INFO - [cached since 0.005402s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:25,116 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:25,117 - sqlalchemy.engine.Engine - INFO - [cached since 0.007092s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:25,118 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:25,119 - sqlalchemy.engine.Engine - INFO - [cached since 0.009035s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:25,120 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:10:25,121 - app.main - INFO - Database tables created successfully
2025-04-02 22:10:25,121 - app.main - INFO - Database tables created successfully
2025-04-02 22:10:25,369 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:30,984 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:31,140 - app.main - INFO - Shutting down application
2025-04-02 22:10:31,140 - app.main - INFO - Shutting down application
2025-04-02 22:10:31,144 - app.main - INFO - Database connections closed successfully
2025-04-02 22:10:31,144 - app.main - INFO - Database connections closed successfully
2025-04-02 22:10:31,512 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:32,018 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:32,375 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:34,731 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:10:35,083 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:35,435 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:36,057 - app.main - INFO - Starting up application
2025-04-02 22:10:36,057 - app.main - INFO - Starting up application
2025-04-02 22:10:36,132 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:10:36,133 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:36,140 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:10:36,140 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:36,143 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:10:36,144 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:36,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:10:36,154 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:36,154 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:36,159 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:36,159 - sqlalchemy.engine.Engine - INFO - [cached since 0.005659s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:36,161 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:36,162 - sqlalchemy.engine.Engine - INFO - [cached since 0.008522s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:36,190 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:36,191 - sqlalchemy.engine.Engine - INFO - [cached since 0.03723s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:36,195 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:36,196 - sqlalchemy.engine.Engine - INFO - [cached since 0.04207s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:36,201 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:10:36,204 - app.main - INFO - Database tables created successfully
2025-04-02 22:10:36,204 - app.main - INFO - Database tables created successfully
2025-04-02 22:10:36,237 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:41,051 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:41,218 - app.main - INFO - Shutting down application
2025-04-02 22:10:41,218 - app.main - INFO - Shutting down application
2025-04-02 22:10:41,222 - app.main - INFO - Database connections closed successfully
2025-04-02 22:10:41,222 - app.main - INFO - Database connections closed successfully
2025-04-02 22:10:41,592 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:43,448 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:10:43,799 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:10:45,190 - app.main - INFO - Starting up application
2025-04-02 22:10:45,190 - app.main - INFO - Starting up application
2025-04-02 22:10:45,282 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:10:45,282 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:45,287 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:10:45,287 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:45,291 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:10:45,292 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:10:45,300 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:10:45,309 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:45,310 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:45,315 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:45,315 - sqlalchemy.engine.Engine - INFO - [cached since 0.006688s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:45,318 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:45,319 - sqlalchemy.engine.Engine - INFO - [cached since 0.01008s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:45,320 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:45,321 - sqlalchemy.engine.Engine - INFO - [cached since 0.01243s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:45,323 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:10:45,324 - sqlalchemy.engine.Engine - INFO - [cached since 0.01521s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:10:45,326 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:10:45,328 - app.main - INFO - Database tables created successfully
2025-04-02 22:10:45,328 - app.main - INFO - Database tables created successfully
2025-04-02 22:10:45,554 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:11:34,291 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:11:34,468 - app.main - INFO - Shutting down application
2025-04-02 22:11:34,468 - app.main - INFO - Shutting down application
2025-04-02 22:11:34,472 - app.main - INFO - Database connections closed successfully
2025-04-02 22:11:34,472 - app.main - INFO - Database connections closed successfully
2025-04-02 22:11:34,835 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:11:36,692 - watchfiles.main - INFO - 3 changes detected
2025-04-02 22:11:37,043 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:11:37,394 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:11:37,553 - app.main - INFO - Starting up application
2025-04-02 22:11:37,553 - app.main - INFO - Starting up application
2025-04-02 22:11:37,610 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:11:37,611 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:11:37,615 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:11:37,615 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:11:37,618 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:11:37,618 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:11:37,620 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:11:37,625 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:11:37,625 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:11:37,628 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:11:37,629 - sqlalchemy.engine.Engine - INFO - [cached since 0.004215s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:11:37,630 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:11:37,630 - sqlalchemy.engine.Engine - INFO - [cached since 0.00587s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:11:37,632 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:11:37,632 - sqlalchemy.engine.Engine - INFO - [cached since 0.007568s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:11:37,634 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:11:37,634 - sqlalchemy.engine.Engine - INFO - [cached since 0.009699s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:11:37,636 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:11:37,637 - app.main - INFO - Database tables created successfully
2025-04-02 22:11:37,637 - app.main - INFO - Database tables created successfully
2025-04-02 22:12:05,871 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:06,011 - app.main - INFO - Shutting down application
2025-04-02 22:12:06,011 - app.main - INFO - Shutting down application
2025-04-02 22:12:06,015 - app.main - INFO - Database connections closed successfully
2025-04-02 22:12:06,015 - app.main - INFO - Database connections closed successfully
2025-04-02 22:12:06,384 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:07,386 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:12:07,737 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:09,670 - app.main - INFO - Starting up application
2025-04-02 22:12:09,670 - app.main - INFO - Starting up application
2025-04-02 22:12:09,787 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:12:09,787 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:09,791 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:12:09,792 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:09,795 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:09,799 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:12:09,800 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:09,805 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:12:09,813 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:09,813 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:09,818 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:09,819 - sqlalchemy.engine.Engine - INFO - [cached since 0.006084s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:09,820 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:09,821 - sqlalchemy.engine.Engine - INFO - [cached since 0.008497s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:09,823 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:09,824 - sqlalchemy.engine.Engine - INFO - [cached since 0.01103s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:09,826 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:09,827 - sqlalchemy.engine.Engine - INFO - [cached since 0.01427s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:09,829 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:12:09,831 - app.main - INFO - Database tables created successfully
2025-04-02 22:12:09,831 - app.main - INFO - Database tables created successfully
2025-04-02 22:12:17,314 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:17,450 - app.main - INFO - Shutting down application
2025-04-02 22:12:17,450 - app.main - INFO - Shutting down application
2025-04-02 22:12:17,456 - app.main - INFO - Database connections closed successfully
2025-04-02 22:12:17,456 - app.main - INFO - Database connections closed successfully
2025-04-02 22:12:17,837 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:20,019 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:12:20,370 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:21,039 - app.main - INFO - Starting up application
2025-04-02 22:12:21,039 - app.main - INFO - Starting up application
2025-04-02 22:12:21,098 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:12:21,098 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:21,101 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:12:21,102 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:21,104 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:12:21,104 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:21,107 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:12:21,114 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:21,114 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:21,119 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:21,119 - sqlalchemy.engine.Engine - INFO - [cached since 0.005447s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:21,121 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:21,121 - sqlalchemy.engine.Engine - INFO - [cached since 0.007396s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:21,123 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:21,124 - sqlalchemy.engine.Engine - INFO - [cached since 0.009782s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:21,126 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:21,126 - sqlalchemy.engine.Engine - INFO - [cached since 0.01221s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:21,128 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:12:21,129 - app.main - INFO - Database tables created successfully
2025-04-02 22:12:21,129 - app.main - INFO - Database tables created successfully
2025-04-02 22:12:21,223 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:33,261 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:12:33,372 - app.main - INFO - Shutting down application
2025-04-02 22:12:33,372 - app.main - INFO - Shutting down application
2025-04-02 22:12:33,378 - app.main - INFO - Database connections closed successfully
2025-04-02 22:12:33,378 - app.main - INFO - Database connections closed successfully
2025-04-02 22:12:33,760 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:34,763 - watchfiles.main - INFO - 2 changes detected
2025-04-02 22:12:35,114 - watchfiles.main - INFO - 1 change detected
2025-04-02 22:12:35,491 - watchfiles.main - INFO - 3 changes detected
2025-04-02 22:12:36,512 - app.main - INFO - Starting up application
2025-04-02 22:12:36,512 - app.main - INFO - Starting up application
2025-04-02 22:12:36,569 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-02 22:12:36,570 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:36,574 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-02 22:12:36,574 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:36,576 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-02 22:12:36,577 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-02 22:12:36,579 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-02 22:12:36,583 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:36,584 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:36,587 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:36,588 - sqlalchemy.engine.Engine - INFO - [cached since 0.004423s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:36,590 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:36,591 - sqlalchemy.engine.Engine - INFO - [cached since 0.007179s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:36,593 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:36,593 - sqlalchemy.engine.Engine - INFO - [cached since 0.009753s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:36,595 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-02 22:12:36,596 - sqlalchemy.engine.Engine - INFO - [cached since 0.01252s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-02 22:12:36,598 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-02 22:12:36,599 - app.main - INFO - Database tables created successfully
2025-04-02 22:12:36,599 - app.main - INFO - Database tables created successfully
2025-04-02 22:12:36,845 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:05:00,162 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-03 07:05:00,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-03 07:05:00,203 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] ('jamiebones2000@yahoo.co.uk',)
2025-04-03 07:05:00,220 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-03 07:05:00,221 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:00,233 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:00,233 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:00,239 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:00,240 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:00,244 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-03 07:05:00,434 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:05:00,631 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-03 07:05:01,017 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-03 07:05:01,022 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-03 07:05:01,022 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-03 07:05:01,026 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-03 07:05:01,027 - sqlalchemy.engine.Engine - INFO - [cached since 0.8072s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,039 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:01,040 - sqlalchemy.engine.Engine - INFO - [cached since 0.8071s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,045 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:01,046 - sqlalchemy.engine.Engine - INFO - [cached since 0.8065s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,058 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-03 07:05:01,058 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-03 07:05:01,066 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-03 07:05:01,066 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,076 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:01,081 - sqlalchemy.engine.Engine - INFO - [generated in 0.00475s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,090 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-03 07:05:01,109 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-03 07:05:01,109 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-03 07:05:01,110 - sqlalchemy.engine.Engine - INFO - [cached since 0.08856s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-03 07:05:01,125 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-03 07:05:01,127 - sqlalchemy.engine.Engine - INFO - [cached since 0.9072s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,133 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:01,133 - sqlalchemy.engine.Engine - INFO - [cached since 0.9004s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,138 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:01,138 - sqlalchemy.engine.Engine - INFO - [cached since 0.8991s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,149 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-03 07:05:01,149 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-03 07:05:01,151 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-03 07:05:01,152 - sqlalchemy.engine.Engine - INFO - [cached since 0.08597s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,156 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:01,180 - sqlalchemy.engine.Engine - INFO - [cached since 0.1041s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:01,185 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-03 07:05:01,338 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:05:19,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-03 07:05:19,773 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-03 07:05:19,773 - sqlalchemy.engine.Engine - INFO - [cached since 18.75s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-03 07:05:19,778 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-03 07:05:19,779 - sqlalchemy.engine.Engine - INFO - [cached since 19.56s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:19,784 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:19,784 - sqlalchemy.engine.Engine - INFO - [cached since 19.55s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:19,788 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-03 07:05:19,788 - sqlalchemy.engine.Engine - INFO - [cached since 19.55s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-03 07:05:19,832 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-03 07:05:19,833 - sqlalchemy.engine.Engine - INFO - [generated in 0.00266s] (UUID('13aa10f8-16a5-48e9-ac0e-5592bfd23e2f'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 3, 7, 5, 19, 832737, tzinfo=datetime.timezone.utc))
2025-04-03 07:05:19,840 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-03 07:05:19,846 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-03 07:05:19,846 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-03 07:05:19,990 - watchfiles.main - INFO - 3 changes detected
2025-04-03 07:05:24,649 - app.services.embeddings - ERROR - Error generating embeddings: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,649 - app.services.embeddings - ERROR - Error generating embeddings: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,649 - app.services.document_processing_service - ERROR - Error processing document 13aa10f8-16a5-48e9-ac0e-5592bfd23e2f: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,649 - app.services.document_processing_service - ERROR - Error processing document 13aa10f8-16a5-48e9-ac0e-5592bfd23e2f: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,650 - app.services.rag_service - ERROR - Error processing note 13aa10f8-16a5-48e9-ac0e-5592bfd23e2f: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,650 - app.services.rag_service - ERROR - Error processing note 13aa10f8-16a5-48e9-ac0e-5592bfd23e2f: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,651 - app.main - ERROR - Unhandled exception during request processing: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 51, in upload_note
    await process_user_note(current_user.id, note.id, note_text, db)
  File "/backend/app/services/rag_service.py", line 97, in process_user_note
    await rag_service.process_note(note)
  File "/backend/app/services/rag_service.py", line 40, in process_note
    chunks = self.document_processor.process_document(note)
  File "/backend/app/services/document_processing_service.py", line 48, in process_document
    embedding = get_embeddings(doc_chunk.content)
  File "/backend/app/services/embeddings.py", line 42, in get_embeddings
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,651 - app.main - ERROR - Unhandled exception during request processing: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/notes.py", line 51, in upload_note
    await process_user_note(current_user.id, note.id, note_text, db)
  File "/backend/app/services/rag_service.py", line 97, in process_user_note
    await rag_service.process_note(note)
  File "/backend/app/services/rag_service.py", line 40, in process_note
    chunks = self.document_processor.process_document(note)
  File "/backend/app/services/document_processing_service.py", line 48, in process_document
    embedding = get_embeddings(doc_chunk.content)
  File "/backend/app/services/embeddings.py", line 42, in get_embeddings
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://anura-testnet.lilypad.tech/api/v1/chat/completions
2025-04-03 07:05:24,804 - watchfiles.main - INFO - 3 changes detected
2025-04-03 07:07:30,249 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:30,379 - app.main - INFO - Shutting down application
2025-04-03 07:07:30,379 - app.main - INFO - Shutting down application
2025-04-03 07:07:30,395 - app.main - INFO - Database connections closed successfully
2025-04-03 07:07:30,395 - app.main - INFO - Database connections closed successfully
2025-04-03 07:07:30,776 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:31,480 - watchfiles.main - INFO - 2 changes detected
2025-04-03 07:07:31,831 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:34,428 - app.main - INFO - Starting up application
2025-04-03 07:07:34,428 - app.main - INFO - Starting up application
2025-04-03 07:07:34,508 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-03 07:07:34,509 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:07:34,513 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-03 07:07:34,513 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:07:34,515 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-03 07:07:34,516 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:07:34,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-03 07:07:34,525 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:34,526 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:34,530 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:34,530 - sqlalchemy.engine.Engine - INFO - [cached since 0.004932s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:34,532 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:34,532 - sqlalchemy.engine.Engine - INFO - [cached since 0.006787s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:34,534 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:34,534 - sqlalchemy.engine.Engine - INFO - [cached since 0.008991s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:34,537 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:34,537 - sqlalchemy.engine.Engine - INFO - [cached since 0.01166s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:34,539 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-03 07:07:34,540 - app.main - INFO - Database tables created successfully
2025-04-03 07:07:34,540 - app.main - INFO - Database tables created successfully
2025-04-03 07:07:34,789 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:39,603 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:39,755 - app.main - INFO - Shutting down application
2025-04-03 07:07:39,755 - app.main - INFO - Shutting down application
2025-04-03 07:07:39,759 - app.main - INFO - Database connections closed successfully
2025-04-03 07:07:39,759 - app.main - INFO - Database connections closed successfully
2025-04-03 07:07:40,127 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:40,478 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:42,004 - watchfiles.main - INFO - 2 changes detected
2025-04-03 07:07:42,364 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:42,715 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:43,822 - app.main - INFO - Starting up application
2025-04-03 07:07:43,822 - app.main - INFO - Starting up application
2025-04-03 07:07:43,884 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-03 07:07:43,884 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:07:43,888 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-03 07:07:43,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:07:43,891 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-03 07:07:43,891 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:07:43,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-03 07:07:43,899 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:43,899 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:43,904 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:43,904 - sqlalchemy.engine.Engine - INFO - [cached since 0.005695s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:43,907 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:43,908 - sqlalchemy.engine.Engine - INFO - [cached since 0.008876s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:43,909 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:43,910 - sqlalchemy.engine.Engine - INFO - [cached since 0.01107s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:43,911 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:07:43,912 - sqlalchemy.engine.Engine - INFO - [cached since 0.01306s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:07:43,914 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-03 07:07:43,915 - app.main - INFO - Database tables created successfully
2025-04-03 07:07:43,915 - app.main - INFO - Database tables created successfully
2025-04-03 07:07:44,119 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:07:44,470 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:17:10,856 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:17:11,012 - app.main - INFO - Shutting down application
2025-04-03 07:17:11,012 - app.main - INFO - Shutting down application
2025-04-03 07:17:11,019 - app.main - INFO - Database connections closed successfully
2025-04-03 07:17:11,019 - app.main - INFO - Database connections closed successfully
2025-04-03 07:17:11,396 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:17:12,349 - watchfiles.main - INFO - 2 changes detected
2025-04-03 07:17:12,700 - watchfiles.main - INFO - 1 change detected
2025-04-03 07:17:13,947 - app.main - INFO - Starting up application
2025-04-03 07:17:13,947 - app.main - INFO - Starting up application
2025-04-03 07:17:14,011 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-03 07:17:14,011 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:17:14,015 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-03 07:17:14,016 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:17:14,018 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-03 07:17:14,018 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-03 07:17:14,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-03 07:17:14,029 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:17:14,029 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:17:14,034 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:17:14,034 - sqlalchemy.engine.Engine - INFO - [cached since 0.005548s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:17:14,036 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:17:14,036 - sqlalchemy.engine.Engine - INFO - [cached since 0.007857s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:17:14,038 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:17:14,039 - sqlalchemy.engine.Engine - INFO - [cached since 0.009975s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:17:14,041 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-03 07:17:14,041 - sqlalchemy.engine.Engine - INFO - [cached since 0.01275s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-03 07:17:14,043 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-03 07:17:14,044 - app.main - INFO - Database tables created successfully
2025-04-03 07:17:14,044 - app.main - INFO - Database tables created successfully
2025-04-03 07:17:14,153 - watchfiles.main - INFO - 1 change detected
2025-04-04 10:54:42,396 - __main__ - INFO - Starting development server
2025-04-04 10:54:45,746 - app.main - INFO - Starting up application
2025-04-04 10:54:45,746 - app.main - INFO - Starting up application
2025-04-04 10:54:45,894 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 10:54:45,894 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 10:54:45,900 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 10:54:45,901 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 10:54:45,906 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 10:54:45,907 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 10:54:45,910 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 10:54:45,917 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 10:54:45,917 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 10:54:45,937 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 10:54:45,938 - sqlalchemy.engine.Engine - INFO - [cached since 0.02112s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 10:54:45,939 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 10:54:45,939 - sqlalchemy.engine.Engine - INFO - [cached since 0.02268s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 10:54:45,940 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 10:54:45,940 - sqlalchemy.engine.Engine - INFO - [cached since 0.02407s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 10:54:45,942 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 10:54:45,942 - sqlalchemy.engine.Engine - INFO - [cached since 0.0254s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 10:54:45,943 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 10:54:45,944 - app.main - INFO - Database tables created successfully
2025-04-04 10:54:45,944 - app.main - INFO - Database tables created successfully
2025-04-04 10:54:46,043 - watchfiles.main - INFO - 1 change detected
2025-04-04 10:54:46,394 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:17,908 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:18,082 - app.main - INFO - Shutting down application
2025-04-04 11:24:18,082 - app.main - INFO - Shutting down application
2025-04-04 11:24:18,138 - app.main - INFO - Database connections closed successfully
2025-04-04 11:24:18,138 - app.main - INFO - Database connections closed successfully
2025-04-04 11:24:18,524 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:19,677 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:20,036 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:20,387 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:21,791 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:24:22,142 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:22,493 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:36,056 - app.main - INFO - Starting up application
2025-04-04 11:24:36,056 - app.main - INFO - Starting up application
2025-04-04 11:24:36,124 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 11:24:36,124 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:24:36,128 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 11:24:36,128 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:24:36,130 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 11:24:36,130 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:24:36,133 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:24:36,138 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:36,139 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:36,144 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:36,144 - sqlalchemy.engine.Engine - INFO - [cached since 0.00553s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:36,145 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:36,145 - sqlalchemy.engine.Engine - INFO - [cached since 0.00721s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:36,147 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:36,147 - sqlalchemy.engine.Engine - INFO - [cached since 0.008869s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:36,149 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:36,150 - sqlalchemy.engine.Engine - INFO - [cached since 0.01119s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:36,152 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:24:36,153 - app.main - INFO - Database tables created successfully
2025-04-04 11:24:36,153 - app.main - INFO - Database tables created successfully
2025-04-04 11:24:36,246 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:46,179 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:46,302 - app.main - INFO - Shutting down application
2025-04-04 11:24:46,302 - app.main - INFO - Shutting down application
2025-04-04 11:24:46,308 - app.main - INFO - Database connections closed successfully
2025-04-04 11:24:46,308 - app.main - INFO - Database connections closed successfully
2025-04-04 11:24:46,729 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:47,983 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:24:48,334 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:48,685 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:55,991 - app.main - INFO - Starting up application
2025-04-04 11:24:55,991 - app.main - INFO - Starting up application
2025-04-04 11:24:56,053 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 11:24:56,053 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:24:56,057 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 11:24:56,057 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:24:56,060 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 11:24:56,060 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:24:56,062 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:24:56,068 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:56,068 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:56,072 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:56,072 - sqlalchemy.engine.Engine - INFO - [cached since 0.00435s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:56,073 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:56,074 - sqlalchemy.engine.Engine - INFO - [cached since 0.006008s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:56,075 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:56,076 - sqlalchemy.engine.Engine - INFO - [cached since 0.008167s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:56,078 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:24:56,078 - sqlalchemy.engine.Engine - INFO - [cached since 0.01044s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:24:56,080 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:24:56,082 - app.main - INFO - Database tables created successfully
2025-04-04 11:24:56,082 - app.main - INFO - Database tables created successfully
2025-04-04 11:24:56,111 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:24:56,462 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:25:02,084 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:25:02,208 - app.main - INFO - Shutting down application
2025-04-04 11:25:02,208 - app.main - INFO - Shutting down application
2025-04-04 11:25:02,213 - app.main - INFO - Database connections closed successfully
2025-04-04 11:25:02,213 - app.main - INFO - Database connections closed successfully
2025-04-04 11:25:02,634 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:25:10,270 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:25:10,652 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:25:17,774 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:25:17,858 - app.main - INFO - Starting up application
2025-04-04 11:25:17,858 - app.main - INFO - Starting up application
2025-04-04 11:25:17,939 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 11:25:17,939 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:25:17,941 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 11:25:17,942 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:25:17,944 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 11:25:17,944 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:25:17,946 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:25:17,950 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:25:17,950 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:25:17,954 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:25:17,954 - sqlalchemy.engine.Engine - INFO - [cached since 0.003762s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:25:17,955 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:25:17,955 - sqlalchemy.engine.Engine - INFO - [cached since 0.005196s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:25:17,957 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:25:17,957 - sqlalchemy.engine.Engine - INFO - [cached since 0.006798s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:25:17,958 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:25:17,958 - sqlalchemy.engine.Engine - INFO - [cached since 0.008372s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:25:17,960 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:25:17,961 - app.main - INFO - Database tables created successfully
2025-04-04 11:25:17,961 - app.main - INFO - Database tables created successfully
2025-04-04 11:25:18,125 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:25:18,477 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:36:50,742 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:36:50,767 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-04 11:36:50,768 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('jamiebones2000@yahoo.co.uk',)
2025-04-04 11:36:50,788 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 11:36:50,788 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:50,884 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:50,884 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:50,894 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:50,894 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:50,897 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-04 11:36:50,915 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:36:51,255 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:36:51,525 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:36:54,098 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:36:54,101 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 11:36:54,101 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 11:36:54,105 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 11:36:54,106 - sqlalchemy.engine.Engine - INFO - [cached since 3.318s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,113 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:54,114 - sqlalchemy.engine.Engine - INFO - [cached since 3.231s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,119 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:54,119 - sqlalchemy.engine.Engine - INFO - [cached since 3.226s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,122 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 11:36:54,122 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 11:36:54,135 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 11:36:54,135 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,145 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:54,145 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,162 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:36:54,183 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:36:54,183 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 11:36:54,184 - sqlalchemy.engine.Engine - INFO - [cached since 0.0834s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 11:36:54,197 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 11:36:54,197 - sqlalchemy.engine.Engine - INFO - [cached since 3.409s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,202 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:54,211 - sqlalchemy.engine.Engine - INFO - [cached since 3.328s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,215 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:54,215 - sqlalchemy.engine.Engine - INFO - [cached since 3.321s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,217 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 11:36:54,217 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 11:36:54,222 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 11:36:54,222 - sqlalchemy.engine.Engine - INFO - [cached since 0.08754s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,229 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:36:54,230 - sqlalchemy.engine.Engine - INFO - [cached since 0.08505s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:36:54,232 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:36:54,233 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:37:05,352 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:37:05,353 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 11:37:05,354 - sqlalchemy.engine.Engine - INFO - [cached since 11.25s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 11:37:05,357 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 11:37:05,357 - sqlalchemy.engine.Engine - INFO - [cached since 14.57s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:37:05,362 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:37:05,362 - sqlalchemy.engine.Engine - INFO - [cached since 14.48s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:37:05,365 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 11:37:05,365 - sqlalchemy.engine.Engine - INFO - [cached since 14.47s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 11:37:05,400 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 11:37:05,401 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] (UUID('61b4d1b0-a28a-4bdf-ad4c-6975c81733b8'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 11, 37, 5, 400366, tzinfo=datetime.timezone.utc))
2025-04-04 11:37:05,414 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:37:05,419 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 11:37:05,419 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 11:37:05,434 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 11:37:05,435 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 11:37:05,663 - watchfiles.main - INFO - 3 changes detected
2025-04-04 11:37:55,708 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 11:37:55,708 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 11:37:55,903 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:37:55,942 - app.services.document_processing_service - INFO - Successfully processed document 61b4d1b0-a28a-4bdf-ad4c-6975c81733b8 into 2 chunks
2025-04-04 11:37:55,942 - app.services.document_processing_service - INFO - Successfully processed document 61b4d1b0-a28a-4bdf-ad4c-6975c81733b8 into 2 chunks
2025-04-04 11:37:55,942 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 11:37:55,942 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 11:37:55,943 - app.services.rag_service - INFO - Successfully processed note 61b4d1b0-a28a-4bdf-ad4c-6975c81733b8
2025-04-04 11:37:55,943 - app.services.rag_service - INFO - Successfully processed note 61b4d1b0-a28a-4bdf-ad4c-6975c81733b8
2025-04-04 11:37:55,945 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:37:55,947 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 11:37:55,947 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s (insertmanyvalues) 1/1 (unordered)] (UUID('1c5f0484-6e39-4648-86cb-0443216ab3c9'), UUID('61b4d1b0-a28a-4bdf-ad4c-6975c81733b8'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 11, 37, 55, 947145, tzinfo=datetime.timezone.utc), None, UUID('e06f2b86-3c7e-421e-b206-625b970719f5'), UUID('61b4d1b0-a28a-4bdf-ad4c-6975c81733b8'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 11, 37, 55, 947158, tzinfo=datetime.timezone.utc), None)
2025-04-04 11:37:55,955 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8::VARCHAR, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 11:37:55,955 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s (insertmanyvalues) 1/1 (unordered)] (UUID('32d41088-feac-43df-86e7-0f6bd0b0b38c'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 11, 37, 55, 955164, tzinfo=datetime.timezone.utc), None, UUID('a665176a-a2ca-46ff-b215-59e94346a3be'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 11, 37, 55, 955181, tzinfo=datetime.timezone.utc), None)
2025-04-04 11:37:55,961 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 11:37:55,964 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8::VARCHAR, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('32d41088-feac-43df-86e7-0f6bd0b0b38c'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 11, 37, 55, 955164, tzinfo=datetime.timezone.utc), None, UUID('a665176a-a2ca-46ff-b215-59e94346a3be'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 11, 37, 55, 955181, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/text.pyx", line 29, in asyncpg.pgproto.pgproto.text_encode
  File "asyncpg/pgproto/./codecs/text.pyx", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size
TypeError: expected str, got list

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
  File "/opt/conda/lib/python3.10/contextlib.py", line 714, in __aexit__
    raise exc_details[1]
  File "/opt/conda/lib/python3.10/contextlib.py", line 697, in __aexit__
    cb_suppress = await cb(*exc_details)
  File "/opt/conda/lib/python3.10/contextlib.py", line 206, in __aexit__
    await anext(self.gen)
  File "/backend/app/core/db.py", line 33, in get_db
    await session.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8::VARCHAR, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('32d41088-feac-43df-86e7-0f6bd0b0b38c'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 11, 37, 55, 955164, tzinfo=datetime.timezone.utc), None, UUID('a665176a-a2ca-46ff-b215-59e94346a3be'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 11, 37, 55, 955181, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-04-04 11:37:55,964 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8::VARCHAR, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('32d41088-feac-43df-86e7-0f6bd0b0b38c'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 11, 37, 55, 955164, tzinfo=datetime.timezone.utc), None, UUID('a665176a-a2ca-46ff-b215-59e94346a3be'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 11, 37, 55, 955181, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/text.pyx", line 29, in asyncpg.pgproto.pgproto.text_encode
  File "asyncpg/pgproto/./codecs/text.pyx", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size
TypeError: expected str, got list

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 126, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 173, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 175, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
  File "/opt/conda/lib/python3.10/contextlib.py", line 714, in __aexit__
    raise exc_details[1]
  File "/opt/conda/lib/python3.10/contextlib.py", line 697, in __aexit__
    cb_suppress = await cb(*exc_details)
  File "/opt/conda/lib/python3.10/contextlib.py", line 206, in __aexit__
    await anext(self.gen)
  File "/backend/app/core/db.py", line 33, in get_db
    await session.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8::VARCHAR, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('32d41088-feac-43df-86e7-0f6bd0b0b38c'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 11, 37, 55, 955164, tzinfo=datetime.timezone.utc), None, UUID('a665176a-a2ca-46ff-b215-59e94346a3be'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 11, 37, 55, 955181, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-04-04 11:37:56,255 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:37:56,606 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:03,455 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:42:03,806 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:07,369 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:07,721 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:25,068 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:25,239 - app.main - INFO - Shutting down application
2025-04-04 11:42:25,239 - app.main - INFO - Shutting down application
2025-04-04 11:42:25,243 - app.main - INFO - Database connections closed successfully
2025-04-04 11:42:25,243 - app.main - INFO - Database connections closed successfully
2025-04-04 11:42:25,634 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:27,815 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:42:28,166 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:28,518 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:35,363 - app.main - INFO - Starting up application
2025-04-04 11:42:35,363 - app.main - INFO - Starting up application
2025-04-04 11:42:35,421 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 11:42:35,421 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:42:35,424 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 11:42:35,424 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:42:35,426 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 11:42:35,427 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:42:35,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:42:35,433 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:35,434 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:35,437 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:35,437 - sqlalchemy.engine.Engine - INFO - [cached since 0.004043s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:35,439 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:35,439 - sqlalchemy.engine.Engine - INFO - [cached since 0.005893s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:35,441 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:35,441 - sqlalchemy.engine.Engine - INFO - [cached since 0.007825s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:35,444 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:35,444 - sqlalchemy.engine.Engine - INFO - [cached since 0.01098s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:35,446 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:42:35,447 - app.main - INFO - Database tables created successfully
2025-04-04 11:42:35,447 - app.main - INFO - Database tables created successfully
2025-04-04 11:42:35,642 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:42,257 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:42,363 - app.main - INFO - Shutting down application
2025-04-04 11:42:42,363 - app.main - INFO - Shutting down application
2025-04-04 11:42:42,367 - app.main - INFO - Database connections closed successfully
2025-04-04 11:42:42,367 - app.main - INFO - Database connections closed successfully
2025-04-04 11:42:42,751 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:42:52,318 - app.main - INFO - Starting up application
2025-04-04 11:42:52,318 - app.main - INFO - Starting up application
2025-04-04 11:42:52,383 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 11:42:52,383 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:42:52,386 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 11:42:52,386 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:42:52,389 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 11:42:52,389 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:42:52,391 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:42:52,396 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:52,397 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:52,400 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:52,401 - sqlalchemy.engine.Engine - INFO - [cached since 0.004665s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:52,402 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:52,403 - sqlalchemy.engine.Engine - INFO - [cached since 0.006418s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:52,404 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:52,404 - sqlalchemy.engine.Engine - INFO - [cached since 0.008129s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:52,406 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:42:52,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.01002s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:42:52,408 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:42:52,409 - app.main - INFO - Database tables created successfully
2025-04-04 11:42:52,409 - app.main - INFO - Database tables created successfully
2025-04-04 11:42:52,486 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:43:03,616 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:43:03,743 - app.main - INFO - Shutting down application
2025-04-04 11:43:03,743 - app.main - INFO - Shutting down application
2025-04-04 11:43:03,749 - app.main - INFO - Database connections closed successfully
2025-04-04 11:43:03,749 - app.main - INFO - Database connections closed successfully
2025-04-04 11:43:04,157 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:43:04,509 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:43:13,548 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:43:13,570 - app.main - INFO - Starting up application
2025-04-04 11:43:13,570 - app.main - INFO - Starting up application
2025-04-04 11:43:13,627 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 11:43:13,628 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:43:13,631 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 11:43:13,631 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:43:13,633 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 11:43:13,633 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:43:13,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:43:13,640 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:43:13,640 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:43:13,644 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:43:13,644 - sqlalchemy.engine.Engine - INFO - [cached since 0.003985s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:43:13,645 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:43:13,646 - sqlalchemy.engine.Engine - INFO - [cached since 0.00562s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:43:13,647 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:43:13,647 - sqlalchemy.engine.Engine - INFO - [cached since 0.00738s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:43:13,649 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:43:13,649 - sqlalchemy.engine.Engine - INFO - [cached since 0.009261s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:43:13,651 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:43:13,652 - app.main - INFO - Database tables created successfully
2025-04-04 11:43:13,652 - app.main - INFO - Database tables created successfully
2025-04-04 11:43:13,899 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:43:47,551 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:43:47,902 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:45:14,138 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:45:14,271 - app.main - INFO - Shutting down application
2025-04-04 11:45:14,271 - app.main - INFO - Shutting down application
2025-04-04 11:45:14,278 - app.main - INFO - Database connections closed successfully
2025-04-04 11:45:14,278 - app.main - INFO - Database connections closed successfully
2025-04-04 11:45:14,700 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:45:16,585 - watchfiles.main - INFO - 2 changes detected
2025-04-04 11:45:16,964 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:45:24,850 - app.main - INFO - Starting up application
2025-04-04 11:45:24,850 - app.main - INFO - Starting up application
2025-04-04 11:45:24,920 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 11:45:24,920 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:45:24,923 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 11:45:24,923 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:45:24,926 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 11:45:24,926 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 11:45:24,929 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 11:45:24,935 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:45:24,936 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:45:24,940 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:45:24,940 - sqlalchemy.engine.Engine - INFO - [cached since 0.005076s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:45:24,941 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:45:24,942 - sqlalchemy.engine.Engine - INFO - [cached since 0.006843s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:45:24,944 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:45:24,944 - sqlalchemy.engine.Engine - INFO - [cached since 0.009343s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:45:24,946 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 11:45:24,946 - sqlalchemy.engine.Engine - INFO - [cached since 0.01119s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 11:45:24,948 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 11:45:24,949 - app.main - INFO - Database tables created successfully
2025-04-04 11:45:24,949 - app.main - INFO - Database tables created successfully
2025-04-04 11:45:25,007 - watchfiles.main - INFO - 1 change detected
2025-04-04 11:45:25,358 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:00:05,578 - __main__ - INFO - Starting development server
2025-04-04 14:00:16,784 - app.main - INFO - Starting up application
2025-04-04 14:00:16,784 - app.main - INFO - Starting up application
2025-04-04 14:00:16,926 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:00:16,926 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:00:16,935 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:00:16,937 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:00:16,942 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:00:16,943 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:00:16,946 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:00:16,952 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:00:16,952 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:00:16,971 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:00:16,972 - sqlalchemy.engine.Engine - INFO - [cached since 0.02028s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:00:16,974 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:00:16,974 - sqlalchemy.engine.Engine - INFO - [cached since 0.02237s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:00:16,976 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:00:16,976 - sqlalchemy.engine.Engine - INFO - [cached since 0.02448s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:00:16,978 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:00:16,979 - sqlalchemy.engine.Engine - INFO - [cached since 0.027s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:00:16,982 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:00:16,983 - app.main - INFO - Database tables created successfully
2025-04-04 14:00:16,983 - app.main - INFO - Database tables created successfully
2025-04-04 14:00:17,055 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:00:17,407 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:00:32,271 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:00:32,296 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-04 14:00:32,296 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ('jamiebones2000@yahoo.co.uk',)
2025-04-04 14:00:32,316 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:00:32,316 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,388 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,389 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,396 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,396 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,398 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-04 14:00:32,404 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:00:32,694 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:00:32,836 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:00:32,839 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:00:32,840 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:00:32,858 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:00:32,860 - sqlalchemy.engine.Engine - INFO - [cached since 0.5439s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,865 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,865 - sqlalchemy.engine.Engine - INFO - [cached since 0.4771s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,868 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,869 - sqlalchemy.engine.Engine - INFO - [cached since 0.4732s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,872 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:00:32,872 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:00:32,879 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 14:00:32,879 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,893 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,894 - sqlalchemy.engine.Engine - INFO - [generated in 0.00128s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,908 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:00:32,924 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:00:32,925 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:00:32,925 - sqlalchemy.engine.Engine - INFO - [cached since 0.08641s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:00:32,936 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:00:32,937 - sqlalchemy.engine.Engine - INFO - [cached since 0.6208s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,955 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,956 - sqlalchemy.engine.Engine - INFO - [cached since 0.5675s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,960 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,961 - sqlalchemy.engine.Engine - INFO - [cached since 0.5653s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,974 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:00:32,974 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:00:32,979 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 14:00:32,982 - sqlalchemy.engine.Engine - INFO - [cached since 0.1028s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:32,996 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:32,998 - sqlalchemy.engine.Engine - INFO - [cached since 0.1055s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:33,003 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:00:33,311 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:00:43,294 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:00:43,295 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:00:43,295 - sqlalchemy.engine.Engine - INFO - [cached since 10.46s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:00:43,298 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:00:43,298 - sqlalchemy.engine.Engine - INFO - [cached since 10.98s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:43,303 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:43,303 - sqlalchemy.engine.Engine - INFO - [cached since 10.91s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:43,306 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:00:43,307 - sqlalchemy.engine.Engine - INFO - [cached since 10.91s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:00:43,334 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:00:43,334 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (UUID('dc674737-100d-4b54-893d-6507b232c822'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 14, 0, 43, 333908, tzinfo=datetime.timezone.utc))
2025-04-04 14:00:43,343 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:00:43,346 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:00:43,346 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:00:43,357 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 14:00:43,357 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:00:43,539 - watchfiles.main - INFO - 3 changes detected
2025-04-04 14:01:22,698 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:02:46,953 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:02:46,953 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:02:47,160 - app.services.document_processing_service - INFO - Successfully processed document dc674737-100d-4b54-893d-6507b232c822 into 2 chunks
2025-04-04 14:02:47,160 - app.services.document_processing_service - INFO - Successfully processed document dc674737-100d-4b54-893d-6507b232c822 into 2 chunks
2025-04-04 14:02:47,161 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:02:47,161 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:02:47,162 - app.services.rag_service - INFO - Successfully processed note dc674737-100d-4b54-893d-6507b232c822
2025-04-04 14:02:47,162 - app.services.rag_service - INFO - Successfully processed note dc674737-100d-4b54-893d-6507b232c822
2025-04-04 14:02:47,164 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:02:47,167 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:02:47,167 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s (insertmanyvalues) 1/1 (unordered)] (UUID('5da39a9e-0599-4324-bdfb-49ad4e51a661'), UUID('dc674737-100d-4b54-893d-6507b232c822'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 2, 47, 167245, tzinfo=datetime.timezone.utc), None, UUID('05adcf68-2c4d-4a77-a84c-8586f2123c88'), UUID('dc674737-100d-4b54-893d-6507b232c822'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 2, 47, 167256, tzinfo=datetime.timezone.utc), None)
2025-04-04 14:02:47,174 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:02:47,175 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s (insertmanyvalues) 1/1 (unordered)] (UUID('c975aa81-7032-40c4-a2bb-7be551c01ae0'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 14, 2, 47, 174693, tzinfo=datetime.timezone.utc), None, UUID('2a600b21-57ab-4e6e-8d82-91a74940e8c1'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 14, 2, 47, 174704, tzinfo=datetime.timezone.utc), None)
2025-04-04 14:02:47,180 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 14:02:47,183 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c975aa81-7032-40c4-a2bb-7be551c01ae0'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 14, 2, 47, 174693, tzinfo=datetime.timezone.utc), None, UUID('2a600b21-57ab-4e6e-8d82-91a74940e8c1'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 14, 2, 47, 174704, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/text.pyx", line 29, in asyncpg.pgproto.pgproto.text_encode
  File "asyncpg/pgproto/./codecs/text.pyx", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size
TypeError: expected str, got list

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
  File "/opt/conda/lib/python3.10/contextlib.py", line 714, in __aexit__
    raise exc_details[1]
  File "/opt/conda/lib/python3.10/contextlib.py", line 697, in __aexit__
    cb_suppress = await cb(*exc_details)
  File "/opt/conda/lib/python3.10/contextlib.py", line 206, in __aexit__
    await anext(self.gen)
  File "/backend/app/core/db.py", line 33, in get_db
    await session.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c975aa81-7032-40c4-a2bb-7be551c01ae0'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 14, 2, 47, 174693, tzinfo=datetime.timezone.utc), None, UUID('2a600b21-57ab-4e6e-8d82-91a74940e8c1'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 14, 2, 47, 174704, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-04-04 14:02:47,183 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c975aa81-7032-40c4-a2bb-7be551c01ae0'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 14, 2, 47, 174693, tzinfo=datetime.timezone.utc), None, UUID('2a600b21-57ab-4e6e-8d82-91a74940e8c1'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 14, 2, 47, 174704, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/text.pyx", line 29, in asyncpg.pgproto.pgproto.text_encode
  File "asyncpg/pgproto/./codecs/text.pyx", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size
TypeError: expected str, got list

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
  File "/opt/conda/lib/python3.10/contextlib.py", line 714, in __aexit__
    raise exc_details[1]
  File "/opt/conda/lib/python3.10/contextlib.py", line 697, in __aexit__
    cb_suppress = await cb(*exc_details)
  File "/opt/conda/lib/python3.10/contextlib.py", line 206, in __aexit__
    await anext(self.gen)
  File "/backend/app/core/db.py", line 33, in get_db
    await session.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $3: [-0.03765342757105827, 0.017502993345260... (expected str, got list)
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c975aa81-7032-40c4-a2bb-7be551c01ae0'), None, [-0.03765342757105827, 0.01750299334526062, 0.011062109842896461, -0.005049064755439758, -0.03175562247633934, -0.010383949615061283, 0.02025726996362 ... (8125 characters truncated) ... 040002577006816864, -0.06943027675151825, 0.03584444522857666, -0.028652921319007874, 0.04180312156677246, -0.07624537497758865, -0.03462563455104828], datetime.datetime(2025, 4, 4, 14, 2, 47, 174693, tzinfo=datetime.timezone.utc), None, UUID('2a600b21-57ab-4e6e-8d82-91a74940e8c1'), None, [-0.0012212817091494799, 0.02734282799065113, 0.0705333799123764, 0.018484799191355705, -0.02744639292359352, 0.06440027803182602, -0.0118997646495699 ... (8128 characters truncated) ... 38757529109716415, -0.08042101562023163, 0.012449274770915508, -0.04226856306195259, 0.021666696295142174, -0.05997506156563759, -0.06571448594331741], datetime.datetime(2025, 4, 4, 14, 2, 47, 174704, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-04-04 14:02:47,269 - app.main - INFO - Shutting down application
2025-04-04 14:02:47,269 - app.main - INFO - Shutting down application
2025-04-04 14:02:47,275 - app.main - INFO - Database connections closed successfully
2025-04-04 14:02:47,275 - app.main - INFO - Database connections closed successfully
2025-04-04 14:02:47,692 - watchfiles.main - INFO - 4 changes detected
2025-04-04 14:02:49,955 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:02:50,306 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:02:50,657 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:02:56,166 - app.main - INFO - Starting up application
2025-04-04 14:02:56,166 - app.main - INFO - Starting up application
2025-04-04 14:02:56,228 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:02:56,229 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:02:56,231 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:02:56,232 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:02:56,234 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:02:56,234 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:02:56,236 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:02:56,241 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:02:56,242 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:02:56,246 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:02:56,246 - sqlalchemy.engine.Engine - INFO - [cached since 0.005133s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:02:56,248 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:02:56,248 - sqlalchemy.engine.Engine - INFO - [cached since 0.006824s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:02:56,250 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:02:56,250 - sqlalchemy.engine.Engine - INFO - [cached since 0.008838s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:02:56,252 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:02:56,252 - sqlalchemy.engine.Engine - INFO - [cached since 0.011s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:02:56,254 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:02:56,255 - app.main - INFO - Database tables created successfully
2025-04-04 14:02:56,255 - app.main - INFO - Database tables created successfully
2025-04-04 14:02:56,272 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:03:17,137 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:03:17,165 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:03:17,166 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:03:17,176 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:03:17,177 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:03:17,182 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:03:17,183 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:03:17,190 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:03:17,191 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:03:17,194 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:03:17,194 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:03:17,196 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 14:03:17,196 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:03:17,329 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:03:20,556 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:03:20,556 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:03:20,579 - app - ERROR - Error performing similarity search: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,579 - app - ERROR - Error performing similarity search: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,579 - app.services.rag_service - ERROR - Error getting relevant chunks: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,579 - app.services.rag_service - ERROR - Error getting relevant chunks: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,580 - app.services.rag_service - ERROR - Error querying documents: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,580 - app.services.rag_service - ERROR - Error querying documents: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,581 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 'NoneType' object has no attribute 'execute'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 143, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 79, in query_documents
    chunks = self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 59, in get_relevant_chunks
    similar_chunks = self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 66, in similarity_search
    result = self.db.execute(
AttributeError: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,581 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 'NoneType' object has no attribute 'execute'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 143, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 79, in query_documents
    chunks = self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 59, in get_relevant_chunks
    similar_chunks = self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 66, in similarity_search
    result = self.db.execute(
AttributeError: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:20,582 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 14:03:20,939 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:03:34,789 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:03:34,790 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:03:34,790 - sqlalchemy.engine.Engine - INFO - [cached since 17.63s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:03:34,793 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:03:34,794 - sqlalchemy.engine.Engine - INFO - [cached since 17.62s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:03:34,798 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:03:34,798 - sqlalchemy.engine.Engine - INFO - [cached since 17.62s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:03:34,805 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:03:34,807 - sqlalchemy.engine.Engine - INFO - [cached since 17.62s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:03:34,811 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:03:34,811 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:03:34,831 - app - ERROR - Error performing similarity search: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,831 - app - ERROR - Error performing similarity search: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,832 - app.services.rag_service - ERROR - Error getting relevant chunks: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,832 - app.services.rag_service - ERROR - Error getting relevant chunks: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,832 - app.services.rag_service - ERROR - Error querying documents: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,832 - app.services.rag_service - ERROR - Error querying documents: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,832 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 'NoneType' object has no attribute 'execute'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 143, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 79, in query_documents
    chunks = self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 59, in get_relevant_chunks
    similar_chunks = self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 66, in similarity_search
    result = self.db.execute(
AttributeError: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,832 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 'NoneType' object has no attribute 'execute'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 143, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 79, in query_documents
    chunks = self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 59, in get_relevant_chunks
    similar_chunks = self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 66, in similarity_search
    result = self.db.execute(
AttributeError: 'NoneType' object has no attribute 'execute'
2025-04-04 14:03:34,835 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 14:03:35,077 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:03:35,428 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:05,516 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:05,697 - app.main - INFO - Shutting down application
2025-04-04 14:08:05,697 - app.main - INFO - Shutting down application
2025-04-04 14:08:05,704 - app.main - INFO - Database connections closed successfully
2025-04-04 14:08:05,704 - app.main - INFO - Database connections closed successfully
2025-04-04 14:08:06,125 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:06,476 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:08,491 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:08:08,843 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:16,307 - app.main - INFO - Starting up application
2025-04-04 14:08:16,307 - app.main - INFO - Starting up application
2025-04-04 14:08:16,380 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:08:16,380 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:08:16,385 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:08:16,385 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:08:16,387 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:08:16,388 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:08:16,390 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:08:16,401 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:16,402 - sqlalchemy.engine.Engine - INFO - [generated in 0.00213s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:16,410 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:16,411 - sqlalchemy.engine.Engine - INFO - [cached since 0.01046s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:16,413 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:16,413 - sqlalchemy.engine.Engine - INFO - [cached since 0.01306s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:16,415 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:16,416 - sqlalchemy.engine.Engine - INFO - [cached since 0.01581s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:16,418 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:16,421 - sqlalchemy.engine.Engine - INFO - [cached since 0.02085s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:16,424 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:08:16,426 - app.main - INFO - Database tables created successfully
2025-04-04 14:08:16,426 - app.main - INFO - Database tables created successfully
2025-04-04 14:08:16,625 - watchfiles.main - INFO - 3 changes detected
2025-04-04 14:08:16,728 - app.main - INFO - Shutting down application
2025-04-04 14:08:16,728 - app.main - INFO - Shutting down application
2025-04-04 14:08:16,734 - app.main - INFO - Database connections closed successfully
2025-04-04 14:08:16,734 - app.main - INFO - Database connections closed successfully
2025-04-04 14:08:19,949 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:20,325 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:08:20,679 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:31,742 - app.main - INFO - Starting up application
2025-04-04 14:08:31,742 - app.main - INFO - Starting up application
2025-04-04 14:08:31,811 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:08:31,811 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:08:31,818 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:08:31,818 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:08:31,821 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:08:31,821 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:08:31,824 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:08:31,833 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:31,833 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:31,838 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:31,839 - sqlalchemy.engine.Engine - INFO - [cached since 0.006197s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:31,841 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:31,841 - sqlalchemy.engine.Engine - INFO - [cached since 0.008738s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:31,843 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:31,843 - sqlalchemy.engine.Engine - INFO - [cached since 0.01081s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:31,845 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:08:31,845 - sqlalchemy.engine.Engine - INFO - [cached since 0.01302s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:08:31,848 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:08:31,850 - app.main - INFO - Database tables created successfully
2025-04-04 14:08:31,850 - app.main - INFO - Database tables created successfully
2025-04-04 14:08:32,022 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:32,373 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:47,737 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:47,900 - app.main - INFO - Shutting down application
2025-04-04 14:08:47,900 - app.main - INFO - Shutting down application
2025-04-04 14:08:47,906 - app.main - INFO - Database connections closed successfully
2025-04-04 14:08:47,906 - app.main - INFO - Database connections closed successfully
2025-04-04 14:08:48,330 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:08:48,689 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:04,329 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:09:04,414 - app.main - INFO - Starting up application
2025-04-04 14:09:04,414 - app.main - INFO - Starting up application
2025-04-04 14:09:04,485 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:09:04,485 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:09:04,489 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:09:04,489 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:09:04,491 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:09:04,492 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:09:04,495 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:09:04,502 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:04,503 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:04,507 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:04,507 - sqlalchemy.engine.Engine - INFO - [cached since 0.005094s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:04,509 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:04,509 - sqlalchemy.engine.Engine - INFO - [cached since 0.007426s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:04,512 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:04,513 - sqlalchemy.engine.Engine - INFO - [cached since 0.01069s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:04,515 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:04,516 - sqlalchemy.engine.Engine - INFO - [cached since 0.01358s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:04,518 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:09:04,519 - app.main - INFO - Database tables created successfully
2025-04-04 14:09:04,519 - app.main - INFO - Database tables created successfully
2025-04-04 14:09:04,681 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:17,869 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:18,058 - app.main - INFO - Shutting down application
2025-04-04 14:09:18,058 - app.main - INFO - Shutting down application
2025-04-04 14:09:18,065 - app.main - INFO - Database connections closed successfully
2025-04-04 14:09:18,065 - app.main - INFO - Database connections closed successfully
2025-04-04 14:09:18,472 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:09:19,681 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:09:20,032 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:20,385 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:30,217 - app.main - INFO - Starting up application
2025-04-04 14:09:30,217 - app.main - INFO - Starting up application
2025-04-04 14:09:30,308 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:09:30,308 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:09:30,314 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:09:30,315 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:09:30,319 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:09:30,319 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:09:30,326 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:09:30,336 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:30,337 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:30,350 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:30,351 - sqlalchemy.engine.Engine - INFO - [cached since 0.01467s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:30,359 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:30,363 - sqlalchemy.engine.Engine - INFO - [cached since 0.02695s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:30,366 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:30,367 - sqlalchemy.engine.Engine - INFO - [cached since 0.03137s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:30,370 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:09:30,370 - sqlalchemy.engine.Engine - INFO - [cached since 0.03423s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:09:30,373 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:09:30,377 - app.main - INFO - Database tables created successfully
2025-04-04 14:09:30,377 - app.main - INFO - Database tables created successfully
2025-04-04 14:09:30,521 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:39,852 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:40,005 - app.main - INFO - Shutting down application
2025-04-04 14:09:40,005 - app.main - INFO - Shutting down application
2025-04-04 14:09:40,011 - app.main - INFO - Database connections closed successfully
2025-04-04 14:09:40,011 - app.main - INFO - Database connections closed successfully
2025-04-04 14:09:40,430 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:43,752 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:09:44,103 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:44,455 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:49,774 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:09:50,172 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:50,562 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:53,404 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:09:53,770 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:10:07,046 - app.main - INFO - Starting up application
2025-04-04 14:10:07,046 - app.main - INFO - Starting up application
2025-04-04 14:10:07,124 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:10:07,124 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:10:07,129 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:10:07,129 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:10:07,132 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:10:07,133 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:10:07,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:10:07,142 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:07,142 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:07,146 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:07,147 - sqlalchemy.engine.Engine - INFO - [cached since 0.004871s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:07,148 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:07,148 - sqlalchemy.engine.Engine - INFO - [cached since 0.006481s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:07,150 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:07,151 - sqlalchemy.engine.Engine - INFO - [cached since 0.008905s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:07,154 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:07,154 - sqlalchemy.engine.Engine - INFO - [cached since 0.01211s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:07,156 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:10:07,157 - app.main - INFO - Database tables created successfully
2025-04-04 14:10:07,157 - app.main - INFO - Database tables created successfully
2025-04-04 14:10:07,287 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:10:11,500 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:10:11,672 - app.main - INFO - Shutting down application
2025-04-04 14:10:11,672 - app.main - INFO - Shutting down application
2025-04-04 14:10:11,676 - app.main - INFO - Database connections closed successfully
2025-04-04 14:10:11,676 - app.main - INFO - Database connections closed successfully
2025-04-04 14:10:12,070 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:10:12,421 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:10:14,489 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:10:14,841 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:10:21,598 - app.main - INFO - Starting up application
2025-04-04 14:10:21,598 - app.main - INFO - Starting up application
2025-04-04 14:10:21,661 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:10:21,662 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:10:21,665 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:10:21,665 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:10:21,668 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:10:21,669 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:10:21,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:10:21,676 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:21,677 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:21,681 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:21,681 - sqlalchemy.engine.Engine - INFO - [cached since 0.005091s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:21,683 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:21,683 - sqlalchemy.engine.Engine - INFO - [cached since 0.006688s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:21,685 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:21,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.009353s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:21,687 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:10:21,688 - sqlalchemy.engine.Engine - INFO - [cached since 0.01148s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:10:21,689 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:10:21,690 - app.main - INFO - Database tables created successfully
2025-04-04 14:10:21,690 - app.main - INFO - Database tables created successfully
2025-04-04 14:10:21,710 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:11:55,904 - watchfiles.main - INFO - 7 changes detected
2025-04-04 14:11:56,042 - app.main - INFO - Shutting down application
2025-04-04 14:11:56,042 - app.main - INFO - Shutting down application
2025-04-04 14:11:56,047 - app.main - INFO - Database connections closed successfully
2025-04-04 14:11:56,047 - app.main - INFO - Database connections closed successfully
2025-04-04 14:11:56,503 - watchfiles.main - INFO - 4 changes detected
2025-04-04 14:12:07,913 - app.main - INFO - Starting up application
2025-04-04 14:12:07,913 - app.main - INFO - Starting up application
2025-04-04 14:12:07,978 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:12:07,979 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:12:07,982 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:12:07,982 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:12:07,984 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:12:07,985 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:12:07,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:12:07,996 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:07,996 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:08,000 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:08,001 - sqlalchemy.engine.Engine - INFO - [cached since 0.005211s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:08,002 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:08,002 - sqlalchemy.engine.Engine - INFO - [cached since 0.007069s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:08,005 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:08,005 - sqlalchemy.engine.Engine - INFO - [cached since 0.009663s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:08,006 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:08,007 - sqlalchemy.engine.Engine - INFO - [cached since 0.01142s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:08,009 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:12:08,010 - app.main - INFO - Database tables created successfully
2025-04-04 14:12:08,010 - app.main - INFO - Database tables created successfully
2025-04-04 14:12:08,256 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:12:08,607 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:12:48,077 - __main__ - INFO - Starting development server
2025-04-04 14:12:56,888 - app.main - INFO - Starting up application
2025-04-04 14:12:56,888 - app.main - INFO - Starting up application
2025-04-04 14:12:56,945 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:12:56,945 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:12:56,949 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:12:56,949 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:12:56,951 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:12:56,951 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:12:56,954 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:12:56,959 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:56,959 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:56,962 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:56,963 - sqlalchemy.engine.Engine - INFO - [cached since 0.004133s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:56,964 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:56,964 - sqlalchemy.engine.Engine - INFO - [cached since 0.005787s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:56,966 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:56,966 - sqlalchemy.engine.Engine - INFO - [cached since 0.007918s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:56,968 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:12:56,968 - sqlalchemy.engine.Engine - INFO - [cached since 0.009872s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:12:56,970 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:12:56,971 - app.main - INFO - Database tables created successfully
2025-04-04 14:12:56,971 - app.main - INFO - Database tables created successfully
2025-04-04 14:12:57,175 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:12:57,527 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:13:23,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:13:23,217 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:13:23,217 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:13:23,229 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:13:23,229 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:13:23,236 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:13:23,237 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:13:23,242 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:13:23,243 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:13:23,282 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:13:23,282 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (UUID('c2ae64b1-be88-44ff-b92e-3da8945a2394'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 14, 13, 23, 282183, tzinfo=datetime.timezone.utc))
2025-04-04 14:13:23,289 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:13:23,293 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:13:23,293 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:13:23,299 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 14:13:23,299 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:13:23,349 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:13:23,700 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:13:27,940 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:13:27,940 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:13:28,150 - app.services.document_processing_service - INFO - Successfully processed document c2ae64b1-be88-44ff-b92e-3da8945a2394 into 2 chunks
2025-04-04 14:13:28,150 - app.services.document_processing_service - INFO - Successfully processed document c2ae64b1-be88-44ff-b92e-3da8945a2394 into 2 chunks
2025-04-04 14:13:28,151 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:13:28,151 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:13:28,152 - app.services.rag_service - INFO - Successfully processed note c2ae64b1-be88-44ff-b92e-3da8945a2394
2025-04-04 14:13:28,152 - app.services.rag_service - INFO - Successfully processed note c2ae64b1-be88-44ff-b92e-3da8945a2394
2025-04-04 14:13:28,156 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:13:28,160 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:13:28,160 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s (insertmanyvalues) 1/1 (unordered)] (UUID('359240ae-9a0c-4b6b-9321-c6cb9bb9ee79'), UUID('c2ae64b1-be88-44ff-b92e-3da8945a2394'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 13, 28, 159840, tzinfo=datetime.timezone.utc), None, UUID('6fd0c206-6371-49c0-9d74-b08906003f21'), UUID('c2ae64b1-be88-44ff-b92e-3da8945a2394'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 13, 28, 159856, tzinfo=datetime.timezone.utc), None)
2025-04-04 14:13:28,162 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:13:28,169 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:13:28,169 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s (insertmanyvalues) 1/1 (unordered)] (UUID('c1c21311-4b63-4f82-ba56-7a5ebbb585f0'), None, '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168020, tzinfo=datetime.timezone.utc), None, UUID('73a6389c-3ae7-48d2-8b1f-9c8ca7c95cc8'), None, '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168035, tzinfo=datetime.timezone.utc), None)
2025-04-04 14:13:28,197 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 14:13:28,201 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c1c21311-4b63-4f82-ba56-7a5ebbb585f0'), None, '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168020, tzinfo=datetime.timezone.utc), None, UUID('73a6389c-3ae7-48d2-8b1f-9c8ca7c95cc8'), None, '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168035, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.NotNullViolationError: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
  File "/opt/conda/lib/python3.10/contextlib.py", line 714, in __aexit__
    raise exc_details[1]
  File "/opt/conda/lib/python3.10/contextlib.py", line 697, in __aexit__
    cb_suppress = await cb(*exc_details)
  File "/opt/conda/lib/python3.10/contextlib.py", line 206, in __aexit__
    await anext(self.gen)
  File "/backend/app/core/db.py", line 33, in get_db
    await session.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c1c21311-4b63-4f82-ba56-7a5ebbb585f0'), None, '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168020, tzinfo=datetime.timezone.utc), None, UUID('73a6389c-3ae7-48d2-8b1f-9c8ca7c95cc8'), None, '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168035, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-04 14:13:28,201 - app.main - ERROR - Unhandled exception during request processing: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c1c21311-4b63-4f82-ba56-7a5ebbb585f0'), None, '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168020, tzinfo=datetime.timezone.utc), None, UUID('73a6389c-3ae7-48d2-8b1f-9c8ca7c95cc8'), None, '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168035, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.NotNullViolationError: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 290, in app
    async with AsyncExitStack() as async_exit_stack:
  File "/opt/conda/lib/python3.10/contextlib.py", line 714, in __aexit__
    raise exc_details[1]
  File "/opt/conda/lib/python3.10/contextlib.py", line 697, in __aexit__
    cb_suppress = await cb(*exc_details)
  File "/opt/conda/lib/python3.10/contextlib.py", line 206, in __aexit__
    await anext(self.gen)
  File "/backend/app/core/db.py", line 33, in get_db
    await session.commit()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "chunk_id" of relation "document_embeddings" violates not-null constraint
DETAIL:  Failing row contains (c1c21311-4b63-4f82-ba56-7a5ebbb585f0, null, [-0.037653428,0.017502993,0.01106211,-0.0050490648,-0.031755622,..., 2025-04-04 14:13:28.16802+00, null).
[SQL: INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('c1c21311-4b63-4f82-ba56-7a5ebbb585f0'), None, '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168020, tzinfo=datetime.timezone.utc), None, UUID('73a6389c-3ae7-48d2-8b1f-9c8ca7c95cc8'), None, '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 14, 13, 28, 168035, tzinfo=datetime.timezone.utc), None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-04 14:13:28,513 - watchfiles.main - INFO - 3 changes detected
2025-04-04 14:15:46,283 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:15:46,437 - app.main - INFO - Shutting down application
2025-04-04 14:15:46,437 - app.main - INFO - Shutting down application
2025-04-04 14:15:46,443 - app.main - INFO - Database connections closed successfully
2025-04-04 14:15:46,443 - app.main - INFO - Database connections closed successfully
2025-04-04 14:15:46,954 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:15:51,990 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:15:52,342 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:15:52,693 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:15:54,399 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:15:54,780 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:15:57,137 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:15:57,490 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:16:04,346 - app.main - INFO - Starting up application
2025-04-04 14:16:04,346 - app.main - INFO - Starting up application
2025-04-04 14:16:04,412 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:16:04,412 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:16:04,415 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:16:04,416 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:16:04,418 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:16:04,418 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:16:04,421 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:16:04,427 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:04,427 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:04,431 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:04,432 - sqlalchemy.engine.Engine - INFO - [cached since 0.004782s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:04,434 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:04,434 - sqlalchemy.engine.Engine - INFO - [cached since 0.007594s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:04,437 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:04,437 - sqlalchemy.engine.Engine - INFO - [cached since 0.01017s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:04,439 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:04,439 - sqlalchemy.engine.Engine - INFO - [cached since 0.01218s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:04,441 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:16:04,442 - app.main - INFO - Database tables created successfully
2025-04-04 14:16:04,442 - app.main - INFO - Database tables created successfully
2025-04-04 14:16:04,660 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:16:17,075 - __main__ - INFO - Starting development server
2025-04-04 14:16:29,664 - app.main - INFO - Starting up application
2025-04-04 14:16:29,664 - app.main - INFO - Starting up application
2025-04-04 14:16:29,729 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:16:29,730 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:16:29,733 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:16:29,733 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:16:29,736 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:16:29,736 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:16:29,739 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:16:29,746 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:29,746 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:29,751 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:29,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.005957s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:29,754 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:29,754 - sqlalchemy.engine.Engine - INFO - [cached since 0.008248s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:29,756 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:29,756 - sqlalchemy.engine.Engine - INFO - [cached since 0.01005s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:29,758 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:16:29,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.01226s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:16:29,760 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:16:29,761 - app.main - INFO - Database tables created successfully
2025-04-04 14:16:29,761 - app.main - INFO - Database tables created successfully
2025-04-04 14:16:29,791 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:16:49,674 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:16:49,757 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:16:49,757 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:16:49,790 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:16:49,791 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:49,809 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:16:49,810 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:49,828 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:16:49,828 - sqlalchemy.engine.Engine - INFO - [generated in 0.00075s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:49,832 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:16:49,832 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:16:49,843 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 14:16:49,845 - sqlalchemy.engine.Engine - INFO - [generated in 0.00200s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:49,859 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:16:49,861 - sqlalchemy.engine.Engine - INFO - [generated in 0.00307s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:49,868 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:16:49,961 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:16:55,113 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:16:55,115 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:16:55,115 - sqlalchemy.engine.Engine - INFO - [cached since 5.359s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:16:55,121 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:16:55,121 - sqlalchemy.engine.Engine - INFO - [cached since 5.331s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:55,127 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:16:55,128 - sqlalchemy.engine.Engine - INFO - [cached since 5.319s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:55,132 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:16:55,133 - sqlalchemy.engine.Engine - INFO - [cached since 5.305s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:16:55,156 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:16:55,157 - sqlalchemy.engine.Engine - INFO - [generated in 0.00123s] (UUID('01a97d16-cbb8-4972-ac89-5b2aba14c853'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 14, 16, 55, 156721, tzinfo=datetime.timezone.utc))
2025-04-04 14:16:55,161 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:16:55,173 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:16:55,173 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:16:55,176 - app.services.document_processing_service - ERROR - Document chunk missing ID after flush
2025-04-04 14:16:55,176 - app.services.document_processing_service - ERROR - Document chunk missing ID after flush
2025-04-04 14:16:55,177 - app.services.document_processing_service - ERROR - Document chunk missing ID after flush
2025-04-04 14:16:55,177 - app.services.document_processing_service - ERROR - Document chunk missing ID after flush
2025-04-04 14:16:55,177 - app.services.document_processing_service - INFO - Successfully processed document 01a97d16-cbb8-4972-ac89-5b2aba14c853 into 2 chunks
2025-04-04 14:16:55,177 - app.services.document_processing_service - INFO - Successfully processed document 01a97d16-cbb8-4972-ac89-5b2aba14c853 into 2 chunks
2025-04-04 14:16:55,178 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:16:55,178 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:16:55,178 - app.services.rag_service - INFO - Successfully processed note 01a97d16-cbb8-4972-ac89-5b2aba14c853
2025-04-04 14:16:55,178 - app.services.rag_service - INFO - Successfully processed note 01a97d16-cbb8-4972-ac89-5b2aba14c853
2025-04-04 14:16:55,180 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:16:55,184 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:16:55,185 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s (insertmanyvalues) 1/1 (unordered)] (UUID('7b3154e8-f7f3-4118-96de-1a190f4809ea'), UUID('01a97d16-cbb8-4972-ac89-5b2aba14c853'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 16, 55, 183961, tzinfo=datetime.timezone.utc), None, UUID('e5ac4d23-7a9a-442d-b30a-6688b3bad4dd'), UUID('01a97d16-cbb8-4972-ac89-5b2aba14c853'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 16, 55, 183988, tzinfo=datetime.timezone.utc), None)
2025-04-04 14:16:55,192 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:16:55,578 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:18:44,593 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:18:44,766 - app.main - INFO - Shutting down application
2025-04-04 14:18:44,766 - app.main - INFO - Shutting down application
2025-04-04 14:18:44,775 - app.main - INFO - Database connections closed successfully
2025-04-04 14:18:44,775 - app.main - INFO - Database connections closed successfully
2025-04-04 14:18:45,234 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:18:45,596 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:18:49,742 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:18:50,094 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:18:50,444 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:18:57,148 - app.main - INFO - Starting up application
2025-04-04 14:18:57,148 - app.main - INFO - Starting up application
2025-04-04 14:18:57,212 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:18:57,213 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:18:57,216 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:18:57,216 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:18:57,219 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:18:57,220 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:18:57,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:18:57,228 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:18:57,229 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:18:57,233 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:18:57,233 - sqlalchemy.engine.Engine - INFO - [cached since 0.00496s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:18:57,235 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:18:57,235 - sqlalchemy.engine.Engine - INFO - [cached since 0.006886s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:18:57,237 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:18:57,238 - sqlalchemy.engine.Engine - INFO - [cached since 0.009554s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:18:57,239 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:18:57,240 - sqlalchemy.engine.Engine - INFO - [cached since 0.0117s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:18:57,241 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:18:57,243 - app.main - INFO - Database tables created successfully
2025-04-04 14:18:57,243 - app.main - INFO - Database tables created successfully
2025-04-04 14:18:57,314 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:19:16,869 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:19:16,995 - app.main - INFO - Shutting down application
2025-04-04 14:19:16,995 - app.main - INFO - Shutting down application
2025-04-04 14:19:17,002 - app.main - INFO - Database connections closed successfully
2025-04-04 14:19:17,002 - app.main - INFO - Database connections closed successfully
2025-04-04 14:19:17,432 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:19:17,784 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:19:19,242 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:19:19,593 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:19:27,922 - app.main - INFO - Starting up application
2025-04-04 14:19:27,922 - app.main - INFO - Starting up application
2025-04-04 14:19:27,988 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:19:27,988 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:19:27,992 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:19:27,992 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:19:27,995 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:19:27,995 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:19:27,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:19:28,004 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:19:28,004 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:19:28,010 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:19:28,011 - sqlalchemy.engine.Engine - INFO - [cached since 0.00735s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:19:28,013 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:19:28,013 - sqlalchemy.engine.Engine - INFO - [cached since 0.009589s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:19:28,015 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:19:28,016 - sqlalchemy.engine.Engine - INFO - [cached since 0.01208s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:19:28,018 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:19:28,018 - sqlalchemy.engine.Engine - INFO - [cached since 0.01449s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:19:28,020 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:19:28,021 - app.main - INFO - Database tables created successfully
2025-04-04 14:19:28,021 - app.main - INFO - Database tables created successfully
2025-04-04 14:19:28,272 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:20:37,240 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:20:37,432 - app.main - INFO - Shutting down application
2025-04-04 14:20:37,432 - app.main - INFO - Shutting down application
2025-04-04 14:20:37,438 - app.main - INFO - Database connections closed successfully
2025-04-04 14:20:37,438 - app.main - INFO - Database connections closed successfully
2025-04-04 14:20:37,848 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:20:40,558 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:20:40,910 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:20:49,804 - app.main - INFO - Starting up application
2025-04-04 14:20:49,804 - app.main - INFO - Starting up application
2025-04-04 14:20:50,000 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:20:50,001 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:20:50,036 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:20:50,037 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:20:50,041 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:20:50,041 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:20:50,048 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:20:50,065 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:20:50,066 - sqlalchemy.engine.Engine - INFO - [generated in 0.00371s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:20:50,083 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:20:50,089 - sqlalchemy.engine.Engine - INFO - [cached since 0.02681s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:20:50,091 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:20:50,092 - sqlalchemy.engine.Engine - INFO - [cached since 0.03009s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:20:50,095 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:20:50,098 - sqlalchemy.engine.Engine - INFO - [cached since 0.03643s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:20:50,107 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:20:50,108 - sqlalchemy.engine.Engine - INFO - [cached since 0.04613s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:20:50,112 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:20:50,114 - app.main - INFO - Database tables created successfully
2025-04-04 14:20:50,114 - app.main - INFO - Database tables created successfully
2025-04-04 14:20:50,207 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:21:01,036 - __main__ - INFO - Starting development server
2025-04-04 14:21:12,459 - app.main - INFO - Starting up application
2025-04-04 14:21:12,459 - app.main - INFO - Starting up application
2025-04-04 14:21:12,533 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:21:12,533 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:21:12,537 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:21:12,538 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:21:12,541 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:21:12,542 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:21:12,545 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:21:12,551 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:21:12,551 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:21:12,555 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:21:12,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.004595s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:21:12,557 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:21:12,557 - sqlalchemy.engine.Engine - INFO - [cached since 0.00651s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:21:12,559 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:21:12,559 - sqlalchemy.engine.Engine - INFO - [cached since 0.008324s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:21:12,561 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:21:12,562 - sqlalchemy.engine.Engine - INFO - [cached since 0.01085s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:21:12,564 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:21:12,565 - app.main - INFO - Database tables created successfully
2025-04-04 14:21:12,565 - app.main - INFO - Database tables created successfully
2025-04-04 14:21:12,828 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:21:30,980 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:21:31,011 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:21:31,011 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:21:31,023 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:21:31,024 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:21:31,032 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:21:31,032 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:21:31,039 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:21:31,040 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:21:31,068 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:21:31,068 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] (UUID('9e80345d-6be2-441e-891d-edb69612c4ff'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\nDr Abayomi Okediji\t \t\t\t\t\tMarch 26, 2025\nDepartment of Psychology\nFaculty of Social Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (1514 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Dr-Abayomi.docx', datetime.datetime(2025, 4, 4, 14, 21, 31, 68257, tzinfo=datetime.timezone.utc))
2025-04-04 14:21:31,076 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:21:31,081 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:21:31,081 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 14:21:31,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:21:31,087 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:21:31,093 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s (insertmanyvalues) 1/1 (unordered)] (UUID('c271fdee-00d6-49f9-9d0b-ec1b5b4e7bf3'), UUID('9e80345d-6be2-441e-891d-edb69612c4ff'), 'Dr Abayomi Okediji\t \t\t\t\t\tMarch 26, 2025\nDepartment of Psychology\nFaculty of Social Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear  O ... (603 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 21, 31, 86201, tzinfo=datetime.timezone.utc), None, UUID('51eee5fb-eab3-4430-a95a-ce4bc74db029'), UUID('9e80345d-6be2-441e-891d-edb69612c4ff'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 14, 21, 31, 86220, tzinfo=datetime.timezone.utc), None)
2025-04-04 14:21:31,105 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 14:21:31,105 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:21:31,182 - watchfiles.main - INFO - 3 changes detected
2025-04-04 14:21:36,056 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:21:36,056 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 14:21:36,177 - app.services.document_processing_service - INFO - Successfully processed document 9e80345d-6be2-441e-891d-edb69612c4ff into 2 chunks
2025-04-04 14:21:36,177 - app.services.document_processing_service - INFO - Successfully processed document 9e80345d-6be2-441e-891d-edb69612c4ff into 2 chunks
2025-04-04 14:21:36,177 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:21:36,177 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 14:21:36,178 - app.services.rag_service - INFO - Successfully processed note 9e80345d-6be2-441e-891d-edb69612c4ff
2025-04-04 14:21:36,178 - app.services.rag_service - INFO - Successfully processed note 9e80345d-6be2-441e-891d-edb69612c4ff
2025-04-04 14:21:36,183 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 14:21:36,184 - sqlalchemy.engine.Engine - INFO - [generated in 0.00210s (insertmanyvalues) 1/1 (unordered)] (UUID('51268e87-d0e3-4af2-9204-f7b9b3e2433e'), UUID('c271fdee-00d6-49f9-9d0b-ec1b5b4e7bf3'), '[-0.013306285254657269,0.02345314621925354,0.023026175796985626,0.039815276861190796,-0.0295895766466856,-0.006226738449186087,0.02607959695160389,-0 ... (7757 characters truncated) ... 32,0.02708977274596691,-0.0764663890004158,0.06252836436033249,-0.0029542187694460154,0.06845485419034958,-0.07617514580488205,-0.045501019805669785]', datetime.datetime(2025, 4, 4, 14, 21, 36, 181357, tzinfo=datetime.timezone.utc), None, UUID('b26d1c29-a03c-4153-ba08-ecd8441fd687'), UUID('51eee5fb-eab3-4430-a95a-ce4bc74db029'), '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 14, 21, 36, 181369, tzinfo=datetime.timezone.utc), None)
2025-04-04 14:21:36,201 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:21:36,298 - watchfiles.main - INFO - 3 changes detected
2025-04-04 14:22:17,916 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:22:17,917 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 14:22:17,918 - sqlalchemy.engine.Engine - INFO - [cached since 46.91s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 14:22:17,922 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 14:22:17,922 - sqlalchemy.engine.Engine - INFO - [cached since 46.9s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:22:17,927 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:22:17,927 - sqlalchemy.engine.Engine - INFO - [cached since 46.9s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:22:17,931 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 14:22:17,931 - sqlalchemy.engine.Engine - INFO - [cached since 46.89s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 14:22:17,934 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:22:17,934 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 14:22:17,955 - app - ERROR - Error performing similarity search: 'coroutine' object is not iterable
2025-04-04 14:22:17,955 - app - ERROR - Error performing similarity search: 'coroutine' object is not iterable
2025-04-04 14:22:17,956 - app.services.rag_service - ERROR - Error getting relevant chunks: 'coroutine' object is not iterable
2025-04-04 14:22:17,956 - app.services.rag_service - ERROR - Error getting relevant chunks: 'coroutine' object is not iterable
2025-04-04 14:22:17,956 - app.services.rag_service - ERROR - Error querying documents: 'coroutine' object is not iterable
2025-04-04 14:22:17,956 - app.services.rag_service - ERROR - Error querying documents: 'coroutine' object is not iterable
2025-04-04 14:22:17,957 - app.api.endpoints.chat - ERROR - Type error in chat endpoint: 'coroutine' object is not iterable
2025-04-04 14:22:17,957 - app.api.endpoints.chat - ERROR - Type error in chat endpoint: 'coroutine' object is not iterable
2025-04-04 14:22:17,957 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 14:22:17,960 - app.main - ERROR - Unhandled exception during request processing: 'coroutine' object is not iterable
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 148, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 86, in similarity_search
    for row in result:
TypeError: 'coroutine' object is not iterable
2025-04-04 14:22:17,960 - app.main - ERROR - Unhandled exception during request processing: 'coroutine' object is not iterable
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 148, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 86, in similarity_search
    for row in result:
TypeError: 'coroutine' object is not iterable
2025-04-04 14:22:18,120 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:22:18,471 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:26:54,672 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:26:54,849 - app.main - INFO - Shutting down application
2025-04-04 14:26:54,849 - app.main - INFO - Shutting down application
2025-04-04 14:26:54,855 - app.main - INFO - Database connections closed successfully
2025-04-04 14:26:54,855 - app.main - INFO - Database connections closed successfully
2025-04-04 14:26:55,252 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:26:55,603 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:07,006 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:27:07,311 - app.main - INFO - Starting up application
2025-04-04 14:27:07,311 - app.main - INFO - Starting up application
2025-04-04 14:27:07,358 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:07,442 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:27:07,443 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:27:07,448 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:27:07,449 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:27:07,452 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:27:07,453 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:27:07,460 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:27:07,469 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:07,469 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:07,478 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:07,478 - sqlalchemy.engine.Engine - INFO - [cached since 0.009708s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:07,480 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:07,481 - sqlalchemy.engine.Engine - INFO - [cached since 0.01246s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:07,484 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:07,484 - sqlalchemy.engine.Engine - INFO - [cached since 0.0156s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:07,487 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:07,487 - sqlalchemy.engine.Engine - INFO - [cached since 0.01906s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:07,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:27:07,492 - app.main - INFO - Database tables created successfully
2025-04-04 14:27:07,492 - app.main - INFO - Database tables created successfully
2025-04-04 14:27:07,709 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:32,028 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:32,158 - app.main - INFO - Shutting down application
2025-04-04 14:27:32,158 - app.main - INFO - Shutting down application
2025-04-04 14:27:32,164 - app.main - INFO - Database connections closed successfully
2025-04-04 14:27:32,164 - app.main - INFO - Database connections closed successfully
2025-04-04 14:27:32,552 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:27:34,111 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:27:34,462 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:43,739 - app.main - INFO - Starting up application
2025-04-04 14:27:43,739 - app.main - INFO - Starting up application
2025-04-04 14:27:43,806 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:27:43,806 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:27:43,810 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:27:43,811 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:27:43,813 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:27:43,814 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:27:43,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:27:43,824 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:43,825 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:43,829 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:43,829 - sqlalchemy.engine.Engine - INFO - [cached since 0.004931s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:43,830 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:43,831 - sqlalchemy.engine.Engine - INFO - [cached since 0.006754s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:43,833 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:43,833 - sqlalchemy.engine.Engine - INFO - [cached since 0.009107s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:43,835 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:27:43,836 - sqlalchemy.engine.Engine - INFO - [cached since 0.01168s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:27:43,838 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:27:43,840 - app.main - INFO - Database tables created successfully
2025-04-04 14:27:43,840 - app.main - INFO - Database tables created successfully
2025-04-04 14:27:44,038 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:44,389 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:49,153 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:27:49,259 - app.main - INFO - Shutting down application
2025-04-04 14:27:49,259 - app.main - INFO - Shutting down application
2025-04-04 14:27:49,265 - app.main - INFO - Database connections closed successfully
2025-04-04 14:27:49,265 - app.main - INFO - Database connections closed successfully
2025-04-04 14:27:49,678 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:28:00,619 - watchfiles.main - INFO - 3 changes detected
2025-04-04 14:28:01,024 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:28:01,375 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:28:02,127 - watchfiles.main - INFO - 2 changes detected
2025-04-04 14:28:02,478 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:28:11,607 - app.main - INFO - Starting up application
2025-04-04 14:28:11,607 - app.main - INFO - Starting up application
2025-04-04 14:28:11,676 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:28:11,676 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:28:11,680 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:28:11,681 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:28:11,684 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:28:11,685 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:28:11,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:28:11,694 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:11,694 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:11,700 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:11,700 - sqlalchemy.engine.Engine - INFO - [cached since 0.006625s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:11,702 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:11,703 - sqlalchemy.engine.Engine - INFO - [cached since 0.008968s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:11,705 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:11,705 - sqlalchemy.engine.Engine - INFO - [cached since 0.01142s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:11,707 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:11,707 - sqlalchemy.engine.Engine - INFO - [cached since 0.01321s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:11,709 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:28:11,710 - app.main - INFO - Database tables created successfully
2025-04-04 14:28:11,710 - app.main - INFO - Database tables created successfully
2025-04-04 14:28:11,760 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:28:33,737 - __main__ - INFO - Starting development server
2025-04-04 14:28:42,947 - app.main - INFO - Starting up application
2025-04-04 14:28:42,947 - app.main - INFO - Starting up application
2025-04-04 14:28:43,041 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 14:28:43,041 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:28:43,046 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 14:28:43,046 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:28:43,049 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 14:28:43,050 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 14:28:43,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 14:28:43,060 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:43,060 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:43,065 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:43,066 - sqlalchemy.engine.Engine - INFO - [cached since 0.005983s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:43,068 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:43,069 - sqlalchemy.engine.Engine - INFO - [cached since 0.00906s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:43,071 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:43,072 - sqlalchemy.engine.Engine - INFO - [cached since 0.01182s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:43,074 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 14:28:43,074 - sqlalchemy.engine.Engine - INFO - [cached since 0.0144s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 14:28:43,078 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 14:28:43,080 - app.main - INFO - Database tables created successfully
2025-04-04 14:28:43,080 - app.main - INFO - Database tables created successfully
2025-04-04 14:28:43,123 - watchfiles.main - INFO - 1 change detected
2025-04-04 14:28:43,474 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:48:45,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:48:45,656 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-04 18:48:45,656 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ('jamiebones2000@yahoo.co.uk',)
2025-04-04 18:48:45,671 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:48:45,671 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:45,680 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:45,681 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:45,687 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:45,688 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:45,691 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-04 18:48:45,863 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:48:45,988 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:48:46,145 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:48:46,148 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:48:46,148 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:48:46,156 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:48:46,156 - sqlalchemy.engine.Engine - INFO - [cached since 0.4855s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,164 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:46,165 - sqlalchemy.engine.Engine - INFO - [cached since 0.4847s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,169 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:46,170 - sqlalchemy.engine.Engine - INFO - [cached since 0.4827s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,175 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:48:46,175 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:48:46,180 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 18:48:46,180 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,190 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:46,191 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,197 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:48:46,221 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:48:46,226 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:48:46,226 - sqlalchemy.engine.Engine - INFO - [cached since 0.07887s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:48:46,229 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:48:46,229 - sqlalchemy.engine.Engine - INFO - [cached since 0.5588s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,233 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:46,234 - sqlalchemy.engine.Engine - INFO - [cached since 0.5535s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,242 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:46,242 - sqlalchemy.engine.Engine - INFO - [cached since 0.5548s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,245 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:48:46,245 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:48:46,247 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 18:48:46,248 - sqlalchemy.engine.Engine - INFO - [cached since 0.06785s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,251 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:46,252 - sqlalchemy.engine.Engine - INFO - [cached since 0.06176s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:46,256 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:48:46,466 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:48:57,319 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:48:57,320 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:48:57,320 - sqlalchemy.engine.Engine - INFO - [cached since 11.17s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:48:57,324 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:48:57,324 - sqlalchemy.engine.Engine - INFO - [cached since 11.65s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:57,328 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:57,328 - sqlalchemy.engine.Engine - INFO - [cached since 11.65s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:57,332 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:48:57,332 - sqlalchemy.engine.Engine - INFO - [cached since 11.64s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:48:57,362 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:48:57,363 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] (UUID('9c6ee247-c894-46a1-a0a5-6332cc5c218d'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 18, 48, 57, 362823, tzinfo=datetime.timezone.utc))
2025-04-04 18:48:57,367 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:48:57,373 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:48:57,373 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:48:57,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:48:57,378 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:48:57,378 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s (insertmanyvalues) 1/1 (unordered)] (UUID('abbdfe45-ee41-40f2-9a6b-c6997c7c61e1'), UUID('9c6ee247-c894-46a1-a0a5-6332cc5c218d'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 48, 57, 377787, tzinfo=datetime.timezone.utc), None, UUID('1aaf3067-9034-4c73-a65b-9becfa873b57'), UUID('9c6ee247-c894-46a1-a0a5-6332cc5c218d'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 48, 57, 377804, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:48:57,387 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 18:48:57,388 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:48:57,596 - watchfiles.main - INFO - 3 changes detected
2025-04-04 18:49:02,140 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:49:02,140 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:49:02,278 - app.services.document_processing_service - INFO - Successfully processed document 9c6ee247-c894-46a1-a0a5-6332cc5c218d into 2 chunks
2025-04-04 18:49:02,278 - app.services.document_processing_service - INFO - Successfully processed document 9c6ee247-c894-46a1-a0a5-6332cc5c218d into 2 chunks
2025-04-04 18:49:02,279 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:49:02,279 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:49:02,279 - app.services.rag_service - INFO - Successfully processed note 9c6ee247-c894-46a1-a0a5-6332cc5c218d
2025-04-04 18:49:02,279 - app.services.rag_service - INFO - Successfully processed note 9c6ee247-c894-46a1-a0a5-6332cc5c218d
2025-04-04 18:49:02,283 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:49:02,283 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s (insertmanyvalues) 1/1 (unordered)] (UUID('ba7dbcd2-28e9-4a8e-a115-c21963a3295a'), UUID('abbdfe45-ee41-40f2-9a6b-c6997c7c61e1'), '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 18, 49, 2, 282414, tzinfo=datetime.timezone.utc), None, UUID('5512f39e-05d8-49dc-977c-fdd9d8190af8'), UUID('1aaf3067-9034-4c73-a65b-9becfa873b57'), '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 18, 49, 2, 282451, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:49:02,303 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:49:02,408 - watchfiles.main - INFO - 3 changes detected
2025-04-04 18:49:17,728 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:49:17,729 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:49:17,730 - sqlalchemy.engine.Engine - INFO - [cached since 31.58s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:49:17,734 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:49:17,736 - sqlalchemy.engine.Engine - INFO - [cached since 32.07s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:49:17,741 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:49:17,742 - sqlalchemy.engine.Engine - INFO - [cached since 32.06s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:49:17,747 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:49:17,747 - sqlalchemy.engine.Engine - INFO - [cached since 32.06s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:49:17,750 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:49:17,750 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:49:17,776 - sqlalchemy.engine.Engine - INFO - 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            
2025-04-04 18:49:17,776 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)
2025-04-04 18:49:17,779 - app - ERROR - Error performing similarity search: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,779 - app - ERROR - Error performing similarity search: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,780 - app.services.rag_service - ERROR - Error getting relevant chunks: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,780 - app.services.rag_service - ERROR - Error getting relevant chunks: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,780 - app.services.rag_service - ERROR - Error querying documents: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,780 - app.services.rag_service - ERROR - Error querying documents: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,781 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near ":"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,781 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near ":"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ":"
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> :query_embedding::vector(384)
                LIMIT $2
            ]
[parameters: (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 5)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:49:17,796 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 18:49:18,052 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:49:18,403 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:38,246 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:38,389 - app.main - INFO - Shutting down application
2025-04-04 18:51:38,389 - app.main - INFO - Shutting down application
2025-04-04 18:51:38,398 - app.main - INFO - Database connections closed successfully
2025-04-04 18:51:38,398 - app.main - INFO - Database connections closed successfully
2025-04-04 18:51:38,815 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:50,928 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:51:51,279 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:51,553 - app.main - INFO - Starting up application
2025-04-04 18:51:51,553 - app.main - INFO - Starting up application
2025-04-04 18:51:51,631 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:51,692 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:51:51,692 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:51:51,698 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:51:51,700 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:51:51,705 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:51:51,706 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:51:51,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:51:51,721 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:51:51,722 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:51:51,727 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:51:51,728 - sqlalchemy.engine.Engine - INFO - [cached since 0.006586s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:51:51,731 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:51:51,732 - sqlalchemy.engine.Engine - INFO - [cached since 0.01065s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:51:51,734 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:51:51,735 - sqlalchemy.engine.Engine - INFO - [cached since 0.01358s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:51:51,738 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:51:51,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.01707s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:51:51,740 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:51:51,742 - app.main - INFO - Database tables created successfully
2025-04-04 18:51:51,742 - app.main - INFO - Database tables created successfully
2025-04-04 18:51:55,445 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:55,552 - app.main - INFO - Shutting down application
2025-04-04 18:51:55,552 - app.main - INFO - Shutting down application
2025-04-04 18:51:55,557 - app.main - INFO - Database connections closed successfully
2025-04-04 18:51:55,557 - app.main - INFO - Database connections closed successfully
2025-04-04 18:51:55,986 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:57,547 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:51:57,911 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:52:07,488 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:52:07,835 - app.main - INFO - Starting up application
2025-04-04 18:52:07,835 - app.main - INFO - Starting up application
2025-04-04 18:52:07,840 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:52:07,913 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:52:07,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:52:07,919 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:52:07,919 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:52:07,922 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:52:07,922 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:52:07,925 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:52:07,933 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:07,933 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:07,938 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:07,939 - sqlalchemy.engine.Engine - INFO - [cached since 0.006034s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:07,941 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:07,941 - sqlalchemy.engine.Engine - INFO - [cached since 0.008476s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:07,943 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:07,943 - sqlalchemy.engine.Engine - INFO - [cached since 0.01074s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:07,945 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:07,946 - sqlalchemy.engine.Engine - INFO - [cached since 0.01314s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:07,948 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:52:07,949 - app.main - INFO - Database tables created successfully
2025-04-04 18:52:07,949 - app.main - INFO - Database tables created successfully
2025-04-04 18:52:35,467 - __main__ - INFO - Starting development server
2025-04-04 18:52:43,626 - app.main - INFO - Starting up application
2025-04-04 18:52:43,626 - app.main - INFO - Starting up application
2025-04-04 18:52:43,684 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:52:43,684 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:52:43,687 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:52:43,688 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:52:43,690 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:52:43,690 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:52:43,692 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:52:43,697 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:43,697 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:43,701 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:43,701 - sqlalchemy.engine.Engine - INFO - [cached since 0.004395s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:43,703 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:43,703 - sqlalchemy.engine.Engine - INFO - [cached since 0.006415s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:43,704 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:43,705 - sqlalchemy.engine.Engine - INFO - [cached since 0.008523s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:43,707 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:52:43,707 - sqlalchemy.engine.Engine - INFO - [cached since 0.01062s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:52:43,709 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:52:43,710 - app.main - INFO - Database tables created successfully
2025-04-04 18:52:43,710 - app.main - INFO - Database tables created successfully
2025-04-04 18:52:43,948 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:53:13,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:53:13,764 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:53:13,765 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:53:13,774 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:53:13,774 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:53:13,780 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:53:13,781 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:53:13,786 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:53:13,786 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:53:13,801 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:53:13,802 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (UUID('a7cab9a8-8792-4f3e-879d-93a63b9243d7'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\nDr Abayomi Okediji\t \t\t\t\t\tMarch 26, 2025\nDepartment of Psychology\nFaculty of Social Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (1514 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Dr-Abayomi.docx', datetime.datetime(2025, 4, 4, 18, 53, 13, 801747, tzinfo=datetime.timezone.utc))
2025-04-04 18:53:13,805 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:53:13,808 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:53:13,808 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:53:13,809 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:53:13,812 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:53:13,812 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s (insertmanyvalues) 1/1 (unordered)] (UUID('67de5e92-7053-4543-8859-b3a8f23b5bd8'), UUID('a7cab9a8-8792-4f3e-879d-93a63b9243d7'), 'Dr Abayomi Okediji\t \t\t\t\t\tMarch 26, 2025\nDepartment of Psychology\nFaculty of Social Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear  O ... (603 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 53, 13, 811899, tzinfo=datetime.timezone.utc), None, UUID('efc82800-17fd-470d-bb4d-7b04c262735c'), UUID('a7cab9a8-8792-4f3e-879d-93a63b9243d7'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 53, 13, 811910, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:53:13,817 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 18:53:13,817 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:53:14,034 - watchfiles.main - INFO - 3 changes detected
2025-04-04 18:53:14,385 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:53:19,628 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:53:19,628 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:53:19,731 - app.services.document_processing_service - INFO - Successfully processed document a7cab9a8-8792-4f3e-879d-93a63b9243d7 into 2 chunks
2025-04-04 18:53:19,731 - app.services.document_processing_service - INFO - Successfully processed document a7cab9a8-8792-4f3e-879d-93a63b9243d7 into 2 chunks
2025-04-04 18:53:19,731 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:53:19,731 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:53:19,732 - app.services.rag_service - INFO - Successfully processed note a7cab9a8-8792-4f3e-879d-93a63b9243d7
2025-04-04 18:53:19,732 - app.services.rag_service - INFO - Successfully processed note a7cab9a8-8792-4f3e-879d-93a63b9243d7
2025-04-04 18:53:19,736 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:53:19,736 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s (insertmanyvalues) 1/1 (unordered)] (UUID('2f985214-3005-4d08-9205-9434deaca83b'), UUID('67de5e92-7053-4543-8859-b3a8f23b5bd8'), '[-0.013306285254657269,0.02345314621925354,0.023026175796985626,0.039815276861190796,-0.0295895766466856,-0.006226738449186087,0.02607959695160389,-0 ... (7757 characters truncated) ... 32,0.02708977274596691,-0.0764663890004158,0.06252836436033249,-0.0029542187694460154,0.06845485419034958,-0.07617514580488205,-0.045501019805669785]', datetime.datetime(2025, 4, 4, 18, 53, 19, 735249, tzinfo=datetime.timezone.utc), None, UUID('af36f464-07d1-4679-b9c1-40fb787c8b09'), UUID('efc82800-17fd-470d-bb4d-7b04c262735c'), '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 18, 53, 19, 735260, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:53:19,752 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:53:20,050 - watchfiles.main - INFO - 3 changes detected
2025-04-04 18:53:20,401 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:53:35,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:53:35,426 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:53:35,427 - sqlalchemy.engine.Engine - INFO - [cached since 21.66s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:53:35,434 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:53:35,435 - sqlalchemy.engine.Engine - INFO - [cached since 21.66s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:53:35,441 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:53:35,441 - sqlalchemy.engine.Engine - INFO - [cached since 21.66s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:53:35,446 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:53:35,446 - sqlalchemy.engine.Engine - INFO - [cached since 21.66s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:53:35,450 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:53:35,450 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:53:35,477 - sqlalchemy.engine.Engine - INFO - 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            
2025-04-04 18:53:35,478 - sqlalchemy.engine.Engine - INFO - [generated in 0.00148s] ()
2025-04-04 18:53:35,481 - app - ERROR - Error performing similarity search: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,481 - app - ERROR - Error performing similarity search: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,482 - app.services.rag_service - ERROR - Error getting relevant chunks: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,482 - app.services.rag_service - ERROR - Error getting relevant chunks: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,486 - app.services.rag_service - ERROR - Error querying documents: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,486 - app.services.rag_service - ERROR - Error querying documents: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,488 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.AmbiguousParameterError: could not determine data type of parameter $1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,488 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 635, in prepare
    return await self._prepare(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/opt/conda/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.AmbiguousParameterError: could not determine data type of parameter $1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.AmbiguousParameterError'>: could not determine data type of parameter $1
[SQL: 
                SELECT c.*, e.embedding
                FROM document_chunks c
                JOIN document_embeddings e ON c.id = e.chunk_id
                JOIN notes n ON c.document_id = n.id
                WHERE ($1 IS NULL OR n.user_id = $1)
                ORDER BY e.embedding <=> $3::vector(384)
                LIMIT $2
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 18:53:35,494 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 18:53:35,649 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:54:59,636 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:54:59,795 - app.main - INFO - Shutting down application
2025-04-04 18:54:59,795 - app.main - INFO - Shutting down application
2025-04-04 18:54:59,800 - app.main - INFO - Database connections closed successfully
2025-04-04 18:54:59,800 - app.main - INFO - Database connections closed successfully
2025-04-04 18:55:00,204 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:55:00,573 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:55:10,774 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:55:11,114 - app.main - INFO - Starting up application
2025-04-04 18:55:11,114 - app.main - INFO - Starting up application
2025-04-04 18:55:11,126 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:55:11,224 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:55:11,225 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:11,231 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:55:11,233 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:11,236 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:55:11,237 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:11,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:55:11,249 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:11,250 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:11,257 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:11,257 - sqlalchemy.engine.Engine - INFO - [cached since 0.007829s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:11,261 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:11,262 - sqlalchemy.engine.Engine - INFO - [cached since 0.01271s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:11,266 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:11,268 - sqlalchemy.engine.Engine - INFO - [cached since 0.01927s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:11,273 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:11,277 - sqlalchemy.engine.Engine - INFO - [cached since 0.02736s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:11,279 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:55:11,281 - app.main - INFO - Database tables created successfully
2025-04-04 18:55:11,281 - app.main - INFO - Database tables created successfully
2025-04-04 18:55:11,676 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:55:12,598 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:55:12,964 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:55:23,127 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:55:23,203 - app.main - INFO - Starting up application
2025-04-04 18:55:23,203 - app.main - INFO - Starting up application
2025-04-04 18:55:23,282 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:55:23,283 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:23,287 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:55:23,288 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:23,291 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:55:23,292 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:23,300 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:55:23,310 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:23,310 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:23,320 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:23,321 - sqlalchemy.engine.Engine - INFO - [cached since 0.01125s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:23,323 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:23,324 - sqlalchemy.engine.Engine - INFO - [cached since 0.01425s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:23,326 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:23,326 - sqlalchemy.engine.Engine - INFO - [cached since 0.01664s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:23,328 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:23,329 - sqlalchemy.engine.Engine - INFO - [cached since 0.01909s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:23,345 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:55:23,347 - app.main - INFO - Database tables created successfully
2025-04-04 18:55:23,347 - app.main - INFO - Database tables created successfully
2025-04-04 18:55:23,478 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:55:44,501 - __main__ - INFO - Starting development server
2025-04-04 18:55:53,942 - app.main - INFO - Starting up application
2025-04-04 18:55:53,942 - app.main - INFO - Starting up application
2025-04-04 18:55:54,035 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:55:54,035 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:54,039 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:55:54,040 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:54,042 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:55:54,043 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:55:54,045 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:55:54,051 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:54,052 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:54,057 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:54,057 - sqlalchemy.engine.Engine - INFO - [cached since 0.005871s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:54,059 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:54,059 - sqlalchemy.engine.Engine - INFO - [cached since 0.008008s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:54,060 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:54,061 - sqlalchemy.engine.Engine - INFO - [cached since 0.009844s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:54,063 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:55:54,063 - sqlalchemy.engine.Engine - INFO - [cached since 0.01199s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:55:54,066 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:55:54,068 - app.main - INFO - Database tables created successfully
2025-04-04 18:55:54,068 - app.main - INFO - Database tables created successfully
2025-04-04 18:55:54,146 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:56:16,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:56:16,701 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:56:16,701 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:56:16,722 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:56:16,722 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:16,738 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:56:16,739 - sqlalchemy.engine.Engine - INFO - [generated in 0.00362s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:16,746 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:56:16,746 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:16,759 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:56:16,759 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:56:16,764 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 18:56:16,765 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:16,769 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:56:16,775 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:56:16,775 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:16,779 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:56:24,967 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:56:24,967 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:56:24,968 - sqlalchemy.engine.Engine - INFO - [cached since 8.267s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:56:24,974 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:56:24,975 - sqlalchemy.engine.Engine - INFO - [cached since 8.253s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:24,978 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:56:24,978 - sqlalchemy.engine.Engine - INFO - [cached since 8.243s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:24,981 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:56:24,982 - sqlalchemy.engine.Engine - INFO - [cached since 8.236s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:25,007 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:56:25,008 - sqlalchemy.engine.Engine - INFO - [generated in 0.00140s] (UUID('d30535bc-f6cd-467e-b5d8-8c52ae549e26'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 18, 56, 25, 7157, tzinfo=datetime.timezone.utc))
2025-04-04 18:56:25,011 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:56:25,015 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:56:25,015 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:56:25,018 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:56:25,021 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:56:25,021 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s (insertmanyvalues) 1/1 (unordered)] (UUID('1ea89f07-7203-4854-af49-6582c0e17359'), UUID('d30535bc-f6cd-467e-b5d8-8c52ae549e26'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 56, 25, 20891, tzinfo=datetime.timezone.utc), None, UUID('ea90f645-0329-4c0a-b837-ca4877a4542b'), UUID('d30535bc-f6cd-467e-b5d8-8c52ae549e26'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 56, 25, 20908, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:56:25,028 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 18:56:25,029 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:56:25,193 - watchfiles.main - INFO - 3 changes detected
2025-04-04 18:56:30,173 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:56:30,173 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:56:30,265 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:56:30,285 - app.services.document_processing_service - INFO - Successfully processed document d30535bc-f6cd-467e-b5d8-8c52ae549e26 into 2 chunks
2025-04-04 18:56:30,285 - app.services.document_processing_service - INFO - Successfully processed document d30535bc-f6cd-467e-b5d8-8c52ae549e26 into 2 chunks
2025-04-04 18:56:30,286 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:56:30,286 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:56:30,287 - app.services.rag_service - INFO - Successfully processed note d30535bc-f6cd-467e-b5d8-8c52ae549e26
2025-04-04 18:56:30,287 - app.services.rag_service - INFO - Successfully processed note d30535bc-f6cd-467e-b5d8-8c52ae549e26
2025-04-04 18:56:30,290 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:56:30,290 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s (insertmanyvalues) 1/1 (unordered)] (UUID('75ddd70f-b6dd-4691-9b55-40cfad742d82'), UUID('1ea89f07-7203-4854-af49-6582c0e17359'), '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 18, 56, 30, 289588, tzinfo=datetime.timezone.utc), None, UUID('18eb083b-4129-464b-b866-adc450523a40'), UUID('ea90f645-0329-4c0a-b837-ca4877a4542b'), '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 18, 56, 30, 289598, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:56:30,306 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:56:30,616 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:56:48,145 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:56:48,146 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:56:48,147 - sqlalchemy.engine.Engine - INFO - [cached since 31.45s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:56:48,151 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:56:48,152 - sqlalchemy.engine.Engine - INFO - [cached since 31.43s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:48,156 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:56:48,157 - sqlalchemy.engine.Engine - INFO - [cached since 31.42s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:48,161 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:56:48,162 - sqlalchemy.engine.Engine - INFO - [cached since 31.42s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:56:48,166 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:56:48,166 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:56:48,188 - app - ERROR - Error performing similarity search: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,188 - app - ERROR - Error performing similarity search: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,189 - app.services.rag_service - ERROR - Error getting relevant chunks: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,189 - app.services.rag_service - ERROR - Error getting relevant chunks: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,189 - app.services.rag_service - ERROR - Error querying documents: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,189 - app.services.rag_service - ERROR - Error querying documents: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,189 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1410, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib/sqlalchemy/cyextension/util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib/sqlalchemy/cyextension/util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,189 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1410, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib/sqlalchemy/cyextension/util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib/sqlalchemy/cyextension/util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-04-04 18:56:48,193 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 18:56:48,319 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:57:59,666 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:57:59,829 - app.main - INFO - Shutting down application
2025-04-04 18:57:59,829 - app.main - INFO - Shutting down application
2025-04-04 18:57:59,835 - app.main - INFO - Database connections closed successfully
2025-04-04 18:57:59,835 - app.main - INFO - Database connections closed successfully
2025-04-04 18:58:00,254 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:58:00,605 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:58:08,154 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:58:08,574 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:58:09,655 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:58:10,017 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:58:10,368 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:58:19,897 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:58:20,092 - app.main - INFO - Starting up application
2025-04-04 18:58:20,092 - app.main - INFO - Starting up application
2025-04-04 18:58:20,172 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:58:20,172 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:58:20,176 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:58:20,176 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:58:20,179 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:58:20,179 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:58:20,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:58:20,190 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:58:20,190 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:58:20,194 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:58:20,194 - sqlalchemy.engine.Engine - INFO - [cached since 0.005035s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:58:20,196 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:58:20,196 - sqlalchemy.engine.Engine - INFO - [cached since 0.006901s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:58:20,198 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:58:20,199 - sqlalchemy.engine.Engine - INFO - [cached since 0.009081s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:58:20,201 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:58:20,201 - sqlalchemy.engine.Engine - INFO - [cached since 0.01164s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:58:20,205 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:58:20,207 - app.main - INFO - Database tables created successfully
2025-04-04 18:58:20,207 - app.main - INFO - Database tables created successfully
2025-04-04 18:58:20,249 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:59:03,354 - __main__ - INFO - Starting development server
2025-04-04 18:59:15,885 - app.main - INFO - Starting up application
2025-04-04 18:59:15,885 - app.main - INFO - Starting up application
2025-04-04 18:59:15,964 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 18:59:15,964 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:59:15,968 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 18:59:15,969 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:59:15,972 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 18:59:15,972 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 18:59:15,975 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:59:15,981 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:59:15,981 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:59:15,986 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:59:15,986 - sqlalchemy.engine.Engine - INFO - [cached since 0.005083s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:59:15,988 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:59:15,988 - sqlalchemy.engine.Engine - INFO - [cached since 0.007317s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:59:15,990 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:59:15,991 - sqlalchemy.engine.Engine - INFO - [cached since 0.009826s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:59:15,992 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 18:59:15,993 - sqlalchemy.engine.Engine - INFO - [cached since 0.01179s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 18:59:15,995 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:59:15,997 - app.main - INFO - Database tables created successfully
2025-04-04 18:59:15,997 - app.main - INFO - Database tables created successfully
2025-04-04 18:59:16,080 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:59:16,432 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:59:17,955 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:59:17,989 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:59:17,990 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:59:18,004 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:59:18,004 - sqlalchemy.engine.Engine - INFO - [generated in 0.00071s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:59:18,013 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:59:18,013 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:59:18,022 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:59:18,022 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:59:18,046 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:59:18,047 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] (UUID('d2923289-9177-4603-98e3-79e5c995ba1a'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 18, 59, 18, 46633, tzinfo=datetime.timezone.utc))
2025-04-04 18:59:18,053 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:59:18,056 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:59:18,056 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 18:59:18,058 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:59:18,063 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::TIMESTAMP WITH TIME ZONE, $7::TIMESTAMP WITH TIME ZONE), ($8::UUID, $9::UUID, $10::VARCHAR, $11::VARCHAR, $12::JSONB, $13::TIMESTAMP WITH TIME ZONE, $14::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:59:18,063 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s (insertmanyvalues) 1/1 (unordered)] (UUID('3a859503-7c37-4736-ab92-0514e92eadc7'), UUID('d2923289-9177-4603-98e3-79e5c995ba1a'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 59, 18, 62088, tzinfo=datetime.timezone.utc), None, UUID('9e2d5144-dab5-44b0-864d-9c5cccc81d80'), UUID('d2923289-9177-4603-98e3-79e5c995ba1a'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}', datetime.datetime(2025, 4, 4, 18, 59, 18, 62108, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:59:18,073 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 18:59:18,074 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:59:18,187 - watchfiles.main - INFO - 3 changes detected
2025-04-04 18:59:21,668 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:59:21,668 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 18:59:21,782 - app.services.document_processing_service - INFO - Successfully processed document d2923289-9177-4603-98e3-79e5c995ba1a into 2 chunks
2025-04-04 18:59:21,782 - app.services.document_processing_service - INFO - Successfully processed document d2923289-9177-4603-98e3-79e5c995ba1a into 2 chunks
2025-04-04 18:59:21,782 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:59:21,782 - app - INFO - Successfully added 2 chunks to vector store
2025-04-04 18:59:21,784 - app.services.rag_service - INFO - Successfully processed note d2923289-9177-4603-98e3-79e5c995ba1a
2025-04-04 18:59:21,784 - app.services.rag_service - INFO - Successfully processed note d2923289-9177-4603-98e3-79e5c995ba1a
2025-04-04 18:59:21,788 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_embeddings (id, chunk_id, embedding, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE), ($6::UUID, $7::UUID, $8, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)
2025-04-04 18:59:21,788 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s (insertmanyvalues) 1/1 (unordered)] (UUID('4f1e7840-1de4-48ac-b841-160baf4c26b1'), UUID('3a859503-7c37-4736-ab92-0514e92eadc7'), '[-0.03765342757105827,0.01750299334526062,0.011062109842896461,-0.005049064755439758,-0.03175562247633934,-0.010383949615061283,0.020257269963622093, ... (7744 characters truncated) ... 95,0.040002577006816864,-0.06943027675151825,0.03584444522857666,-0.028652921319007874,0.04180312156677246,-0.07624537497758865,-0.03462563455104828]', datetime.datetime(2025, 4, 4, 18, 59, 21, 787603, tzinfo=datetime.timezone.utc), None, UUID('18f3a10c-e29b-4744-b86f-4e08c8604bbb'), UUID('9e2d5144-dab5-44b0-864d-9c5cccc81d80'), '[-0.0012212817091494799,0.02734282799065113,0.0705333799123764,0.018484799191355705,-0.02744639292359352,0.06440027803182602,-0.011899764649569988,-0 ... (7747 characters truncated) ... 5,0.038757529109716415,-0.08042101562023163,0.012449274770915508,-0.04226856306195259,0.021666696295142174,-0.05997506156563759,-0.06571448594331741]', datetime.datetime(2025, 4, 4, 18, 59, 21, 787614, tzinfo=datetime.timezone.utc), None)
2025-04-04 18:59:21,798 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:59:21,806 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 18:59:22,149 - watchfiles.main - INFO - 2 changes detected
2025-04-04 18:59:22,500 - watchfiles.main - INFO - 1 change detected
2025-04-04 18:59:34,816 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 18:59:34,817 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 18:59:34,818 - sqlalchemy.engine.Engine - INFO - [cached since 16.83s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 18:59:34,827 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 18:59:34,827 - sqlalchemy.engine.Engine - INFO - [cached since 16.82s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:59:34,831 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:59:34,831 - sqlalchemy.engine.Engine - INFO - [cached since 16.82s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:59:34,836 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 18:59:34,836 - sqlalchemy.engine.Engine - INFO - [cached since 16.82s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 18:59:34,841 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:59:34,841 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 18:59:34,864 - app - ERROR - Error performing similarity search: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,864 - app - ERROR - Error performing similarity search: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,864 - app.services.rag_service - ERROR - Error getting relevant chunks: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,864 - app.services.rag_service - ERROR - Error getting relevant chunks: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,865 - app.services.rag_service - ERROR - Error querying documents: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,865 - app.services.rag_service - ERROR - Error querying documents: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,866 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1410, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib/sqlalchemy/cyextension/util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib/sqlalchemy/cyextension/util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,866 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 152, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 88, in query_documents
    chunks = await self.get_relevant_chunks(query, user_id, limit)
  File "/backend/app/services/rag_service.py", line 68, in get_relevant_chunks
    similar_chunks = await self.vector_store.similarity_search(
  File "/backend/app/services/vector_store.py", line 76, in similarity_search
    result = await self.db.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
  File "/opt/conda/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1410, in execute
    distilled_parameters = _distill_params_20(parameters)
  File "lib/sqlalchemy/cyextension/util.pyx", line 32, in sqlalchemy.cyextension.util._distill_params_20
  File "lib/sqlalchemy/cyextension/util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-04-04 18:59:34,870 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 18:59:34,983 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:17,018 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:17,218 - app.main - INFO - Shutting down application
2025-04-04 19:01:17,218 - app.main - INFO - Shutting down application
2025-04-04 19:01:17,224 - app.main - INFO - Database connections closed successfully
2025-04-04 19:01:17,224 - app.main - INFO - Database connections closed successfully
2025-04-04 19:01:17,634 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:20,325 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:20,702 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:29,664 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:30,044 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:30,396 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:34,804 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:35,191 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:35,542 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:44,763 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:01:44,923 - app.main - INFO - Starting up application
2025-04-04 19:01:44,923 - app.main - INFO - Starting up application
2025-04-04 19:01:44,996 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:01:44,996 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:01:45,000 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:01:45,000 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:01:45,003 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:01:45,004 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:01:45,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:01:45,015 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:01:45,016 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:01:45,021 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:01:45,021 - sqlalchemy.engine.Engine - INFO - [cached since 0.005898s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:01:45,024 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:01:45,024 - sqlalchemy.engine.Engine - INFO - [cached since 0.009053s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:01:45,026 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:01:45,026 - sqlalchemy.engine.Engine - INFO - [cached since 0.0111s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:01:45,028 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:01:45,028 - sqlalchemy.engine.Engine - INFO - [cached since 0.01323s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:01:45,030 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:01:45,031 - app.main - INFO - Database tables created successfully
2025-04-04 19:01:45,031 - app.main - INFO - Database tables created successfully
2025-04-04 19:01:45,115 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:01:45,465 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:02:15,634 - __main__ - INFO - Starting development server
2025-04-04 19:02:24,763 - app.main - INFO - Starting up application
2025-04-04 19:02:24,763 - app.main - INFO - Starting up application
2025-04-04 19:02:24,899 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:02:24,900 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:02:24,904 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:02:24,904 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:02:24,907 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:02:24,908 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:02:24,911 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:02:24,917 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:02:24,918 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:02:24,922 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:02:24,923 - sqlalchemy.engine.Engine - INFO - [cached since 0.005487s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:02:24,924 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:02:24,924 - sqlalchemy.engine.Engine - INFO - [cached since 0.007291s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:02:24,926 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:02:24,927 - sqlalchemy.engine.Engine - INFO - [cached since 0.00945s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:02:24,928 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:02:24,928 - sqlalchemy.engine.Engine - INFO - [cached since 0.01129s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:02:24,930 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:02:24,932 - app.main - INFO - Database tables created successfully
2025-04-04 19:02:24,932 - app.main - INFO - Database tables created successfully
2025-04-04 19:02:25,023 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:02:25,374 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:09:01,893 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:09:02,085 - app.main - INFO - Shutting down application
2025-04-04 19:09:02,085 - app.main - INFO - Shutting down application
2025-04-04 19:09:02,089 - app.main - INFO - Database connections closed successfully
2025-04-04 19:09:02,089 - app.main - INFO - Database connections closed successfully
2025-04-04 19:09:02,476 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:09:11,859 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:09:11,905 - app.main - INFO - Starting up application
2025-04-04 19:09:11,905 - app.main - INFO - Starting up application
2025-04-04 19:09:11,998 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:09:11,999 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:09:12,004 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:09:12,005 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:09:12,009 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:09:12,010 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:09:12,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:09:12,024 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:09:12,033 - sqlalchemy.engine.Engine - INFO - [generated in 0.00640s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:09:12,041 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:09:12,041 - sqlalchemy.engine.Engine - INFO - [cached since 0.01755s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:09:12,043 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:09:12,043 - sqlalchemy.engine.Engine - INFO - [cached since 0.01996s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:09:12,046 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:09:12,046 - sqlalchemy.engine.Engine - INFO - [cached since 0.02269s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:09:12,049 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:09:12,051 - sqlalchemy.engine.Engine - INFO - [cached since 0.0271s ago] ('document_embeddings', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:09:12,054 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:09:12,057 - app.main - INFO - Database tables created successfully
2025-04-04 19:09:12,057 - app.main - INFO - Database tables created successfully
2025-04-04 19:09:12,210 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:09:45,555 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:09:45,748 - app.main - INFO - Shutting down application
2025-04-04 19:09:45,748 - app.main - INFO - Shutting down application
2025-04-04 19:09:45,754 - app.main - INFO - Database connections closed successfully
2025-04-04 19:09:45,754 - app.main - INFO - Database connections closed successfully
2025-04-04 19:09:46,157 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:09:46,509 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:06,349 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:06,706 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:09,620 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:10:09,972 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:20,510 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:20,863 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:22,876 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:10:23,227 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:23,578 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:53,011 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:53,364 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:10:53,715 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:10:55,124 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:10:55,475 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:11:07,453 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:11:07,806 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:11:11,084 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:11:11,469 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:12:01,072 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:12:01,427 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:12:03,483 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:12:03,835 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:15:12,235 - __main__ - INFO - Starting development server
2025-04-04 19:15:25,798 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:15:26,150 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:15:26,213 - app.main - INFO - Starting up application
2025-04-04 19:15:26,213 - app.main - INFO - Starting up application
2025-04-04 19:15:26,382 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:15:26,385 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:15:26,396 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:15:26,397 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:15:26,402 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:15:26,402 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:15:26,407 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:15:26,417 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:15:26,417 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:15:26,425 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:15:26,425 - sqlalchemy.engine.Engine - INFO - [cached since 0.009034s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:15:26,428 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:15:26,429 - sqlalchemy.engine.Engine - INFO - [cached since 0.01244s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:15:26,432 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:15:26,433 - sqlalchemy.engine.Engine - INFO - [cached since 0.01634s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:15:26,438 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:15:26,440 - app.main - INFO - Database tables created successfully
2025-04-04 19:15:26,440 - app.main - INFO - Database tables created successfully
2025-04-04 19:15:26,502 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:15:32,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:15:32,533 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:15:32,534 - sqlalchemy.engine.Engine - INFO - [generated in 0.00122s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:15:32,550 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:15:32,551 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:15:32,558 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:15:32,558 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:15:32,565 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:15:32,566 - sqlalchemy.engine.Engine - INFO - [generated in 0.00144s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:15:32,596 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 19:15:32,596 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] (UUID('fea346ba-b81d-419b-94a4-937cbcf4aed4'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 19, 15, 32, 596102, tzinfo=datetime.timezone.utc))
2025-04-04 19:15:32,602 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:15:32,606 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 19:15:32,606 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 19:15:32,608 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:15:32,610 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB), ($6::UUID, $7::UUID, $8::VARCHAR, $9::VARCHAR, $10::JSONB)
2025-04-04 19:15:32,611 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s (insertmanyvalues) 1/1 (unordered)] (UUID('8d11648a-7760-40b2-b4c6-260f19a21b7f'), UUID('fea346ba-b81d-419b-94a4-937cbcf4aed4'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', UUID('7809e402-4a49-43c2-8fbc-bcedf11de6cb'), UUID('fea346ba-b81d-419b-94a4-937cbcf4aed4'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}')
2025-04-04 19:15:32,616 - app.services.document_processing_service - INFO - Successfully processed document fea346ba-b81d-419b-94a4-937cbcf4aed4 into 2 chunks
2025-04-04 19:15:32,616 - app.services.document_processing_service - INFO - Successfully processed document fea346ba-b81d-419b-94a4-937cbcf4aed4 into 2 chunks
2025-04-04 19:15:32,619 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 19:15:32,620 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:15:32,719 - watchfiles.main - INFO - 3 changes detected
2025-04-04 19:15:35,472 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:15:35,472 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:15:35,728 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:15:36,049 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-04 19:15:36,049 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-04 19:15:36,050 - app.services.rag_service - INFO - Successfully processed note fea346ba-b81d-419b-94a4-937cbcf4aed4
2025-04-04 19:15:36,050 - app.services.rag_service - INFO - Successfully processed note fea346ba-b81d-419b-94a4-937cbcf4aed4
2025-04-04 19:15:36,060 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:15:36,079 - watchfiles.main - INFO - 7 changes detected
2025-04-04 19:15:36,430 - watchfiles.main - INFO - 5 changes detected
2025-04-04 19:15:56,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:15:56,883 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:15:56,883 - sqlalchemy.engine.Engine - INFO - [cached since 24.35s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:15:56,887 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:15:56,888 - sqlalchemy.engine.Engine - INFO - [cached since 24.34s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:15:56,895 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:15:56,895 - sqlalchemy.engine.Engine - INFO - [cached since 24.34s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:15:56,901 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:15:56,901 - sqlalchemy.engine.Engine - INFO - [cached since 24.34s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:15:56,905 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:15:56,905 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:15:56,943 - app - ERROR - Error performing similarity search: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,943 - app - ERROR - Error performing similarity search: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,944 - app.services.rag_service - ERROR - Error getting relevant chunks: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,944 - app.services.rag_service - ERROR - Error getting relevant chunks: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,948 - app.services.rag_service - ERROR - Error querying documents: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,948 - app.services.rag_service - ERROR - Error querying documents: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,949 - app.api.endpoints.chat - ERROR - Value error in chat endpoint: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,949 - app.api.endpoints.chat - ERROR - Value error in chat endpoint: Expected where operator to be one of $gt, $gte, $lt, $lte, $ne, $eq, $in, $nin, got $contains in query.
2025-04-04 19:15:56,949 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 19:15:57,140 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:15:57,492 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:16:54,015 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:16:54,211 - app.main - INFO - Shutting down application
2025-04-04 19:16:54,211 - app.main - INFO - Shutting down application
2025-04-04 19:16:54,217 - app.main - INFO - Database connections closed successfully
2025-04-04 19:16:54,217 - app.main - INFO - Database connections closed successfully
2025-04-04 19:16:54,741 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:06,974 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:07,392 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:07,743 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:09,977 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:10,354 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:10,706 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:22,381 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:17:22,732 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:27,195 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:17:27,546 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:27,620 - app.main - INFO - Starting up application
2025-04-04 19:17:27,620 - app.main - INFO - Starting up application
2025-04-04 19:17:27,701 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:17:27,701 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:17:27,705 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:17:27,706 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:17:27,709 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:17:27,709 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:17:27,713 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:17:27,719 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:27,720 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:27,724 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:27,724 - sqlalchemy.engine.Engine - INFO - [cached since 0.004766s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:27,726 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:27,727 - sqlalchemy.engine.Engine - INFO - [cached since 0.007496s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:27,729 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:27,729 - sqlalchemy.engine.Engine - INFO - [cached since 0.01021s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:27,731 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:17:27,733 - app.main - INFO - Database tables created successfully
2025-04-04 19:17:27,733 - app.main - INFO - Database tables created successfully
2025-04-04 19:17:29,300 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:29,438 - app.main - INFO - Shutting down application
2025-04-04 19:17:29,438 - app.main - INFO - Shutting down application
2025-04-04 19:17:29,444 - app.main - INFO - Database connections closed successfully
2025-04-04 19:17:29,444 - app.main - INFO - Database connections closed successfully
2025-04-04 19:17:29,845 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:39,532 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:17:39,884 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:43,746 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:17:44,097 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:17:44,289 - app.main - INFO - Starting up application
2025-04-04 19:17:44,289 - app.main - INFO - Starting up application
2025-04-04 19:17:44,359 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:17:44,360 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:17:44,363 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:17:44,363 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:17:44,366 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:17:44,367 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:17:44,370 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:17:44,377 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:44,377 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:44,381 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:44,382 - sqlalchemy.engine.Engine - INFO - [cached since 0.005172s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:44,384 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:44,385 - sqlalchemy.engine.Engine - INFO - [cached since 0.007774s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:44,386 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:17:44,387 - sqlalchemy.engine.Engine - INFO - [cached since 0.01003s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:17:44,389 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:17:44,390 - app.main - INFO - Database tables created successfully
2025-04-04 19:17:44,390 - app.main - INFO - Database tables created successfully
2025-04-04 19:17:44,447 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:18:09,128 - __main__ - INFO - Starting development server
2025-04-04 19:18:29,362 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:18:29,703 - app.main - INFO - Starting up application
2025-04-04 19:18:29,703 - app.main - INFO - Starting up application
2025-04-04 19:18:29,714 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:18:29,778 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:18:29,778 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:18:29,781 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:18:29,781 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:18:29,784 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:18:29,784 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:18:29,786 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:18:29,792 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:18:29,793 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:18:29,797 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:18:29,797 - sqlalchemy.engine.Engine - INFO - [cached since 0.00513s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:18:29,799 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:18:29,800 - sqlalchemy.engine.Engine - INFO - [cached since 0.00725s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:18:29,801 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:18:29,801 - sqlalchemy.engine.Engine - INFO - [cached since 0.009102s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:18:29,803 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:18:29,804 - app.main - INFO - Database tables created successfully
2025-04-04 19:18:29,804 - app.main - INFO - Database tables created successfully
2025-04-04 19:18:41,922 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:18:41,949 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:18:41,949 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:18:41,961 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:18:41,962 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:18:41,972 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:18:41,972 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:18:41,978 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:18:41,979 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:18:42,000 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:18:42,003 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 19:18:42,004 - sqlalchemy.engine.Engine - INFO - [generated in 0.00137s] (UUID('0f4ac318-b520-44fb-ab14-4b5f8c30de0a'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 19, 18, 42, 3752, tzinfo=datetime.timezone.utc))
2025-04-04 19:18:42,008 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:18:42,013 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 19:18:42,013 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 19:18:42,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:18:42,018 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB), ($6::UUID, $7::UUID, $8::VARCHAR, $9::VARCHAR, $10::JSONB)
2025-04-04 19:18:42,018 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s (insertmanyvalues) 1/1 (unordered)] (UUID('992be79b-26d8-42bd-aabc-ca684dabe1f1'), UUID('0f4ac318-b520-44fb-ab14-4b5f8c30de0a'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', UUID('c4c7509c-d0ec-470d-afca-20f1cfd63111'), UUID('0f4ac318-b520-44fb-ab14-4b5f8c30de0a'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}')
2025-04-04 19:18:42,024 - app.services.document_processing_service - INFO - Successfully processed document 0f4ac318-b520-44fb-ab14-4b5f8c30de0a into 2 chunks
2025-04-04 19:18:42,024 - app.services.document_processing_service - INFO - Successfully processed document 0f4ac318-b520-44fb-ab14-4b5f8c30de0a into 2 chunks
2025-04-04 19:18:42,027 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 19:18:42,027 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:18:42,351 - watchfiles.main - INFO - 3 changes detected
2025-04-04 19:18:45,015 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:18:45,015 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:18:45,311 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:18:45,418 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-04 19:18:45,418 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-04 19:18:45,419 - app.services.rag_service - INFO - Successfully processed note 0f4ac318-b520-44fb-ab14-4b5f8c30de0a
2025-04-04 19:18:45,419 - app.services.rag_service - INFO - Successfully processed note 0f4ac318-b520-44fb-ab14-4b5f8c30de0a
2025-04-04 19:18:45,420 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:18:45,662 - watchfiles.main - INFO - 9 changes detected
2025-04-04 19:21:02,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:21:02,492 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-04 19:21:02,493 - sqlalchemy.engine.Engine - INFO - [generated in 0.00101s] ('jamiebones2000@yahoo.co.uk',)
2025-04-04 19:21:02,497 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:21:02,498 - sqlalchemy.engine.Engine - INFO - [cached since 140.5s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:02,501 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:02,502 - sqlalchemy.engine.Engine - INFO - [cached since 140.5s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:02,505 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:02,506 - sqlalchemy.engine.Engine - INFO - [cached since 140.5s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:02,510 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-04 19:21:02,865 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:21:02,924 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:21:03,186 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:21:03,187 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:21:03,188 - sqlalchemy.engine.Engine - INFO - [cached since 141.2s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:21:03,197 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:21:03,198 - sqlalchemy.engine.Engine - INFO - [cached since 141.2s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,203 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:03,204 - sqlalchemy.engine.Engine - INFO - [cached since 141.2s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,211 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:03,213 - sqlalchemy.engine.Engine - INFO - [cached since 141.2s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,220 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:21:03,220 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:21:03,236 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 19:21:03,236 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,244 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:03,245 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,254 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:21:03,271 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:21:03,273 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:21:03,273 - sqlalchemy.engine.Engine - INFO - [cached since 141.3s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:21:03,284 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:21:03,285 - sqlalchemy.engine.Engine - INFO - [cached since 141.3s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,290 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:03,291 - sqlalchemy.engine.Engine - INFO - [cached since 141.3s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,305 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:03,306 - sqlalchemy.engine.Engine - INFO - [cached since 141.3s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,322 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:21:03,322 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:21:03,324 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 19:21:03,325 - sqlalchemy.engine.Engine - INFO - [cached since 0.08959s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,331 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:03,331 - sqlalchemy.engine.Engine - INFO - [cached since 0.08775s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:03,345 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:21:03,429 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:21:18,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:21:18,584 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:21:18,585 - sqlalchemy.engine.Engine - INFO - [cached since 156.6s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:21:18,590 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:21:18,590 - sqlalchemy.engine.Engine - INFO - [cached since 156.6s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:18,594 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:18,594 - sqlalchemy.engine.Engine - INFO - [cached since 156.6s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:18,597 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:21:18,598 - sqlalchemy.engine.Engine - INFO - [cached since 156.6s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:21:18,600 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:21:18,600 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:21:18,780 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:21:19,546 - app.services.api_client - ERROR - API request failed: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
2025-04-04 19:21:19,546 - app.services.api_client - ERROR - API request failed: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
2025-04-04 19:21:19,546 - app.services.rag_service - ERROR - Error querying documents: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
2025-04-04 19:21:19,546 - app.services.rag_service - ERROR - Error querying documents: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
2025-04-04 19:21:19,547 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 148, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 106, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 165, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
2025-04-04 19:21:19,547 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 148, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 106, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 165, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 404, message='Not Found', url='https://anura-testnet.lilypad.tech/api/v1/embeddings'
2025-04-04 19:21:19,550 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 19:21:19,682 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:22:52,056 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:22:52,182 - app.main - INFO - Shutting down application
2025-04-04 19:22:52,182 - app.main - INFO - Shutting down application
2025-04-04 19:22:52,187 - app.main - INFO - Database connections closed successfully
2025-04-04 19:22:52,187 - app.main - INFO - Database connections closed successfully
2025-04-04 19:22:52,581 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:22:53,235 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:22:53,587 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:22:54,449 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:22:54,801 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:23:07,687 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:23:07,978 - app.main - INFO - Starting up application
2025-04-04 19:23:07,978 - app.main - INFO - Starting up application
2025-04-04 19:23:08,033 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:23:08,034 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:23:08,037 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:23:08,037 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:23:08,038 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:23:08,040 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:23:08,040 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:23:08,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:23:08,047 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:23:08,047 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:23:08,050 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:23:08,051 - sqlalchemy.engine.Engine - INFO - [cached since 0.004222s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:23:08,052 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:23:08,053 - sqlalchemy.engine.Engine - INFO - [cached since 0.006031s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:23:08,054 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:23:08,054 - sqlalchemy.engine.Engine - INFO - [cached since 0.00765s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:23:08,056 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:23:08,057 - app.main - INFO - Database tables created successfully
2025-04-04 19:23:08,057 - app.main - INFO - Database tables created successfully
2025-04-04 19:23:08,389 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:23:15,038 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:23:15,066 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:23:15,067 - sqlalchemy.engine.Engine - INFO - [generated in 0.00148s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:23:15,079 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:23:15,080 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:23:15,085 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:23:15,086 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:23:15,094 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:23:15,094 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:23:15,098 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:23:15,098 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:23:15,100 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 19:23:15,100 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:23:15,208 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:23:17,935 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:23:17,935 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:23:18,217 - watchfiles.main - INFO - 5 changes detected
2025-04-04 19:23:18,568 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:23:18,915 - app.services.api_client - ERROR - API request failed: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:23:18,915 - app.services.api_client - ERROR - API request failed: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:23:18,916 - app.services.rag_service - ERROR - Error querying documents: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:23:18,916 - app.services.rag_service - ERROR - Error querying documents: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:23:18,917 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 148, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 106, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 165, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:23:18,917 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 148, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 106, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 165, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:23:18,918 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 19:26:47,990 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:26:48,098 - app.main - INFO - Shutting down application
2025-04-04 19:26:48,098 - app.main - INFO - Shutting down application
2025-04-04 19:26:48,107 - app.main - INFO - Database connections closed successfully
2025-04-04 19:26:48,107 - app.main - INFO - Database connections closed successfully
2025-04-04 19:26:48,536 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:27:04,260 - watchfiles.main - INFO - 3 changes detected
2025-04-04 19:27:04,611 - watchfiles.main - INFO - 4 changes detected
2025-04-04 19:27:04,956 - app.main - INFO - Starting up application
2025-04-04 19:27:04,956 - app.main - INFO - Starting up application
2025-04-04 19:27:05,077 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:27:05,077 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:27:05,084 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:27:05,084 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:27:05,090 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:27:05,091 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:27:05,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:27:05,114 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:05,115 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:05,123 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:05,123 - sqlalchemy.engine.Engine - INFO - [cached since 0.009039s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:05,125 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:05,126 - sqlalchemy.engine.Engine - INFO - [cached since 0.01139s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:05,128 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:05,128 - sqlalchemy.engine.Engine - INFO - [cached since 0.01403s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:05,130 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:27:05,132 - app.main - INFO - Database tables created successfully
2025-04-04 19:27:05,132 - app.main - INFO - Database tables created successfully
2025-04-04 19:27:05,464 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:27:23,735 - __main__ - INFO - Starting development server
2025-04-04 19:27:36,704 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:27:37,055 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:27:37,132 - app.main - INFO - Starting up application
2025-04-04 19:27:37,132 - app.main - INFO - Starting up application
2025-04-04 19:27:37,201 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:27:37,201 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:27:37,204 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:27:37,205 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:27:37,208 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:27:37,208 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:27:37,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:27:37,215 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:37,215 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:37,219 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:37,220 - sqlalchemy.engine.Engine - INFO - [cached since 0.004605s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:37,221 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:37,221 - sqlalchemy.engine.Engine - INFO - [cached since 0.006134s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:37,223 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:27:37,223 - sqlalchemy.engine.Engine - INFO - [cached since 0.008199s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:27:37,225 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:27:37,226 - app.main - INFO - Database tables created successfully
2025-04-04 19:27:37,226 - app.main - INFO - Database tables created successfully
2025-04-04 19:27:37,407 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:29,069 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:29,263 - app.main - INFO - Shutting down application
2025-04-04 19:28:29,263 - app.main - INFO - Shutting down application
2025-04-04 19:28:29,268 - app.main - INFO - Database connections closed successfully
2025-04-04 19:28:29,268 - app.main - INFO - Database connections closed successfully
2025-04-04 19:28:29,655 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:30,611 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:30,969 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:38,700 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:39,121 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:39,472 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:53,766 - watchfiles.main - INFO - 4 changes detected
2025-04-04 19:28:53,937 - app.main - INFO - Starting up application
2025-04-04 19:28:53,937 - app.main - INFO - Starting up application
2025-04-04 19:28:54,003 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:28:54,004 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:28:54,007 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:28:54,007 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:28:54,009 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:28:54,009 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:28:54,011 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:28:54,019 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:28:54,019 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:28:54,024 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:28:54,025 - sqlalchemy.engine.Engine - INFO - [cached since 0.006408s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:28:54,026 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:28:54,027 - sqlalchemy.engine.Engine - INFO - [cached since 0.008285s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:28:54,028 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:28:54,029 - sqlalchemy.engine.Engine - INFO - [cached since 0.01034s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:28:54,031 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:28:54,032 - app.main - INFO - Database tables created successfully
2025-04-04 19:28:54,032 - app.main - INFO - Database tables created successfully
2025-04-04 19:28:54,117 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:28:54,468 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:29:40,911 - __main__ - INFO - Starting development server
2025-04-04 19:29:56,314 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:29:56,628 - app.main - INFO - Starting up application
2025-04-04 19:29:56,628 - app.main - INFO - Starting up application
2025-04-04 19:29:56,666 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:29:56,695 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:29:56,695 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:29:56,698 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:29:56,698 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:29:56,701 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:29:56,701 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:29:56,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:29:56,711 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:29:56,711 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:29:56,715 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:29:56,715 - sqlalchemy.engine.Engine - INFO - [cached since 0.004453s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:29:56,716 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:29:56,716 - sqlalchemy.engine.Engine - INFO - [cached since 0.006077s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:29:56,718 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:29:56,718 - sqlalchemy.engine.Engine - INFO - [cached since 0.007843s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:29:56,720 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:29:56,721 - app.main - INFO - Database tables created successfully
2025-04-04 19:29:56,721 - app.main - INFO - Database tables created successfully
2025-04-04 19:30:11,263 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:30:11,278 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:30:11,278 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:30:11,285 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:30:11,285 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:30:11,292 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:30:11,292 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:30:11,296 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:30:11,297 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:30:11,313 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 19:30:11,314 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] (UUID('3fbf2fda-578c-4378-b22e-d9f255e5b041'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\n\nProfessor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\ ... (1535 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Prof-Ita.docx', datetime.datetime(2025, 4, 4, 19, 30, 11, 313777, tzinfo=datetime.timezone.utc))
2025-04-04 19:30:11,318 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:30:11,322 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 19:30:11,322 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-04 19:30:11,323 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:30:11,326 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB), ($6::UUID, $7::UUID, $8::VARCHAR, $9::VARCHAR, $10::JSONB)
2025-04-04 19:30:11,326 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s (insertmanyvalues) 1/1 (unordered)] (UUID('8ad18779-e8e2-411f-8e93-eb285859cb22'), UUID('3fbf2fda-578c-4378-b22e-d9f255e5b041'), 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (622 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', UUID('42702dde-e226-4000-94bb-83e1a9fed239'), UUID('3fbf2fda-578c-4378-b22e-d9f255e5b041'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}')
2025-04-04 19:30:11,331 - app.services.document_processing_service - INFO - Successfully processed document 3fbf2fda-578c-4378-b22e-d9f255e5b041 into 2 chunks
2025-04-04 19:30:11,331 - app.services.document_processing_service - INFO - Successfully processed document 3fbf2fda-578c-4378-b22e-d9f255e5b041 into 2 chunks
2025-04-04 19:30:11,333 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 19:30:11,333 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:30:11,356 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:30:11,707 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:30:15,975 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:30:15,975 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:30:16,170 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:30:16,308 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-04 19:30:16,308 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-04 19:30:16,308 - app.services.rag_service - INFO - Successfully processed note 3fbf2fda-578c-4378-b22e-d9f255e5b041
2025-04-04 19:30:16,308 - app.services.rag_service - INFO - Successfully processed note 3fbf2fda-578c-4378-b22e-d9f255e5b041
2025-04-04 19:30:16,309 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:30:16,522 - watchfiles.main - INFO - 9 changes detected
2025-04-04 19:30:30,997 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:30:30,998 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:30:30,999 - sqlalchemy.engine.Engine - INFO - [cached since 19.72s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:30:31,006 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:30:31,007 - sqlalchemy.engine.Engine - INFO - [cached since 19.72s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:30:31,012 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:30:31,013 - sqlalchemy.engine.Engine - INFO - [cached since 19.72s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:30:31,017 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:30:31,017 - sqlalchemy.engine.Engine - INFO - [cached since 19.72s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:30:31,021 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:30:31,021 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:30:31,211 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:30:32,358 - app.services.api_client - ERROR - API request failed: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:30:32,358 - app.services.api_client - ERROR - API request failed: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:30:32,358 - app.services.rag_service - ERROR - Error querying documents: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:30:32,358 - app.services.rag_service - ERROR - Error querying documents: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:30:32,359 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 148, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 106, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 168, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:30:32,359 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 148, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 106, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 168, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 400, message='Bad Request', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:30:32,361 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 19:30:32,715 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:32:15,007 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:32:15,164 - app.main - INFO - Shutting down application
2025-04-04 19:32:15,164 - app.main - INFO - Shutting down application
2025-04-04 19:32:15,169 - app.main - INFO - Database connections closed successfully
2025-04-04 19:32:15,169 - app.main - INFO - Database connections closed successfully
2025-04-04 19:32:15,579 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:32:20,757 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:32:21,140 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:32:21,491 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:32:51,796 - __main__ - INFO - Starting development server
2025-04-04 19:33:04,152 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:33:04,504 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:33:04,826 - app.main - INFO - Starting up application
2025-04-04 19:33:04,826 - app.main - INFO - Starting up application
2025-04-04 19:33:04,906 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:33:04,907 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:33:04,911 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:33:04,911 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:33:04,914 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:33:04,915 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:33:04,918 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:33:04,924 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:04,924 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:04,929 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:04,929 - sqlalchemy.engine.Engine - INFO - [cached since 0.00526s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:04,931 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:04,931 - sqlalchemy.engine.Engine - INFO - [cached since 0.007556s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:04,933 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:04,933 - sqlalchemy.engine.Engine - INFO - [cached since 0.009585s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:04,935 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:33:04,936 - app.main - INFO - Database tables created successfully
2025-04-04 19:33:04,936 - app.main - INFO - Database tables created successfully
2025-04-04 19:33:18,947 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:33:19,088 - app.main - INFO - Shutting down application
2025-04-04 19:33:19,088 - app.main - INFO - Shutting down application
2025-04-04 19:33:19,092 - app.main - INFO - Database connections closed successfully
2025-04-04 19:33:19,092 - app.main - INFO - Database connections closed successfully
2025-04-04 19:33:19,489 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:33:20,140 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:33:20,498 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:33:31,865 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:33:32,216 - watchfiles.main - INFO - 3 changes detected
2025-04-04 19:33:32,250 - app.main - INFO - Starting up application
2025-04-04 19:33:32,250 - app.main - INFO - Starting up application
2025-04-04 19:33:32,308 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:33:32,309 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:33:32,313 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:33:32,313 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:33:32,316 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:33:32,317 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:33:32,319 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:33:32,325 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:32,325 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:32,329 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:32,330 - sqlalchemy.engine.Engine - INFO - [cached since 0.005036s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:32,331 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:32,331 - sqlalchemy.engine.Engine - INFO - [cached since 0.006911s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:32,333 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:33:32,333 - sqlalchemy.engine.Engine - INFO - [cached since 0.008902s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:33:32,335 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:33:32,336 - app.main - INFO - Database tables created successfully
2025-04-04 19:33:32,336 - app.main - INFO - Database tables created successfully
2025-04-04 19:33:32,567 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:34:22,688 - __main__ - INFO - Starting development server
2025-04-04 19:34:34,781 - watchfiles.main - INFO - 3 changes detected
2025-04-04 19:34:35,133 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:34:35,138 - app.main - INFO - Starting up application
2025-04-04 19:34:35,138 - app.main - INFO - Starting up application
2025-04-04 19:34:35,192 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:34:35,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:34:35,197 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:34:35,197 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:34:35,204 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:34:35,204 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:34:35,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:34:35,213 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:34:35,213 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:34:35,217 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:34:35,217 - sqlalchemy.engine.Engine - INFO - [cached since 0.004389s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:34:35,218 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:34:35,219 - sqlalchemy.engine.Engine - INFO - [cached since 0.006182s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:34:35,221 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:34:35,221 - sqlalchemy.engine.Engine - INFO - [cached since 0.008555s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:34:35,224 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:34:35,225 - app.main - INFO - Database tables created successfully
2025-04-04 19:34:35,225 - app.main - INFO - Database tables created successfully
2025-04-04 19:34:35,484 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:34:54,686 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:34:54,705 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:34:54,705 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:34:54,712 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:34:54,713 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:34:54,719 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:34:54,720 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:34:54,724 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:34:54,725 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:34:54,728 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:34:54,728 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:34:54,730 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 19:34:54,730 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:34:54,940 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:34:57,492 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:34:57,492 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:34:57,647 - watchfiles.main - INFO - 5 changes detected
2025-04-04 19:35:15,862 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 19:35:15,862 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('cf51f9f4-bad0-4f3c-82a8-6190e6e5c69e'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'who is ita', "<think>\nOkay, so I'm trying to figure out who Professor Sunday Out Ita is based on the context provided. Let me go through each chunk step by step.\ ... (2003 characters truncated) ... ring the bus complies with all safety regulations. Professor Ita serves as a key officer under Osikhena James Oshomah, General Secretary of the club.", datetime.datetime(2025, 4, 4, 19, 35, 15, 862557, tzinfo=datetime.timezone.utc))
2025-04-04 19:35:15,866 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:35:15,870 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:35:15,873 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-04 19:35:15,874 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (UUID('cf51f9f4-bad0-4f3c-82a8-6190e6e5c69e'),)
2025-04-04 19:35:15,877 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:35:15,877 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:35:15,879 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 19:35:15,882 - app.main - ERROR - Unhandled exception during request processing: 4 validation errors:
  {'type': 'missing', 'loc': ('response', 'source_documents', 0, 'metadata'), 'msg': 'Field required', 'input': {'id': '992be79b-26d8-42bd-aabc-ca684dabe1f1', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 1, 'metadata'), 'msg': 'Field required', 'input': {'id': '8ad18779-e8e2-411f-8e93-eb285859cb22', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 2, 'metadata'), 'msg': 'Field required', 'input': {'id': 'c4c7509c-d0ec-470d-afca-20f1cfd63111', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 3, 'metadata'), 'msg': 'Field required', 'input': {'id': '42702dde-e226-4000-94bb-83e1a9fed239', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 148, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 4 validation errors:
  {'type': 'missing', 'loc': ('response', 'source_documents', 0, 'metadata'), 'msg': 'Field required', 'input': {'id': '992be79b-26d8-42bd-aabc-ca684dabe1f1', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 1, 'metadata'), 'msg': 'Field required', 'input': {'id': '8ad18779-e8e2-411f-8e93-eb285859cb22', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 2, 'metadata'), 'msg': 'Field required', 'input': {'id': 'c4c7509c-d0ec-470d-afca-20f1cfd63111', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 3, 'metadata'), 'msg': 'Field required', 'input': {'id': '42702dde-e226-4000-94bb-83e1a9fed239', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}

2025-04-04 19:35:15,882 - app.main - ERROR - Unhandled exception during request processing: 4 validation errors:
  {'type': 'missing', 'loc': ('response', 'source_documents', 0, 'metadata'), 'msg': 'Field required', 'input': {'id': '992be79b-26d8-42bd-aabc-ca684dabe1f1', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 1, 'metadata'), 'msg': 'Field required', 'input': {'id': '8ad18779-e8e2-411f-8e93-eb285859cb22', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 2, 'metadata'), 'msg': 'Field required', 'input': {'id': 'c4c7509c-d0ec-470d-afca-20f1cfd63111', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 3, 'metadata'), 'msg': 'Field required', 'input': {'id': '42702dde-e226-4000-94bb-83e1a9fed239', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 148, in call_next
    message = await recv_stream.receive()
  File "/opt/conda/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/backend/app/main.py", line 118, in add_process_time_header
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 20, in __call__
    await responder(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/gzip.py", line 39, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/trustedhost.py", line 36, in __call__
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/opt/conda/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 179, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/backend/app/middleware/security_headers.py", line 17, in dispatch
    response = await call_next(request)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 154, in call_next
    raise app_exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/conda/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/conda/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/conda/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
  File "/opt/conda/lib/python3.10/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 4 validation errors:
  {'type': 'missing', 'loc': ('response', 'source_documents', 0, 'metadata'), 'msg': 'Field required', 'input': {'id': '992be79b-26d8-42bd-aabc-ca684dabe1f1', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 1, 'metadata'), 'msg': 'Field required', 'input': {'id': '8ad18779-e8e2-411f-8e93-eb285859cb22', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Professor Sunday Out Ita \t \t\t\t\t\tMarch 26, 2025\nDepartment of Physiology\nFaculty of Basic Medical Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear Professor Ita,\nAppointment as a Member of the Coastal Bus Management Committee\nI am pleased to inform you that you have been selected to serve on a three-man Committee to manage the Coastal Bus of our dear Club, UNIUYO Senior Staff Club (since 1980). Your appointment is based on your dedication and trustworthiness as a committed Club Member, and we believe you will contribute greatly to the success of this committee.\nMembership:\nProfessor Sunday Otu Ita\t\t\t\t\tChairman\nDr Abayomi Okediji\t\t\t\t\t\tMember\nMs Thelma Ononokpono\t\t\t\t\tSecretary\nTerms of Reference:\nAs members of this committee, your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 2, 'metadata'), 'msg': 'Field required', 'input': {'id': 'c4c7509c-d0ec-470d-afca-20f1cfd63111', 'document_id': '0f4ac318-b520-44fb-ab14-4b5f8c30de0a', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}
  {'type': 'missing', 'loc': ('response', 'source_documents', 3, 'metadata'), 'msg': 'Field required', 'input': {'id': '42702dde-e226-4000-94bb-83e1a9fed239', 'document_id': '3fbf2fda-578c-4378-b22e-d9f255e5b041', 'content': 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved individuals or groups to generate income for the Club.\n\nKeeping Records  Maintaining proper records of income, expenses, and bus usage.\n\n\nReporting  Providing regular updates to the Clubs Executive Committee on the buss status and finances.\n\nEnsuring Safety  Making sure the bus is roadworthy and complies with all safety regulations.\nPlease note that your role is important in helping the Club maximize the benefits of this asset. We trust that you will carry out your duties with diligence and integrity.\nYou shall serve for an initial term of one year and renewable based on good performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'chunk_type': 'text', 'chunk_metadata': {'source': 'database'}}}

2025-04-04 19:35:15,999 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:37:57,559 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:37:57,755 - app.main - INFO - Shutting down application
2025-04-04 19:37:57,755 - app.main - INFO - Shutting down application
2025-04-04 19:37:57,759 - app.main - INFO - Database connections closed successfully
2025-04-04 19:37:57,759 - app.main - INFO - Database connections closed successfully
2025-04-04 19:37:58,151 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:37:58,502 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:37:59,104 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:37:59,455 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:38:12,353 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:38:12,569 - app.main - INFO - Starting up application
2025-04-04 19:38:12,569 - app.main - INFO - Starting up application
2025-04-04 19:38:12,634 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:38:12,634 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:38:12,637 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:38:12,637 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:38:12,640 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:38:12,640 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:38:12,643 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:38:12,648 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:12,648 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:12,652 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:12,652 - sqlalchemy.engine.Engine - INFO - [cached since 0.00402s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:12,653 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:12,654 - sqlalchemy.engine.Engine - INFO - [cached since 0.005613s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:12,655 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:12,655 - sqlalchemy.engine.Engine - INFO - [cached since 0.007349s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:12,658 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:38:12,659 - app.main - INFO - Database tables created successfully
2025-04-04 19:38:12,659 - app.main - INFO - Database tables created successfully
2025-04-04 19:38:12,704 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:38:35,110 - __main__ - INFO - Starting development server
2025-04-04 19:38:48,411 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:38:48,764 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:38:48,940 - app.main - INFO - Starting up application
2025-04-04 19:38:48,940 - app.main - INFO - Starting up application
2025-04-04 19:38:49,047 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:38:49,048 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:38:49,053 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:38:49,053 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:38:49,057 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:38:49,057 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:38:49,061 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:38:49,066 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:49,067 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:49,072 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:49,072 - sqlalchemy.engine.Engine - INFO - [cached since 0.006311s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:49,075 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:49,075 - sqlalchemy.engine.Engine - INFO - [cached since 0.009178s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:49,078 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:38:49,078 - sqlalchemy.engine.Engine - INFO - [cached since 0.01224s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:38:49,080 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:38:49,081 - app.main - INFO - Database tables created successfully
2025-04-04 19:38:49,081 - app.main - INFO - Database tables created successfully
2025-04-04 19:38:49,316 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:39:07,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:39:07,479 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:39:07,479 - sqlalchemy.engine.Engine - INFO - [generated in 0.00075s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:39:07,498 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:39:07,498 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:39:07,513 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:39:07,515 - sqlalchemy.engine.Engine - INFO - [generated in 0.00239s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:39:07,523 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:39:07,523 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:39:07,526 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:39:07,526 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:39:07,537 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-04 19:39:07,537 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:39:07,546 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:39:07,547 - sqlalchemy.engine.Engine - INFO - [generated in 0.00140s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:39:07,557 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:39:07,670 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:42:37,659 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:42:37,772 - app.main - INFO - Shutting down application
2025-04-04 19:42:37,772 - app.main - INFO - Shutting down application
2025-04-04 19:42:37,777 - app.main - INFO - Database connections closed successfully
2025-04-04 19:42:37,777 - app.main - INFO - Database connections closed successfully
2025-04-04 19:42:38,174 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:42:38,525 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:42:39,783 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:42:40,134 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:42:40,487 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:42:57,246 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:42:57,597 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:42:57,612 - app.main - INFO - Starting up application
2025-04-04 19:42:57,612 - app.main - INFO - Starting up application
2025-04-04 19:42:57,729 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:42:57,730 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:42:57,734 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:42:57,735 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:42:57,738 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:42:57,738 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:42:57,741 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:42:57,749 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:42:57,749 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:42:57,754 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:42:57,754 - sqlalchemy.engine.Engine - INFO - [cached since 0.005865s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:42:57,757 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:42:57,757 - sqlalchemy.engine.Engine - INFO - [cached since 0.008531s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:42:57,760 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:42:57,760 - sqlalchemy.engine.Engine - INFO - [cached since 0.01173s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:42:57,763 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:42:57,765 - app.main - INFO - Database tables created successfully
2025-04-04 19:42:57,765 - app.main - INFO - Database tables created successfully
2025-04-04 19:43:39,867 - __main__ - INFO - Starting development server
2025-04-04 19:43:51,921 - watchfiles.main - INFO - 2 changes detected
2025-04-04 19:43:52,274 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:43:52,370 - app.main - INFO - Starting up application
2025-04-04 19:43:52,370 - app.main - INFO - Starting up application
2025-04-04 19:43:52,441 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-04 19:43:52,441 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:43:52,444 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-04 19:43:52,445 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:43:52,448 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-04 19:43:52,448 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-04 19:43:52,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:43:52,456 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:43:52,456 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:43:52,460 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:43:52,461 - sqlalchemy.engine.Engine - INFO - [cached since 0.004992s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:43:52,462 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:43:52,462 - sqlalchemy.engine.Engine - INFO - [cached since 0.006731s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:43:52,464 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-04 19:43:52,465 - sqlalchemy.engine.Engine - INFO - [cached since 0.009067s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-04 19:43:52,466 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:43:52,468 - app.main - INFO - Database tables created successfully
2025-04-04 19:43:52,468 - app.main - INFO - Database tables created successfully
2025-04-04 19:43:52,625 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:44:03,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:44:03,753 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:44:03,754 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:44:03,769 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:44:03,769 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:44:03,777 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:44:03,778 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:44:03,787 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:44:03,787 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:44:03,791 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:44:03,791 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:44:03,792 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 19:44:03,793 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:44:03,958 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:44:06,562 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:44:06,562 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:44:06,666 - watchfiles.main - INFO - 5 changes detected
2025-04-04 19:45:47,596 - app.services.api_client - ERROR - API request failed: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:45:47,596 - app.services.api_client - ERROR - API request failed: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:45:47,596 - app.services.rag_service - ERROR - Error querying documents: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:45:47,596 - app.services.rag_service - ERROR - Error querying documents: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:45:47,597 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 170, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 117, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 167, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:45:47,597 - app.api.endpoints.chat - ERROR - Unexpected error in chat endpoint: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
Traceback (most recent call last):
  File "/backend/app/api/endpoints/chat.py", line 27, in send_message
    rag_response = await query_notes(current_user.id, chat_request.message, db)
  File "/backend/app/services/rag_service.py", line 170, in query_notes
    return await rag_service.query_documents(query, user_id)
  File "/backend/app/services/rag_service.py", line 117, in query_documents
    answer = await self.lilypad_client.get_chat_completion(messages)
  File "/backend/app/services/api_client.py", line 167, in get_chat_completion
    response.raise_for_status()
  File "/opt/conda/lib/python3.10/site-packages/aiohttp/client_reqrep.py", line 1161, in raise_for_status
    raise ClientResponseError(
aiohttp.client_exceptions.ClientResponseError: 524, message='', url='https://anura-testnet.lilypad.tech/api/v1/chat/completions'
2025-04-04 19:45:47,601 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-04-04 19:45:47,799 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:46:17,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:46:17,814 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-04 19:46:17,814 - sqlalchemy.engine.Engine - INFO - [cached since 134.1s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-04 19:46:17,819 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-04 19:46:17,819 - sqlalchemy.engine.Engine - INFO - [cached since 134.1s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:46:17,823 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:46:17,823 - sqlalchemy.engine.Engine - INFO - [cached since 134.1s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:46:17,827 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-04 19:46:17,827 - sqlalchemy.engine.Engine - INFO - [cached since 134s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-04 19:46:17,832 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:46:17,832 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:46:18,184 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:46:18,535 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:46:32,839 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-04 19:46:32,839 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] (UUID('4e496436-8cfb-44f3-adbf-0268f092c779'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'what department is ita ?', '<think>\nOkay, I need to figure out the answer to the question "What department is Ita?" based on the provided context. Let me go through each chunk  ... (1661 characters truncated) ... nAnswer: The information does not specify which department Professor Sunday Otu Ita belongs to; he is primarily involved in managing the Coastal Bus.', datetime.datetime(2025, 4, 4, 19, 46, 32, 839570, tzinfo=datetime.timezone.utc))
2025-04-04 19:46:32,842 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:46:32,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-04 19:46:32,849 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-04 19:46:32,849 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (UUID('4e496436-8cfb-44f3-adbf-0268f092c779'),)
2025-04-04 19:46:32,851 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:46:32,851 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-04 19:46:32,852 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-04 19:46:33,228 - watchfiles.main - INFO - 1 change detected
2025-04-04 19:46:33,579 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:45:00,471 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:45:00,659 - app.main - INFO - Shutting down application
2025-04-05 12:45:00,659 - app.main - INFO - Shutting down application
2025-04-05 12:45:00,719 - app.main - INFO - Database connections closed successfully
2025-04-05 12:45:00,719 - app.main - INFO - Database connections closed successfully
2025-04-05 12:45:01,203 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:45:01,555 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:45:04,692 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:45:05,054 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:45:05,405 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:45:20,947 - watchfiles.main - INFO - 2 changes detected
2025-04-05 12:45:21,299 - watchfiles.main - INFO - 3 changes detected
2025-04-05 12:45:21,467 - app.main - INFO - Starting up application
2025-04-05 12:45:21,467 - app.main - INFO - Starting up application
2025-04-05 12:45:21,551 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-05 12:45:21,551 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:45:21,556 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-05 12:45:21,556 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:45:21,559 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-05 12:45:21,559 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:45:21,562 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:45:21,568 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:45:21,568 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:45:21,576 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:45:21,577 - sqlalchemy.engine.Engine - INFO - [cached since 0.009202s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:45:21,578 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:45:21,578 - sqlalchemy.engine.Engine - INFO - [cached since 0.01083s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:45:21,580 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:45:21,581 - sqlalchemy.engine.Engine - INFO - [cached since 0.01321s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:45:21,583 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:45:21,584 - app.main - INFO - Database tables created successfully
2025-04-05 12:45:21,584 - app.main - INFO - Database tables created successfully
2025-04-05 12:45:21,650 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:31,318 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:31,456 - app.main - INFO - Shutting down application
2025-04-05 12:49:31,456 - app.main - INFO - Shutting down application
2025-04-05 12:49:31,468 - app.main - INFO - Database connections closed successfully
2025-04-05 12:49:31,468 - app.main - INFO - Database connections closed successfully
2025-04-05 12:49:31,892 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:44,568 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:44,961 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:46,406 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:46,774 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:48,787 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:49,167 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:49:49,518 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:50:00,885 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:50:01,293 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:50:01,647 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:50:04,474 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:50:04,852 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:50:18,348 - watchfiles.main - INFO - 4 changes detected
2025-04-05 12:50:18,700 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:50:18,716 - app.main - INFO - Starting up application
2025-04-05 12:50:18,716 - app.main - INFO - Starting up application
2025-04-05 12:50:18,797 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-05 12:50:18,798 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:50:18,804 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-05 12:50:18,804 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:50:18,808 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-05 12:50:18,808 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:50:18,812 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:50:18,820 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:50:18,820 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:50:18,829 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:50:18,830 - sqlalchemy.engine.Engine - INFO - [cached since 0.01018s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:50:18,832 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:50:18,833 - sqlalchemy.engine.Engine - INFO - [cached since 0.01289s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:50:18,835 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:50:18,836 - sqlalchemy.engine.Engine - INFO - [cached since 0.0165s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:50:18,840 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:50:18,841 - app.main - INFO - Database tables created successfully
2025-04-05 12:50:18,841 - app.main - INFO - Database tables created successfully
2025-04-05 12:51:07,534 - __main__ - INFO - Starting development server
2025-04-05 12:51:20,528 - watchfiles.main - INFO - 2 changes detected
2025-04-05 12:51:20,757 - app.main - INFO - Starting up application
2025-04-05 12:51:20,757 - app.main - INFO - Starting up application
2025-04-05 12:51:20,817 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-04-05 12:51:20,817 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:51:20,821 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-04-05 12:51:20,822 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:51:20,824 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-04-05 12:51:20,824 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-04-05 12:51:20,828 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:51:20,833 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:51:20,835 - sqlalchemy.engine.Engine - INFO - [generated in 0.00229s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:51:20,840 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:51:20,840 - sqlalchemy.engine.Engine - INFO - [cached since 0.007965s ago] ('chats', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:51:20,842 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:51:20,843 - sqlalchemy.engine.Engine - INFO - [cached since 0.0101s ago] ('notes', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:51:20,845 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-04-05 12:51:20,845 - sqlalchemy.engine.Engine - INFO - [cached since 0.01289s ago] ('document_chunks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-04-05 12:51:20,847 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:51:20,848 - app.main - INFO - Database tables created successfully
2025-04-05 12:51:20,848 - app.main - INFO - Database tables created successfully
2025-04-05 12:51:20,879 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:51:38,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:51:38,087 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.email = $1::VARCHAR
2025-04-05 12:51:38,087 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ('jamiebones2000@yahoo.co.uk',)
2025-04-05 12:51:38,104 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-05 12:51:38,105 - sqlalchemy.engine.Engine - INFO - [generated in 0.00075s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,119 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,120 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,132 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,132 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,139 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-04-05 12:51:38,264 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:51:38,547 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:51:38,758 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:51:38,760 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-05 12:51:38,761 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-05 12:51:38,772 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-05 12:51:38,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.6687s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,780 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,781 - sqlalchemy.engine.Engine - INFO - [cached since 0.6615s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,787 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,788 - sqlalchemy.engine.Engine - INFO - [cached since 0.6566s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,793 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:51:38,793 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:51:38,802 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-05 12:51:38,802 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,821 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,822 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:51:38,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:51:38,850 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-05 12:51:38,850 - sqlalchemy.engine.Engine - INFO - [cached since 0.09043s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-05 12:51:38,865 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-05 12:51:38,865 - sqlalchemy.engine.Engine - INFO - [cached since 0.761s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,880 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,880 - sqlalchemy.engine.Engine - INFO - [cached since 0.7611s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,895 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,896 - sqlalchemy.engine.Engine - INFO - [cached since 0.7644s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,907 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:51:38,907 - app.api.endpoints.chat - INFO - Fetching chat history for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:51:38,912 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id = $1::UUID ORDER BY chats.timestamp ASC
2025-04-05 12:51:38,912 - sqlalchemy.engine.Engine - INFO - [cached since 0.1104s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,916 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:38,926 - sqlalchemy.engine.Engine - INFO - [cached since 0.105s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:38,939 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:51:55,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:51:55,223 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-05 12:51:55,224 - sqlalchemy.engine.Engine - INFO - [cached since 16.47s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-05 12:51:55,235 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-05 12:51:55,236 - sqlalchemy.engine.Engine - INFO - [cached since 17.13s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:55,242 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:55,242 - sqlalchemy.engine.Engine - INFO - [cached since 17.12s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:55,253 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:51:55,254 - sqlalchemy.engine.Engine - INFO - [cached since 17.12s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:51:55,313 - sqlalchemy.engine.Engine - INFO - INSERT INTO notes (id, user_id, note_text, file_name, upload_date) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-05 12:51:55,314 - sqlalchemy.engine.Engine - INFO - [generated in 0.00191s] (UUID('e51677d7-1da7-45ce-9b04-0b5a0a0f8bfd'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), '\n\n\n\n\n\n\nDr Abayomi Okediji\t \t\t\t\t\tMarch 26, 2025\nDepartment of Psychology\nFaculty of Social Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom  ... (1514 characters truncated) ... rformance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary\n\n', 'Committe-Letter-Dr-Abayomi.docx', datetime.datetime(2025, 4, 5, 12, 51, 55, 313556, tzinfo=datetime.timezone.utc))
2025-04-05 12:51:55,328 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:51:55,338 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-05 12:51:55,338 - app.services.document_processing - INFO - Created 2 chunks from text content
2025-04-05 12:51:55,339 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:51:55,350 - sqlalchemy.engine.Engine - INFO - INSERT INTO document_chunks (id, document_id, content, chunk_type, chunk_metadata) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::JSONB), ($6::UUID, $7::UUID, $8::VARCHAR, $9::VARCHAR, $10::JSONB)
2025-04-05 12:51:55,350 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s (insertmanyvalues) 1/1 (unordered)] (UUID('1687134f-d618-49d5-a7b7-ae7477796ede'), UUID('e51677d7-1da7-45ce-9b04-0b5a0a0f8bfd'), 'Dr Abayomi Okediji\t \t\t\t\t\tMarch 26, 2025\nDepartment of Psychology\nFaculty of Social Sciences\nUniversity of Uyo\nUyo\nAkwa Ibom State\nDear  O ... (603 characters truncated) ...  your responsibilities will include:\nManaging the Clubs 32-seater Coastal Bus  Ensuring it is in good condition and available for use when needed.', 'text', '{"chunk_type": "text", "source": "database"}', UUID('26da53ec-20de-4340-b0c5-ad7553a939f4'), UUID('e51677d7-1da7-45ce-9b04-0b5a0a0f8bfd'), 'Arranging Repairs  Overseeing any necessary repairs or maintenance to keep the bus functional.\nHiring Out the Bus  Renting it out to approved indi ... (591 characters truncated) ... d performance.\nCongratulations and thank you for your service\xa0to\xa0the\xa0Club.\nYours Sincerely,\n\n\nOsikhena James Oshomah\nGeneral Secretary', 'text', '{"chunk_type": "text", "source": "database"}')
2025-04-05 12:51:55,364 - app.services.document_processing_service - INFO - Successfully processed document e51677d7-1da7-45ce-9b04-0b5a0a0f8bfd into 2 chunks
2025-04-05 12:51:55,364 - app.services.document_processing_service - INFO - Successfully processed document e51677d7-1da7-45ce-9b04-0b5a0a0f8bfd into 2 chunks
2025-04-05 12:51:55,368 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-05 12:51:55,369 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 12:51:55,415 - watchfiles.main - INFO - 3 changes detected
2025-04-05 12:51:58,147 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 12:51:58,147 - app.services.embeddings - INFO - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 12:51:58,424 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:51:58,777 - watchfiles.main - INFO - 6 changes detected
2025-04-05 12:51:58,806 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-05 12:51:58,806 - app - INFO - Successfully added 2 chunks to Chroma vector store
2025-04-05 12:51:58,807 - app.services.rag_service - INFO - Successfully processed note e51677d7-1da7-45ce-9b04-0b5a0a0f8bfd
2025-04-05 12:51:58,807 - app.services.rag_service - INFO - Successfully processed note e51677d7-1da7-45ce-9b04-0b5a0a0f8bfd
2025-04-05 12:51:58,810 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:51:59,131 - watchfiles.main - INFO - 2 changes detected
2025-04-05 12:51:59,482 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:52:22,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:52:22,253 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.username, users.email, users.hashed_password, users.created_at 
FROM users 
WHERE users.id = $1::UUID
2025-04-05 12:52:22,254 - sqlalchemy.engine.Engine - INFO - [cached since 43.5s ago] ('692d28f2-d213-4a40-85f9-7cf09264cd3a',)
2025-04-05 12:52:22,265 - sqlalchemy.engine.Engine - INFO - SELECT chats.user_id AS chats_user_id, chats.id AS chats_id, chats.message AS chats_message, chats.response AS chats_response, chats.timestamp AS chats_timestamp, users_1.id AS users_1_id, users_1.username AS users_1_username, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.created_at AS users_1_created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.user_id IN ($1::UUID) ORDER BY chats.timestamp DESC
2025-04-05 12:52:22,266 - sqlalchemy.engine.Engine - INFO - [cached since 44.16s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:52:22,271 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:52:22,271 - sqlalchemy.engine.Engine - INFO - [cached since 44.16s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:52:22,276 - sqlalchemy.engine.Engine - INFO - SELECT notes.user_id AS notes_user_id, notes.id AS notes_id, notes.note_text AS notes_note_text, notes.file_name AS notes_file_name, notes.upload_date AS notes_upload_date 
FROM notes 
WHERE notes.user_id IN ($1::UUID) ORDER BY notes.upload_date DESC
2025-04-05 12:52:22,277 - sqlalchemy.engine.Engine - INFO - [cached since 44.15s ago] (UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'),)
2025-04-05 12:52:22,283 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:52:22,283 - app.api.endpoints.chat - INFO - Querying RAG system for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:52:22,496 - watchfiles.main - INFO - 1 change detected
2025-04-05 12:53:41,734 - sqlalchemy.engine.Engine - INFO - INSERT INTO chats (id, user_id, message, response, timestamp) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE)
2025-04-05 12:53:41,735 - sqlalchemy.engine.Engine - INFO - [generated in 0.00101s] (UUID('1d5a1ee2-59d2-4f4e-9233-7fc094011220'), UUID('692d28f2-d213-4a40-85f9-7cf09264cd3a'), 'What position is Abayomi in the bus committee', "<think>\nAlright, so I need to figure out what position Dr. Abayomi Okediji holds in the bus committee based on the provided context. Let me start by ... (1021 characters truncated) ... harge. Therefore, the answer should be that he is simply a Member.\n</think> Dr. Abayomi Okediji is a Member of the Coastal Bus Management Committee.", datetime.datetime(2025, 4, 5, 12, 53, 41, 734443, tzinfo=datetime.timezone.utc))
2025-04-05 12:53:41,740 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:53:41,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-04-05 12:53:41,766 - sqlalchemy.engine.Engine - INFO - SELECT chats.id, chats.user_id, chats.message, chats.response, chats.timestamp, users_1.id AS id_1, users_1.username, users_1.email, users_1.hashed_password, users_1.created_at 
FROM chats LEFT OUTER JOIN users AS users_1 ON users_1.id = chats.user_id 
WHERE chats.id = $1::UUID
2025-04-05 12:53:41,768 - sqlalchemy.engine.Engine - INFO - [generated in 0.00215s] (UUID('1d5a1ee2-59d2-4f4e-9233-7fc094011220'),)
2025-04-05 12:53:41,775 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:53:41,775 - app.api.endpoints.chat - INFO - Successfully processed chat message for user 692d28f2-d213-4a40-85f9-7cf09264cd3a
2025-04-05 12:53:41,778 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-04-05 12:53:41,970 - watchfiles.main - INFO - 1 change detected
